{"version":3,"file":"jellyha-cards.js","sources":["../../../node_modules/@lit/reactive-element/css-tag.js","../../../node_modules/@lit/reactive-element/reactive-element.js","../../../node_modules/lit-html/lit-html.js","../../../node_modules/lit-element/lit-element.js","../../../node_modules/@lit/reactive-element/decorators/custom-element.js","../../../node_modules/@lit/reactive-element/decorators/property.js","../../../node_modules/@lit/reactive-element/decorators/state.js","../../../node_modules/@lit/reactive-element/decorators/base.js","../../../node_modules/@lit/reactive-element/decorators/query.js","../../../src/shared/utils.ts","../../../src/styles/jellyha-library-styles.ts","../../../src/shared/localize.ts","../../../src/components/jellyha-item-details-modal.ts","../../../src/editors/jellyha-library-editor.ts","../../../src/components/jellyha-media-item.ts","../../../src/cards/jellyha-library-card.ts","../../../src/editors/jellyha-now-playing-editor.ts","../../../src/cards/jellyha-now-playing-card.ts"],"sourcesContent":["/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst t=globalThis,e=t.ShadowRoot&&(void 0===t.ShadyCSS||t.ShadyCSS.nativeShadow)&&\"adoptedStyleSheets\"in Document.prototype&&\"replace\"in CSSStyleSheet.prototype,s=Symbol(),o=new WeakMap;class n{constructor(t,e,o){if(this._$cssResult$=!0,o!==s)throw Error(\"CSSResult is not constructable. Use `unsafeCSS` or `css` instead.\");this.cssText=t,this.t=e}get styleSheet(){let t=this.o;const s=this.t;if(e&&void 0===t){const e=void 0!==s&&1===s.length;e&&(t=o.get(s)),void 0===t&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),e&&o.set(s,t))}return t}toString(){return this.cssText}}const r=t=>new n(\"string\"==typeof t?t:t+\"\",void 0,s),i=(t,...e)=>{const o=1===t.length?t[0]:e.reduce((e,s,o)=>e+(t=>{if(!0===t._$cssResult$)return t.cssText;if(\"number\"==typeof t)return t;throw Error(\"Value passed to 'css' function must be a 'css' function result: \"+t+\". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.\")})(s)+t[o+1],t[0]);return new n(o,t,s)},S=(s,o)=>{if(e)s.adoptedStyleSheets=o.map(t=>t instanceof CSSStyleSheet?t:t.styleSheet);else for(const e of o){const o=document.createElement(\"style\"),n=t.litNonce;void 0!==n&&o.setAttribute(\"nonce\",n),o.textContent=e.cssText,s.appendChild(o)}},c=e?t=>t:t=>t instanceof CSSStyleSheet?(t=>{let e=\"\";for(const s of t.cssRules)e+=s.cssText;return r(e)})(t):t;export{n as CSSResult,S as adoptStyles,i as css,c as getCompatibleStyle,e as supportsAdoptingStyleSheets,r as unsafeCSS};\n//# sourceMappingURL=css-tag.js.map\n","import{getCompatibleStyle as t,adoptStyles as s}from\"./css-tag.js\";export{CSSResult,css,supportsAdoptingStyleSheets,unsafeCSS}from\"./css-tag.js\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const{is:i,defineProperty:e,getOwnPropertyDescriptor:h,getOwnPropertyNames:r,getOwnPropertySymbols:o,getPrototypeOf:n}=Object,a=globalThis,c=a.trustedTypes,l=c?c.emptyScript:\"\",p=a.reactiveElementPolyfillSupport,d=(t,s)=>t,u={toAttribute(t,s){switch(s){case Boolean:t=t?l:null;break;case Object:case Array:t=null==t?t:JSON.stringify(t)}return t},fromAttribute(t,s){let i=t;switch(s){case Boolean:i=null!==t;break;case Number:i=null===t?null:Number(t);break;case Object:case Array:try{i=JSON.parse(t)}catch(t){i=null}}return i}},f=(t,s)=>!i(t,s),b={attribute:!0,type:String,converter:u,reflect:!1,useDefault:!1,hasChanged:f};Symbol.metadata??=Symbol(\"metadata\"),a.litPropertyMetadata??=new WeakMap;class y extends HTMLElement{static addInitializer(t){this._$Ei(),(this.l??=[]).push(t)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(t,s=b){if(s.state&&(s.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(t)&&((s=Object.create(s)).wrapped=!0),this.elementProperties.set(t,s),!s.noAccessor){const i=Symbol(),h=this.getPropertyDescriptor(t,i,s);void 0!==h&&e(this.prototype,t,h)}}static getPropertyDescriptor(t,s,i){const{get:e,set:r}=h(this.prototype,t)??{get(){return this[s]},set(t){this[s]=t}};return{get:e,set(s){const h=e?.call(this);r?.call(this,s),this.requestUpdate(t,h,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)??b}static _$Ei(){if(this.hasOwnProperty(d(\"elementProperties\")))return;const t=n(this);t.finalize(),void 0!==t.l&&(this.l=[...t.l]),this.elementProperties=new Map(t.elementProperties)}static finalize(){if(this.hasOwnProperty(d(\"finalized\")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(d(\"properties\"))){const t=this.properties,s=[...r(t),...o(t)];for(const i of s)this.createProperty(i,t[i])}const t=this[Symbol.metadata];if(null!==t){const s=litPropertyMetadata.get(t);if(void 0!==s)for(const[t,i]of s)this.elementProperties.set(t,i)}this._$Eh=new Map;for(const[t,s]of this.elementProperties){const i=this._$Eu(t,s);void 0!==i&&this._$Eh.set(i,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(s){const i=[];if(Array.isArray(s)){const e=new Set(s.flat(1/0).reverse());for(const s of e)i.unshift(t(s))}else void 0!==s&&i.push(t(s));return i}static _$Eu(t,s){const i=s.attribute;return!1===i?void 0:\"string\"==typeof i?i:\"string\"==typeof t?t.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise(t=>this.enableUpdating=t),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach(t=>t(this))}addController(t){(this._$EO??=new Set).add(t),void 0!==this.renderRoot&&this.isConnected&&t.hostConnected?.()}removeController(t){this._$EO?.delete(t)}_$E_(){const t=new Map,s=this.constructor.elementProperties;for(const i of s.keys())this.hasOwnProperty(i)&&(t.set(i,this[i]),delete this[i]);t.size>0&&(this._$Ep=t)}createRenderRoot(){const t=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return s(t,this.constructor.elementStyles),t}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach(t=>t.hostConnected?.())}enableUpdating(t){}disconnectedCallback(){this._$EO?.forEach(t=>t.hostDisconnected?.())}attributeChangedCallback(t,s,i){this._$AK(t,i)}_$ET(t,s){const i=this.constructor.elementProperties.get(t),e=this.constructor._$Eu(t,i);if(void 0!==e&&!0===i.reflect){const h=(void 0!==i.converter?.toAttribute?i.converter:u).toAttribute(s,i.type);this._$Em=t,null==h?this.removeAttribute(e):this.setAttribute(e,h),this._$Em=null}}_$AK(t,s){const i=this.constructor,e=i._$Eh.get(t);if(void 0!==e&&this._$Em!==e){const t=i.getPropertyOptions(e),h=\"function\"==typeof t.converter?{fromAttribute:t.converter}:void 0!==t.converter?.fromAttribute?t.converter:u;this._$Em=e;const r=h.fromAttribute(s,t.type);this[e]=r??this._$Ej?.get(e)??r,this._$Em=null}}requestUpdate(t,s,i,e=!1,h){if(void 0!==t){const r=this.constructor;if(!1===e&&(h=this[t]),i??=r.getPropertyOptions(t),!((i.hasChanged??f)(h,s)||i.useDefault&&i.reflect&&h===this._$Ej?.get(t)&&!this.hasAttribute(r._$Eu(t,i))))return;this.C(t,s,i)}!1===this.isUpdatePending&&(this._$ES=this._$EP())}C(t,s,{useDefault:i,reflect:e,wrapped:h},r){i&&!(this._$Ej??=new Map).has(t)&&(this._$Ej.set(t,r??s??this[t]),!0!==h||void 0!==r)||(this._$AL.has(t)||(this.hasUpdated||i||(s=void 0),this._$AL.set(t,s)),!0===e&&this._$Em!==t&&(this._$Eq??=new Set).add(t))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(t){Promise.reject(t)}const t=this.scheduleUpdate();return null!=t&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[t,s]of this._$Ep)this[t]=s;this._$Ep=void 0}const t=this.constructor.elementProperties;if(t.size>0)for(const[s,i]of t){const{wrapped:t}=i,e=this[s];!0!==t||this._$AL.has(s)||void 0===e||this.C(s,void 0,i,e)}}let t=!1;const s=this._$AL;try{t=this.shouldUpdate(s),t?(this.willUpdate(s),this._$EO?.forEach(t=>t.hostUpdate?.()),this.update(s)):this._$EM()}catch(s){throw t=!1,this._$EM(),s}t&&this._$AE(s)}willUpdate(t){}_$AE(t){this._$EO?.forEach(t=>t.hostUpdated?.()),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(t){return!0}update(t){this._$Eq&&=this._$Eq.forEach(t=>this._$ET(t,this[t])),this._$EM()}updated(t){}firstUpdated(t){}}y.elementStyles=[],y.shadowRootOptions={mode:\"open\"},y[d(\"elementProperties\")]=new Map,y[d(\"finalized\")]=new Map,p?.({ReactiveElement:y}),(a.reactiveElementVersions??=[]).push(\"2.1.2\");export{y as ReactiveElement,s as adoptStyles,u as defaultConverter,t as getCompatibleStyle,f as notEqual};\n//# sourceMappingURL=reactive-element.js.map\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst t=globalThis,i=t=>t,s=t.trustedTypes,e=s?s.createPolicy(\"lit-html\",{createHTML:t=>t}):void 0,h=\"$lit$\",o=`lit$${Math.random().toFixed(9).slice(2)}$`,n=\"?\"+o,r=`<${n}>`,l=document,c=()=>l.createComment(\"\"),a=t=>null===t||\"object\"!=typeof t&&\"function\"!=typeof t,u=Array.isArray,d=t=>u(t)||\"function\"==typeof t?.[Symbol.iterator],f=\"[ \\t\\n\\f\\r]\",v=/<(?:(!--|\\/[^a-zA-Z])|(\\/?[a-zA-Z][^>\\s]*)|(\\/?$))/g,_=/-->/g,m=/>/g,p=RegExp(`>|${f}(?:([^\\\\s\"'>=/]+)(${f}*=${f}*(?:[^ \\t\\n\\f\\r\"'\\`<>=]|(\"|')|))|$)`,\"g\"),g=/'/g,$=/\"/g,y=/^(?:script|style|textarea|title)$/i,x=t=>(i,...s)=>({_$litType$:t,strings:i,values:s}),b=x(1),w=x(2),T=x(3),E=Symbol.for(\"lit-noChange\"),A=Symbol.for(\"lit-nothing\"),C=new WeakMap,P=l.createTreeWalker(l,129);function V(t,i){if(!u(t)||!t.hasOwnProperty(\"raw\"))throw Error(\"invalid template strings array\");return void 0!==e?e.createHTML(i):i}const N=(t,i)=>{const s=t.length-1,e=[];let n,l=2===i?\"<svg>\":3===i?\"<math>\":\"\",c=v;for(let i=0;i<s;i++){const s=t[i];let a,u,d=-1,f=0;for(;f<s.length&&(c.lastIndex=f,u=c.exec(s),null!==u);)f=c.lastIndex,c===v?\"!--\"===u[1]?c=_:void 0!==u[1]?c=m:void 0!==u[2]?(y.test(u[2])&&(n=RegExp(\"</\"+u[2],\"g\")),c=p):void 0!==u[3]&&(c=p):c===p?\">\"===u[0]?(c=n??v,d=-1):void 0===u[1]?d=-2:(d=c.lastIndex-u[2].length,a=u[1],c=void 0===u[3]?p:'\"'===u[3]?$:g):c===$||c===g?c=p:c===_||c===m?c=v:(c=p,n=void 0);const x=c===p&&t[i+1].startsWith(\"/>\")?\" \":\"\";l+=c===v?s+r:d>=0?(e.push(a),s.slice(0,d)+h+s.slice(d)+o+x):s+o+(-2===d?i:x)}return[V(t,l+(t[s]||\"<?>\")+(2===i?\"</svg>\":3===i?\"</math>\":\"\")),e]};class S{constructor({strings:t,_$litType$:i},e){let r;this.parts=[];let l=0,a=0;const u=t.length-1,d=this.parts,[f,v]=N(t,i);if(this.el=S.createElement(f,e),P.currentNode=this.el.content,2===i||3===i){const t=this.el.content.firstChild;t.replaceWith(...t.childNodes)}for(;null!==(r=P.nextNode())&&d.length<u;){if(1===r.nodeType){if(r.hasAttributes())for(const t of r.getAttributeNames())if(t.endsWith(h)){const i=v[a++],s=r.getAttribute(t).split(o),e=/([.?@])?(.*)/.exec(i);d.push({type:1,index:l,name:e[2],strings:s,ctor:\".\"===e[1]?I:\"?\"===e[1]?L:\"@\"===e[1]?z:H}),r.removeAttribute(t)}else t.startsWith(o)&&(d.push({type:6,index:l}),r.removeAttribute(t));if(y.test(r.tagName)){const t=r.textContent.split(o),i=t.length-1;if(i>0){r.textContent=s?s.emptyScript:\"\";for(let s=0;s<i;s++)r.append(t[s],c()),P.nextNode(),d.push({type:2,index:++l});r.append(t[i],c())}}}else if(8===r.nodeType)if(r.data===n)d.push({type:2,index:l});else{let t=-1;for(;-1!==(t=r.data.indexOf(o,t+1));)d.push({type:7,index:l}),t+=o.length-1}l++}}static createElement(t,i){const s=l.createElement(\"template\");return s.innerHTML=t,s}}function M(t,i,s=t,e){if(i===E)return i;let h=void 0!==e?s._$Co?.[e]:s._$Cl;const o=a(i)?void 0:i._$litDirective$;return h?.constructor!==o&&(h?._$AO?.(!1),void 0===o?h=void 0:(h=new o(t),h._$AT(t,s,e)),void 0!==e?(s._$Co??=[])[e]=h:s._$Cl=h),void 0!==h&&(i=M(t,h._$AS(t,i.values),h,e)),i}class R{constructor(t,i){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=i}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){const{el:{content:i},parts:s}=this._$AD,e=(t?.creationScope??l).importNode(i,!0);P.currentNode=e;let h=P.nextNode(),o=0,n=0,r=s[0];for(;void 0!==r;){if(o===r.index){let i;2===r.type?i=new k(h,h.nextSibling,this,t):1===r.type?i=new r.ctor(h,r.name,r.strings,this,t):6===r.type&&(i=new Z(h,this,t)),this._$AV.push(i),r=s[++n]}o!==r?.index&&(h=P.nextNode(),o++)}return P.currentNode=l,e}p(t){let i=0;for(const s of this._$AV)void 0!==s&&(void 0!==s.strings?(s._$AI(t,s,i),i+=s.strings.length-2):s._$AI(t[i])),i++}}class k{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(t,i,s,e){this.type=2,this._$AH=A,this._$AN=void 0,this._$AA=t,this._$AB=i,this._$AM=s,this.options=e,this._$Cv=e?.isConnected??!0}get parentNode(){let t=this._$AA.parentNode;const i=this._$AM;return void 0!==i&&11===t?.nodeType&&(t=i.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,i=this){t=M(this,t,i),a(t)?t===A||null==t||\"\"===t?(this._$AH!==A&&this._$AR(),this._$AH=A):t!==this._$AH&&t!==E&&this._(t):void 0!==t._$litType$?this.$(t):void 0!==t.nodeType?this.T(t):d(t)?this.k(t):this._(t)}O(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}T(t){this._$AH!==t&&(this._$AR(),this._$AH=this.O(t))}_(t){this._$AH!==A&&a(this._$AH)?this._$AA.nextSibling.data=t:this.T(l.createTextNode(t)),this._$AH=t}$(t){const{values:i,_$litType$:s}=t,e=\"number\"==typeof s?this._$AC(t):(void 0===s.el&&(s.el=S.createElement(V(s.h,s.h[0]),this.options)),s);if(this._$AH?._$AD===e)this._$AH.p(i);else{const t=new R(e,this),s=t.u(this.options);t.p(i),this.T(s),this._$AH=t}}_$AC(t){let i=C.get(t.strings);return void 0===i&&C.set(t.strings,i=new S(t)),i}k(t){u(this._$AH)||(this._$AH=[],this._$AR());const i=this._$AH;let s,e=0;for(const h of t)e===i.length?i.push(s=new k(this.O(c()),this.O(c()),this,this.options)):s=i[e],s._$AI(h),e++;e<i.length&&(this._$AR(s&&s._$AB.nextSibling,e),i.length=e)}_$AR(t=this._$AA.nextSibling,s){for(this._$AP?.(!1,!0,s);t!==this._$AB;){const s=i(t).nextSibling;i(t).remove(),t=s}}setConnected(t){void 0===this._$AM&&(this._$Cv=t,this._$AP?.(t))}}class H{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(t,i,s,e,h){this.type=1,this._$AH=A,this._$AN=void 0,this.element=t,this.name=i,this._$AM=e,this.options=h,s.length>2||\"\"!==s[0]||\"\"!==s[1]?(this._$AH=Array(s.length-1).fill(new String),this.strings=s):this._$AH=A}_$AI(t,i=this,s,e){const h=this.strings;let o=!1;if(void 0===h)t=M(this,t,i,0),o=!a(t)||t!==this._$AH&&t!==E,o&&(this._$AH=t);else{const e=t;let n,r;for(t=h[0],n=0;n<h.length-1;n++)r=M(this,e[s+n],i,n),r===E&&(r=this._$AH[n]),o||=!a(r)||r!==this._$AH[n],r===A?t=A:t!==A&&(t+=(r??\"\")+h[n+1]),this._$AH[n]=r}o&&!e&&this.j(t)}j(t){t===A?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,t??\"\")}}class I extends H{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===A?void 0:t}}class L extends H{constructor(){super(...arguments),this.type=4}j(t){this.element.toggleAttribute(this.name,!!t&&t!==A)}}class z extends H{constructor(t,i,s,e,h){super(t,i,s,e,h),this.type=5}_$AI(t,i=this){if((t=M(this,t,i,0)??A)===E)return;const s=this._$AH,e=t===A&&s!==A||t.capture!==s.capture||t.once!==s.once||t.passive!==s.passive,h=t!==A&&(s===A||e);e&&this.element.removeEventListener(this.name,this,s),h&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){\"function\"==typeof this._$AH?this._$AH.call(this.options?.host??this.element,t):this._$AH.handleEvent(t)}}class Z{constructor(t,i,s){this.element=t,this.type=6,this._$AN=void 0,this._$AM=i,this.options=s}get _$AU(){return this._$AM._$AU}_$AI(t){M(this,t)}}const j={M:h,P:o,A:n,C:1,L:N,R,D:d,V:M,I:k,H,N:L,U:z,B:I,F:Z},B=t.litHtmlPolyfillSupport;B?.(S,k),(t.litHtmlVersions??=[]).push(\"3.3.2\");const D=(t,i,s)=>{const e=s?.renderBefore??i;let h=e._$litPart$;if(void 0===h){const t=s?.renderBefore??null;e._$litPart$=h=new k(i.insertBefore(c(),t),t,void 0,s??{})}return h._$AI(t),h};export{j as _$LH,b as html,T as mathml,E as noChange,A as nothing,D as render,w as svg};\n//# sourceMappingURL=lit-html.js.map\n","import{ReactiveElement as t}from\"@lit/reactive-element\";export*from\"@lit/reactive-element\";import{render as e,noChange as r}from\"lit-html\";export*from\"lit-html\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const s=globalThis;class i extends t{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const t=super.createRenderRoot();return this.renderOptions.renderBefore??=t.firstChild,t}update(t){const r=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=e(r,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return r}}i._$litElement$=!0,i[\"finalized\"]=!0,s.litElementHydrateSupport?.({LitElement:i});const o=s.litElementPolyfillSupport;o?.({LitElement:i});const n={_$AK:(t,e,r)=>{t._$AK(e,r)},_$AL:t=>t._$AL};(s.litElementVersions??=[]).push(\"4.2.2\");export{i as LitElement,n as _$LE};\n//# sourceMappingURL=lit-element.js.map\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst t=t=>(e,o)=>{void 0!==o?o.addInitializer(()=>{customElements.define(t,e)}):customElements.define(t,e)};export{t as customElement};\n//# sourceMappingURL=custom-element.js.map\n","import{notEqual as t,defaultConverter as e}from\"../reactive-element.js\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const o={attribute:!0,type:String,converter:e,reflect:!1,hasChanged:t},r=(t=o,e,r)=>{const{kind:n,metadata:i}=r;let s=globalThis.litPropertyMetadata.get(i);if(void 0===s&&globalThis.litPropertyMetadata.set(i,s=new Map),\"setter\"===n&&((t=Object.create(t)).wrapped=!0),s.set(r.name,t),\"accessor\"===n){const{name:o}=r;return{set(r){const n=e.get.call(this);e.set.call(this,r),this.requestUpdate(o,n,t,!0,r)},init(e){return void 0!==e&&this.C(o,void 0,t,e),e}}}if(\"setter\"===n){const{name:o}=r;return function(r){const n=this[o];e.call(this,r),this.requestUpdate(o,n,t,!0,r)}}throw Error(\"Unsupported decorator location: \"+n)};function n(t){return(e,o)=>\"object\"==typeof o?r(t,e,o):((t,e,o)=>{const r=e.hasOwnProperty(o);return e.constructor.createProperty(o,t),r?Object.getOwnPropertyDescriptor(e,o):void 0})(t,e,o)}export{n as property,r as standardProperty};\n//# sourceMappingURL=property.js.map\n","import{property as t}from\"./property.js\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */function r(r){return t({...r,state:!0,attribute:!1})}export{r as state};\n//# sourceMappingURL=state.js.map\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst e=(e,t,c)=>(c.configurable=!0,c.enumerable=!0,Reflect.decorate&&\"object\"!=typeof t&&Object.defineProperty(e,t,c),c);export{e as desc};\n//# sourceMappingURL=base.js.map\n","import{desc as t}from\"./base.js\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */function e(e,r){return(n,s,i)=>{const o=t=>t.renderRoot?.querySelector(e)??null;if(r){const{get:e,set:r}=\"object\"==typeof s?n:i??(()=>{const t=Symbol();return{get(){return this[t]},set(e){this[t]=e}}})();return t(n,s,{get(){let t=e.call(this);return void 0===t&&(t=o(this),(null!==t||this.hasUpdated)&&r.call(this,t)),t}})}return t(n,s,{get(){return o(this)}})}}export{e as query};\n//# sourceMappingURL=query.js.map\n","import { MediaItem } from './types';\r\n\r\nexport function isNewItem(item: MediaItem, newBadgeDays: number): boolean {\r\n    if (!newBadgeDays || !item.date_added) {\r\n        return false;\r\n    }\r\n    const addedDate = new Date(item.date_added);\r\n    const now = new Date();\r\n    const diffDays = (now.getTime() - addedDate.getTime()) / (1000 * 60 * 60 * 24);\r\n    return diffDays <= newBadgeDays;\r\n}\r\n\r\nexport function formatDate(dateString: string, locale: string = 'en'): string {\r\n    try {\r\n        const date = new Date(dateString);\r\n        const formatter = new Intl.DateTimeFormat(locale, {\r\n            year: 'numeric',\r\n            month: 'short',\r\n            day: 'numeric',\r\n        });\r\n        return formatter.format(date);\r\n    } catch {\r\n        return dateString;\r\n    }\r\n}\r\n\r\nexport function formatRuntime(minutes: number): string {\r\n    if (minutes < 60) {\r\n        return `${minutes}m`;\r\n    }\r\n    const hours = Math.floor(minutes / 60);\r\n    const mins = minutes % 60;\r\n    return mins > 0 ? `${hours}h ${mins}m` : `${hours}h`;\r\n}\r\n\r\n/**\r\n * Add width param to a signed URL.\r\n * Appended at the end (after authSig) - not part of the signature.\r\n * Format defaults to webp in the backend.\r\n */\r\nexport function addImageParams(url: string, width: number): string {\r\n    if (!url) return url;\r\n    return `${url}&width=${width}`;\r\n}\r\n","import { css } from 'lit';\r\n\r\n\r\nexport const cardStyles = css`\r\n  :host {\r\n    display: block;\r\n    height: 100%;\r\n    width: 100%;\r\n    background: none !important;\r\n    position: relative;\r\n    z-index: 1;\r\n    --jf-card-bg: var(--ha-card-background, var(--card-background-color, #1c1c1c));\r\n    --jf-primary: var(--primary-color, #18BCF2);\r\n    --jf-text: var(--primary-text-color, #fff);\r\n    --jf-text-secondary: var(--secondary-text-color, rgba(255, 255, 255, 0.7));\r\n    --jf-divider: var(--divider-color, rgba(255, 255, 255, 0.12));\r\n    --jf-poster-radius: var(--ha-card-border-radius, 12px);\r\n    --jf-transition: 0.2s ease-out;\r\n    --jf-movie-badge: #AA5CC3;\r\n    --jf-series-badge: #F2A218;\r\n    --jf-series-badge: #F2A218;\r\n    --jf-border-color: var(--divider-color, rgba(255, 255, 255, 0.15));\r\n    --jf-highlight: var(--primary-color, #18BCF2);\r\n  }\r\n\r\n  ha-card {\r\n    background: var(--jf-card-bg);\r\n    border-radius: var(--ha-card-border-radius, 12px);\r\n    position: relative;\r\n    z-index: 1; /* Lift slightly to ensure shadow is consistent */\r\n    box-shadow: var(--ha-card-box-shadow, none);\r\n    border: var(--ha-card-border, 1px solid var(--ha-card-border-color, var(--divider-color, #e0e0e0)));\r\n    overflow: hidden;\r\n    display: flex;\r\n    flex-direction: column;\r\n    height: 100%;\r\n    width: 100%;\r\n    margin: 0;\r\n    box-sizing: border-box;\r\n  }\r\n\r\n  .card-inner {\r\n    border-radius: inherit; /* Inherit from ha-card to match theme */\r\n    overflow: hidden;\r\n    position: relative;\r\n    z-index: 1;\r\n    display: flex;\r\n    flex-direction: column;\r\n    height: 100%;\r\n  }\r\n\r\n  .card-header {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    padding: 16px 16px 8px;\r\n  }\r\n\r\n  .card-header h2 {\r\n    margin: 0;\r\n    font-size: 1.25rem;\r\n    font-weight: 500;\r\n    color: var(--jf-text);\r\n  }\r\n\r\n  /* Search Bar Styles */\r\n  .search-container {\r\n    padding: 16px 16px 8px 16px; /* Increased top padding */\r\n    display: flex;\r\n    gap: 12px;\r\n    align-items: center;\r\n  }\r\n\r\n  .search-input-wrapper,\r\n  .search-select-wrapper {\r\n    position: relative;\r\n    display: flex;\r\n    align-items: center;\r\n  }\r\n\r\n  .search-input-wrapper {\r\n    flex: 1; /* Title search takes remaining space */\r\n  }\r\n\r\n  .search-select-wrapper {\r\n    flex: 0 0 160px; /* Wider genre picker */\r\n  }\r\n\r\n  .search-input,\r\n  .search-select {\r\n    width: 100%;\r\n    /* Use theme-aware transparent background */\r\n    background: color-mix(in srgb, var(--jf-text), transparent 93%);\r\n    border: 1px solid color-mix(in srgb, var(--jf-text), transparent 85%);\r\n    border-radius: 20px; /* More round edges */\r\n    padding: 8px 32px 8px 36px;\r\n    color: var(--primary-text-color);\r\n    font-size: 1rem;\r\n    font-family: var(--mdc-typography-body1-font-family, var(--mdc-typography-font-family, Roboto, sans-serif)); /* Match HA font */\r\n    outline: none;\r\n    transition: background 0.2s, border-color 0.2s, box-shadow 0.2s;\r\n    height: 42px; /* Ensure same height */\r\n    appearance: none;\r\n    -webkit-appearance: none;\r\n    box-sizing: border-box; /* Ensure padding doesn't affect height width calculation */\r\n  }\r\n\r\n  .search-select {\r\n    padding-right: 32px;\r\n    padding-left: 16px;\r\n    cursor: pointer;\r\n  }\r\n\r\n  .search-select option {\r\n    /* Use solid background from theme to avoid transparency issues in darker themes */\r\n    background: var(--paper-listbox-background-color, var(--primary-background-color, #1c1c1c));\r\n    color: var(--primary-text-color);\r\n  }\r\n\r\n  .search-input:focus,\r\n  .search-select:focus {\r\n    background: color-mix(in srgb, var(--jf-text), transparent 90%);\r\n    border-color: var(--primary-color);\r\n    box-shadow: 0 0 0 1px var(--primary-color); /* Highlight focus */\r\n  }\r\n\r\n  .search-icon {\r\n    position: absolute;\r\n    left: 12px; /* Adjusted for rounded corners */\r\n    color: var(--secondary-text-color);\r\n    pointer-events: none;\r\n    --mdc-icon-size: 20px;\r\n  }\r\n\r\n  .select-icon {\r\n    position: absolute;\r\n    right: 12px;\r\n    color: var(--secondary-text-color);\r\n    pointer-events: none;\r\n    --mdc-icon-size: 20px;\r\n  }\r\n\r\n  .clear-search {\r\n    position: absolute;\r\n    right: 8px;\r\n    background: none;\r\n    border: none;\r\n    color: var(--secondary-text-color);\r\n    cursor: pointer;\r\n    padding: 4px;\r\n    display: flex;\r\n    align-items: center;\r\n    border-radius: 50%;\r\n    transition: color 0.2s;\r\n  }\r\n\r\n  .clear-search:hover {\r\n    color: var(--primary-text-color);\r\n    background: rgba(var(--rgb-primary-text-color), 0.1);\r\n  }\r\n\r\n  .clear-search ha-icon {\r\n    --mdc-icon-size: 18px;\r\n  }\r\n\r\n  /* Theme currently playing title */\r\n  .media-item.playing .media-title,\r\n  .media-item.playing .list-title {\r\n    color: var(--jf-primary);\r\n  }\r\n\r\n  .card-content {\r\n    padding: 0;\r\n    padding-top: 12px;\r\n    overflow: hidden;\r\n    flex: 1; /* Allow content to fill remaining space */\r\n    display: flex; /* Ensure children can fill height */\r\n    flex-direction: column;\r\n    min-height: 0; /* Critical for scrolling inside flex items */\r\n  }\r\n\r\n  /* Carousel Layout - Responsive with auto-fit */\r\n  .carousel-wrapper {\r\n    position: relative;\r\n    overflow: hidden;\r\n    touch-action: pan-y; /* Allow vertical scroll, handle horizontal swipe ourselves */\r\n  }\r\n\r\n  /* Center alignment uses text-align on wrapper + inline-flex on carousel */\r\n  .carousel-wrapper.align-center {\r\n    text-align: center;\r\n  }\r\n\r\n  .carousel {\r\n    display: flex;\r\n    gap: 16px;\r\n    padding: 8px 16px 16px 16px;\r\n    transition: transform 0.3s ease;\r\n    justify-content: flex-start;\r\n  }\r\n\r\n  /* Center alignment: inline-flex shrinks to content, max-width allows scroll when needed */\r\n  .carousel-wrapper.align-center .carousel {\r\n    display: inline-flex;\r\n    text-align: left;\r\n    max-width: 100%;\r\n    overflow-x: auto;\r\n    scrollbar-width: none;\r\n    -ms-overflow-style: none;\r\n    padding-left: 0;\r\n    padding-right: 0;\r\n  }\r\n\r\n  .carousel-wrapper.align-center .carousel::-webkit-scrollbar {\r\n    display: none;\r\n  }\r\n\r\n  /* Spacers inside scrollable area for balanced centering */\r\n  .carousel-wrapper.align-center .carousel::before,\r\n  .carousel-wrapper.align-center .carousel::after {\r\n    content: '';\r\n  }\r\n\r\n  .carousel.scrollable {\r\n    overflow-x: auto;\r\n    scrollbar-width: none;\r\n    -ms-overflow-style: none;\r\n  }\r\n\r\n  .carousel.scrollable::-webkit-scrollbar {\r\n    display: none;\r\n  }\r\n\r\n  .carousel.paginated {\r\n    overflow-x: auto;\r\n    scrollbar-width: none;\r\n    -ms-overflow-style: none;\r\n    -webkit-overflow-scrolling: touch;\r\n    overscroll-behavior-x: none; /* Disable native browser navigation/rubber-banding to use custom */\r\n  }\r\n\r\n  .carousel.paginated::-webkit-scrollbar {\r\n    display: none;\r\n  }\r\n\r\n  .carousel .media-item {\r\n    flex: 0 0 auto;\r\n  }\r\n\r\n  /* Pagination Dots */\r\n  .pagination-dots {\r\n    display: flex;\r\n    justify-content: center;\r\n    gap: 8px;\r\n    padding: 8px 0 12px;\r\n  }\r\n\r\n  .pagination-dot {\r\n    width: 8px;\r\n    height: 8px;\r\n    border-radius: 50%;\r\n    background: var(--jf-text);\r\n    opacity: 0.25;\r\n    border: none;\r\n    cursor: pointer;\r\n    padding: 0;\r\n    transition: background var(--jf-transition), transform var(--jf-transition), opacity var(--jf-transition);\r\n    pointer-events: auto;\r\n    z-index: 100;\r\n  }\r\n\r\n  .pagination-dot:hover {\r\n    opacity: 0.5;\r\n  }\r\n\r\n  .pagination-dot.active {\r\n    background: var(--jf-primary);\r\n    opacity: 1;\r\n    transform: scale(1.2);\r\n  }\r\n\r\n  /* Scroll Indicator - Elastic pill that stretches between dots */\r\n  .scroll-indicator {\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    gap: 6px;\r\n    padding: 8px 0 12px;\r\n    position: relative;\r\n    z-index: 1; /* Below hovered media items */\r\n  }\r\n\r\n  /* Base scroll element */\r\n  .scroll-dot {\r\n    width: 8px;\r\n    height: 8px;\r\n    border-radius: 4px;\r\n    background: var(--jf-text);\r\n    opacity: 0.25;\r\n    transition: width 0.15s ease-out, background 0.15s ease-out, border-radius 0.15s ease-out, opacity 0.15s ease-out;\r\n  }\r\n\r\n  /* Active dot */\r\n  .scroll-dot.active {\r\n    background: var(--jf-primary);\r\n    opacity: 1;\r\n  }\r\n\r\n  /* Pill shape at start/end positions */\r\n  .scroll-dot.pill {\r\n    width: 20px;\r\n  }\r\n\r\n  /* Grid outer container to hold scrollable area + fixed indicator */\r\n  .grid-outer {\r\n    position: relative;\r\n  }\r\n\r\n  /* Grid Layout */\r\n  .grid {\r\n    display: grid;\r\n    grid-template-columns: repeat(var(--jf-columns, 4), 1fr);\r\n    gap: 16px;\r\n    justify-items: center;\r\n    padding: 8px 16px 16px 16px;\r\n    min-width: fit-content;\r\n  }\r\n\r\n  /* Auto-fill responsive grid when columns = 1 (Auto) */\r\n  .grid.auto-columns {\r\n    grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));\r\n    justify-items: center;\r\n    justify-content: center;\r\n  }\r\n\r\n  /* Horizontal Grid Mode (Infinite Scroll) */\r\n  .grid.horizontal {\r\n    display: grid;\r\n    grid-auto-flow: column;\r\n    grid-template-columns: auto; /* Let columns grow as needed */\r\n    grid-template-rows: repeat(var(--jf-grid-rows, 2), auto);\r\n    min-width: max-content; /* Force container to grow horizontally */\r\n    gap: 16px;\r\n    padding: 8px 16px 16px 16px;\r\n  }\r\n\r\n  /* List Wrapper for pagination */\r\n  .list-wrapper {\r\n    position: relative;\r\n    overflow-y: auto; /* Enable vertical scrolling */\r\n    height: 100%; /* Fill available space */\r\n    touch-action: pan-y;\r\n  }\r\n\r\n  /* Grid Wrapper for pagination */\r\n  .grid-wrapper {\r\n    position: relative;\r\n    overflow-x: auto;\r\n    overflow-y: hidden;\r\n    scrollbar-width: none;\r\n    -ms-overflow-style: none;\r\n    touch-action: auto; /* Allow both vertical and horizontal touch scrolling */\r\n    -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */\r\n    overscroll-behavior-x: none;\r\n  }\r\n\r\n  .grid-wrapper::-webkit-scrollbar {\r\n    display: none;\r\n  }\r\n\r\n  /* List Layout - supports 1-8 columns, responsive collapse when cramped */\r\n  .list {\r\n    display: grid;\r\n    /* Uses exact column count, each item has min-width so they wrap naturally */\r\n    grid-template-columns: repeat(var(--jf-list-columns, 1), 1fr);\r\n    gap: 16px;\r\n    padding: 8px 16px 20px 16px;\r\n  }\r\n\r\n  /* List item min-width handled via JavaScript ResizeObserver */\r\n\r\n  /* Single column uses flex for better layout */\r\n  .list.single-column {\r\n    display: flex;\r\n    flex-direction: column;\r\n  }\r\n  \r\n  .list.single-column .media-item {\r\n    min-width: 0;\r\n  }\r\n\r\n  /* Extra bottom padding when pagination is enabled */\r\n  .list.paginated {\r\n    padding-bottom: 8px;\r\n  }\r\n\r\n  .media-item.list-item {\r\n    flex-direction: row;\r\n    align-items: flex-start;\r\n    gap: 16px;\r\n  }\r\n\r\n  /* Specific override for List view */\r\n  .media-item.list-item .poster-container {\r\n    width: 100px !important;\r\n    flex-shrink: 0;\r\n  }\r\n\r\n  /* List poster wrapper for date */\r\n  .list-poster-wrapper {\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 6px;\r\n  }\r\n\r\n  .list-date-added {\r\n    margin: 0 0 -1px 0;\r\n    font-size: 0.9rem;\r\n    font-weight: 500;\r\n    color: var(--jf-text-secondary);\r\n    text-align: center;\r\n    opacity: 0.8;\r\n    transition: transform 0.2s ease, font-weight 0.2s ease;\r\n  }\r\n\r\n  /* Vertical alignment when title is hidden - align with poster top */\r\n  .list-item.no-title .list-info {\r\n    padding-top: 7px;\r\n  }\r\n\r\n  /* List info container */\r\n  .list-info {\r\n    flex: 1;\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 8px;\r\n    min-width: 0;\r\n    padding-top: 0;\r\n    justify-content: flex-start;\r\n  }\r\n\r\n  /* When metadata is BELOW poster (default), align info with poster top */\r\n  .list-item:not(.metadata-above) .list-info {\r\n    padding-top: 7px;\r\n  }\r\n\r\n  /* When metadata is ABOVE poster, align info with the date text above poster */\r\n  .list-item.metadata-above .list-info {\r\n    padding-top: 31px;\r\n  }\r\n\r\n  .list-title {\r\n    margin: 0 0 3px 0;\r\n    font-size: 1.1rem;\r\n    font-weight: 600;\r\n    color: var(--jf-text);\r\n    line-height: 1.3;\r\n  }\r\n\r\n  .list-metadata {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 12px;\r\n    flex-wrap: wrap;\r\n  }\r\n\r\n  .list-year {\r\n    font-size: 0.9rem;\r\n    color: var(--jf-text-secondary);\r\n    font-weight: 500;\r\n  }\r\n\r\n  .list-type-badge {\r\n    padding: 2px 8px;\r\n    border-radius: 6px;\r\n    font-size: 0.8rem;\r\n    font-weight: 700;\r\n    text-transform: uppercase;\r\n    letter-spacing: 0.3px;\r\n    color: #fff;\r\n  }\r\n\r\n  .list-type-badge.movie {\r\n    background: var(--jf-movie-badge);\r\n  }\r\n\r\n  .list-type-badge.series {\r\n    background: var(--jf-series-badge);\r\n  }\r\n\r\n  .list-runtime {\r\n    display: inline-flex;\r\n    align-items: center;\r\n    gap: 4px;\r\n    font-size: 0.85rem;\r\n    font-weight: 500;\r\n    color: var(--jf-text-secondary);\r\n  }\r\n\r\n  .list-runtime ha-icon {\r\n    --mdc-icon-size: 14px;\r\n    margin-top: -2px;\r\n  }\r\n\r\n  .list-rating {\r\n    display: inline-flex;\r\n    align-items: center;\r\n    gap: 2px;\r\n    font-size: 0.85rem;\r\n    color: var(--jf-series-badge);\r\n    font-weight: 600;\r\n  }\r\n\r\n  .list-rating ha-icon {\r\n    --mdc-icon-size: 14px;\r\n    color: var(--jf-series-badge);\r\n    margin-top: -2px;\r\n  }\r\n\r\n\r\n\r\n  .list-genres {\r\n    margin: 0;\r\n    font-size: 0.85rem;\r\n    color: var(--jf-text-secondary);\r\n    line-height: 1.4;\r\n  }\r\n\r\n  .list-description {\r\n    margin: 0;\r\n    font-size: 0.85rem;\r\n    color: var(--jf-text-secondary);\r\n    line-height: 1.5;\r\n    display: -webkit-box;\r\n    -webkit-line-clamp: 3;\r\n    -webkit-box-orient: vertical;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n  }\r\n\r\n  /* Remove hover overlay for list layout */\r\n  .media-item.list-item .hover-overlay {\r\n    display: none;\r\n  }\r\n\r\n  /* Keep badges visible in list layout */\r\n  .media-item.list-item:hover .rating,\r\n  .media-item.list-item:hover .runtime {\r\n    opacity: 1;\r\n  }\r\n\r\n  /* Emphasize metadata on hover */\r\n  .media-item.list-item:hover .list-title {\r\n    color: var(--jf-primary);\r\n  }\r\n\r\n  .media-item.list-item:hover .list-info {\r\n    transform: translateX(2px);\r\n    transition: transform 0.2s ease;\r\n  }\r\n\r\n  .media-item.list-item:hover .list-date-added {\r\n    font-weight: 600;\r\n  }\r\n\r\n  /* Move date up when it's above poster */\r\n  .media-item.list-item:hover .list-poster-wrapper .list-date-added:first-child {\r\n    transform: translateY(-2px);\r\n  }\r\n\r\n  /* Move date down when it's below poster */\r\n  .media-item.list-item:hover .list-poster-wrapper .list-date-added:last-child {\r\n    transform: translateY(2px);\r\n  }\r\n\r\n  .media-item.list-item:hover .list-year,\r\n  .media-item.list-item:hover .list-runtime,\r\n  .media-item.list-item:hover .list-rating {\r\n    font-weight: 700;\r\n  }\r\n\r\n  /* Media Item Container - NO MOVEMENT on hover */\r\n  .media-item {\r\n    position: relative;\r\n    display: flex;\r\n    flex-direction: column;\r\n    cursor: pointer;\r\n    width: auto;\r\n    z-index: 1;\r\n    user-select: none;\r\n    -webkit-user-select: none;\r\n    -webkit-touch-callout: none;\r\n  }\r\n\r\n  .media-item:hover {\r\n    z-index: 10; /* Bring hovered item forward so shadow shows above other elements */\r\n  }\r\n\r\n  .media-item:focus {\r\n    outline: none;\r\n  }\r\n\r\n  .media-item:focus-visible {\r\n    outline: 2px solid var(--jf-primary);\r\n    outline-offset: 2px;\r\n  }\r\n\r\n  /* Poster Container with border */\r\n  .poster-container {\r\n    position: relative;\r\n    width: 140px;\r\n    aspect-ratio: 2/3;\r\n    border-radius: var(--jf-poster-radius);\r\n    overflow: visible;\r\n    background: var(--jf-divider);\r\n    border: 1px solid var(--jf-border-color);\r\n    transition: border-color var(--jf-transition);\r\n  }\r\n\r\n  /* Brighter border on hover for dark theme */\r\n  .poster-container:hover {\r\n    border-color: rgba(255, 255, 255, 0.7);\r\n  }\r\n\r\n  /* Theme border for currently playing item */\r\n  .media-item.playing .poster-container {\r\n    border-color: var(--jf-primary);\r\n  }\r\n\r\n  .poster-inner {\r\n    position: absolute;\r\n    inset: 0;\r\n    border-radius: var(--jf-poster-radius);\r\n    overflow: hidden;\r\n    transition: transform var(--jf-transition), box-shadow var(--jf-transition);\r\n    z-index: 1;\r\n    transform-origin: center center;\r\n    transform: translate3d(0, 0, 0);\r\n    will-change: transform;\r\n    backface-visibility: hidden;\r\n    -webkit-backface-visibility: hidden;\r\n    image-rendering: high-quality;\r\n    image-rendering: -webkit-optimize-contrast;\r\n    filter: blur(0);\r\n    -webkit-filter: blur(0);\r\n  }\r\n\r\n  /* Only the poster pops out on hover, stays in place */\r\n  .media-item:hover .poster-inner {\r\n    transform: scale(1.05);\r\n    /* Dual shadow: white glow for dark themes, dark shadow for light themes */\r\n    box-shadow: \r\n      0 0 10px rgba(255, 255, 255, 0.15),\r\n      0 4px 8px rgba(0, 0, 0, 0.25);\r\n    z-index: 10; /* Above scroll indicator */\r\n    border: 1px solid rgba(255, 255, 255, 0.5);\r\n    border-radius: var(--jf-poster-radius);\r\n  }\r\n\r\n  /* Press effect for mobile/touch */\r\n  /* Pulse animation for confirming hold action */\r\n  @keyframes holdPulse {\r\n    0% { transform: scale(0.96); }\r\n    50% { transform: scale(0.92); }\r\n    100% { transform: scale(0.96); }\r\n  }\r\n\r\n  .poster-container.hold-pulse {\r\n    animation: holdPulse 0.3s ease-in-out;\r\n  }\r\n  .media-item.active-press .poster-container,\r\n  .media-item:active .poster-container {\r\n    transform: scale(0.96);\r\n    transition: transform 0.1s ease-out;\r\n  }\r\n\r\n  /* Vignette overlay for list items on hover */\r\n  .media-item.list-item .poster-inner::after {\r\n    content: '';\r\n    position: absolute;\r\n    inset: 0;\r\n    border-radius: var(--jf-poster-radius);\r\n    background: radial-gradient(\r\n      ellipse at center,\r\n      transparent 50%,\r\n      rgba(0, 0, 0, 0.15) 100%\r\n    );\r\n    opacity: 0;\r\n    transition: opacity var(--jf-transition);\r\n    pointer-events: none;\r\n  }\r\n\r\n  .media-item.list-item:hover .poster-inner::after {\r\n    opacity: 1;\r\n  }\r\n\r\n  .poster {\r\n    width: 100%;\r\n    height: 100%;\r\n    object-fit: cover;\r\n    opacity: 0;\r\n    transition: opacity var(--jf-transition);\r\n  }\r\n\r\n  .poster.loaded {\r\n    opacity: 1;\r\n  }\r\n\r\n  /* Skeleton loader */\r\n  .poster-skeleton {\r\n    position: absolute;\r\n    inset: 0;\r\n    background: linear-gradient(\r\n      90deg,\r\n      var(--jf-divider) 25%,\r\n      rgba(255, 255, 255, 0.1) 50%,\r\n      var(--jf-divider) 75%\r\n    );\r\n    background-size: 200% 100%;\r\n    animation: skeleton-loading 1.5s infinite;\r\n  }\r\n\r\n  .poster.loaded + .poster-skeleton {\r\n    display: none;\r\n  }\r\n\r\n  @keyframes skeleton-loading {\r\n    0% { background-position: 200% 0; }\r\n    100% { background-position: -200% 0; }\r\n  }\r\n\r\n  /* Media Type Badge (MOVIE/SERIES) - Top Left - matches new-badge style */\r\n  .media-type-badge {\r\n    position: absolute;\r\n    top: 6px;\r\n    left: 6px;\r\n    padding: 2px 8px 1px 8px;\r\n    border-radius: 4px;\r\n    font-size: 0.8rem;\r\n    font-weight: 800;\r\n    text-transform: uppercase;\r\n    letter-spacing: 0.3px;\r\n    color: #fff;\r\n    z-index: 5;\r\n    box-shadow: 0 2px 4px rgba(0,0,0,0.3);\r\n  }\r\n\r\n  .media-type-badge.movie {\r\n    background: var(--jf-movie-badge);\r\n  }\r\n\r\n  .media-type-badge.series {\r\n    background: var(--jf-series-badge);\r\n  }\r\n\r\n  /* New Badge - Top Right */\r\n  .new-badge {\r\n    position: absolute;\r\n    top: 6px;\r\n    right: 6px;\r\n    background: #009ac7;\r\n    color: #fff;\r\n    padding: 2px 8px 1px 8px;\r\n    border-radius: 4px;\r\n    font-size: 0.8rem;\r\n    font-weight: 800;\r\n    text-transform: uppercase;\r\n    letter-spacing: 0.3px;\r\n    z-index: 5;\r\n    box-shadow: 0 2px 4px rgba(0,0,0,0.3);\r\n  }\r\n\r\n  /* Status Badge (Watched/Unplayed) - Top Right */\r\n  .status-badge {\r\n    position: absolute;\r\n    top: 6px;\r\n    right: 6px;\r\n    display: inline-flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    z-index: 5;\r\n    box-shadow: 0 2px 4px rgba(0,0,0,0.3);\r\n  }\r\n\r\n  /* Watched Checkmark - Rectangular Green */\r\n  .status-badge.watched {\r\n    padding: 2px 8px 1px 8px;\r\n    font-weight: 800;    \r\n    border-radius: 4px;\r\n    background: #14B8A6;\r\n    color: #fff;\r\n    font-size: 0.8rem;\r\n  }\r\n\r\n  .status-badge.watched ha-icon {\r\n    --mdc-icon-size: 14px;\r\n    margin-top: -1px;\r\n  }\r\n\r\n  /* Unplayed Count - Theme Colored Badge */\r\n  .status-badge.unplayed {\r\n    padding: 2px 8px 1px 8px;\r\n    border-radius: 4px;\r\n    background: #009ac7;\r\n    color: #fff;\r\n    font-size: 0.8rem;\r\n    font-weight: 800;\r\n  }\r\n\r\n  /* Rating Badge - Bottom Right */\r\n  .rating {\r\n    position: absolute;\r\n    bottom: 6px;\r\n    right: 6px;\r\n    display: inline-flex;\r\n    align-items: center;\r\n    gap: 2px;\r\n    background: rgba(0, 0, 0, 0.6);\r\n    color: #F59E0B;\r\n    padding: 3px 6px;\r\n    border-radius: 4px;\r\n    font-weight: 600;\r\n    font-size: 0.8rem;\r\n    z-index: 5;\r\n    transition: opacity var(--jf-transition);\r\n  }\r\n\r\n  .rating ha-icon {\r\n    --mdc-icon-size: 13px;\r\n    color: #F59E0B;\r\n    margin-top: -1px;\r\n  }\r\n\r\n  .media-item:hover .rating {\r\n    opacity: 0;\r\n  }\r\n\r\n  /* Runtime Badge (bottom-left, gray) */\r\n  .runtime {\r\n    position: absolute;\r\n    bottom: 6px;\r\n    left: 6px;\r\n    display: inline-flex;\r\n    align-items: center;\r\n    gap: 2px;\r\n    background: rgba(0, 0, 0, 0.6);\r\n    color: rgba(255, 255, 255, 0.85);\r\n    padding: 3px 6px;\r\n    border-radius: 4px;\r\n    font-weight: 600;\r\n    font-size: 0.8rem;\r\n    z-index: 5;\r\n    transition: opacity var(--jf-transition);\r\n  }\r\n\r\n  .runtime ha-icon {\r\n    --mdc-icon-size: 12px;\r\n    color: rgba(255, 255, 255, 0.85);\r\n    margin-top: -1px;\r\n  }\r\n\r\n  .media-item:hover .runtime {\r\n    opacity: 0;\r\n  }\r\n\r\n  /* Hover Overlay with bottom gradient - FORCE WHITE TEXT */\r\n  .hover-overlay {\r\n    position: absolute;\r\n    inset: 0;\r\n    background: linear-gradient(\r\n      to top,\r\n      rgba(0, 0, 0, 0.95) 0%,\r\n      rgba(0, 0, 0, 0.85) 25%,\r\n      rgba(0, 0, 0, 0.5) 50%,\r\n      transparent 100%\r\n    );\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: flex-end;\r\n    padding: 10px;\r\n    opacity: 0;\r\n    transition: opacity var(--jf-transition);\r\n    border-radius: var(--jf-poster-radius);\r\n    z-index: 7;\r\n  }\r\n\r\n  .media-item:hover .hover-overlay {\r\n    opacity: 1;\r\n  }\r\n\r\n  .hover-overlay .overlay-year {\r\n    font-size: 0.85rem;\r\n    font-weight: 600;\r\n    color: var(--jf-primary) !important;\r\n    margin-bottom: 2px;\r\n  }\r\n\r\n  .hover-overlay .overlay-title {\r\n    font-size: 0.9rem;\r\n    font-weight: 600;\r\n    color: #fff !important;\r\n    margin: 0 0 6px 0;\r\n    line-height: 1.2;\r\n  }\r\n\r\n  .hover-overlay .overlay-description {\r\n    font-size: 0.7rem;\r\n    color: rgba(255, 255, 255, 0.9) !important;\r\n    margin: 0;\r\n    line-height: 1.3;\r\n    display: -webkit-box;\r\n    -webkit-line-clamp: 3;\r\n    -webkit-box-orient: vertical;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n  }\r\n\r\n  .hover-overlay .overlay-genres {\r\n    font-size: 0.65rem;\r\n    color: rgba(255, 255, 255, 0.65) !important;\r\n    margin: 2px 0 4px 0;\r\n    line-height: 1.3;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n    display: -webkit-box;\r\n    -webkit-line-clamp: 2;\r\n    -webkit-box-orient: vertical;\r\n  }\r\n\r\n  /* Censor Bar Overlay - Aggressive Style */\r\n  .censor-bar {\r\n    position: absolute;\r\n    top: 50%;\r\n    left: -4%;\r\n    right: -2%;\r\n    transform: translateY(calc(-50%)) rotate(-5deg);\r\n    background: #000;\r\n    color: #fff;\r\n    padding: 4px 4px;\r\n    text-align: center;\r\n    z-index: 6;\r\n    box-shadow: 0 4px 10px rgba(0,0,0,0.5);\r\n    border-top: 2px solid white;\r\n    border-bottom: 2px solid white;\r\n    width: 105%;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n  }\r\n\r\n  .censor-bar span {\r\n    font-family: 'Impact', 'Arial Black', sans-serif;\r\n    font-size: 1.4rem;\r\n    font-weight: 900;\r\n    text-transform: uppercase;\r\n    line-height: 1.1;\r\n    letter-spacing: 0.8px; /* Slightly increased for better readability */\r\n    text-shadow: 2px 2px 0px #000;\r\n    display: -webkit-box;\r\n    -webkit-line-clamp: 2;\r\n    -webkit-box-orient: vertical;\r\n    overflow: hidden;\r\n    max-width: 85%; /* Ensure text stays within visible poster area since bar is wider */\r\n  }\r\n\r\n  /* Highlight Style for Next Up */\r\n  .censor-bar.highlight {\r\n    background: var(--jf-series-badge);\r\n    border-color: rgba(255, 255, 255, 0.95);\r\n    box-shadow: 0 4px 12px rgba(0,0,0,0.6);\r\n    z-index: 7;\r\n    transform: translateY(calc(-50%)) rotate(-6deg) scale(1.05);\r\n  }\r\n  \r\n  /* List specific adjustments for Censor Bar */\r\n  .censor-bar.list-bar {\r\n    padding: 2px 2px;\r\n    /* Adjust position for smaller poster */\r\n    transform: translateY(calc(-50%)) rotate(-3deg);\r\n  }\r\n\r\n  .censor-bar.list-bar span {\r\n    font-size: 0.9rem; /* Smaller text for list view */\r\n    letter-spacing: 0.3px;\r\n  }\r\n\r\n  /* Metadata Below Image (Default View) */\r\n  .media-info-below {\r\n    padding: 6px 2px 0;\r\n    text-align: center;\r\n    max-width: 140px;\r\n    transition: transform var(--jf-transition);\r\n  }\r\n\r\n  /* Metadata Above Image */\r\n  .media-info-above {\r\n    padding: 0 2px 4px;\r\n    text-align: center;\r\n    max-width: 140px;\r\n    transition: transform var(--jf-transition);\r\n  }\r\n\r\n  .media-info-above .media-title {\r\n    font-size: 0.9rem;\r\n    font-weight: 600;\r\n    color: var(--jf-text);\r\n    margin: 0;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n    white-space: nowrap;\r\n    line-height: 1.3;\r\n  }\r\n\r\n  .media-info-above .media-year {\r\n    font-size: 0.9rem;\r\n    font-weight: 500;\r\n    color: var(--jf-text-secondary);\r\n    margin: 2px 0 0 0;\r\n  }\r\n\r\n  .media-info-above .media-date-added {\r\n    font-size: 0.9rem;\r\n    font-weight: 500;\r\n    color: var(--jf-text-secondary);\r\n    margin: 0;\r\n    opacity: 0.8;\r\n    transition: font-weight var(--jf-transition);\r\n  }\r\n\r\n  .media-item:hover .media-info-above .media-date-added {\r\n    font-weight: 600;\r\n  }\r\n\r\n  .media-item:hover .media-info-above {\r\n    transform: translateY(-4px);\r\n  }\r\n\r\n  .media-item:hover .media-info-above .media-title {\r\n    font-weight: 700;\r\n    color: var(--jf-primary);\r\n  }\r\n\r\n  .media-item:hover .media-info-above .media-year {\r\n    font-weight: 600;\r\n  }\r\n\r\n  .media-item:hover .media-info-below {\r\n    transform: translateY(4px);\r\n  }\r\n\r\n  .media-info-below .media-title {\r\n    font-size: 0.9rem;\r\n    font-weight: 600;\r\n    color: var(--jf-text);\r\n    margin: 0 0 2px 0;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n    white-space: nowrap;\r\n    line-height: 1.3;\r\n    transition: font-weight var(--jf-transition), color var(--jf-transition);\r\n  }\r\n\r\n  .media-item:hover .media-info-below .media-title {\r\n    font-weight: 700;\r\n    color: var(--jf-primary);\r\n  }\r\n\r\n  .media-info-below .media-year {\r\n    font-size: 0.9rem;\r\n    font-weight: 500;\r\n    color: var(--jf-text-secondary);\r\n    margin: 2px 0 0 0;\r\n    transition: font-weight var(--jf-transition);\r\n  }\r\n\r\n  .media-item:hover .media-info-below .media-year {\r\n    font-weight: 600;\r\n  }\r\n\r\n  .media-info-below .media-date-added {\r\n    font-size: 0.9rem;\r\n    font-weight: 500;\r\n    color: var(--jf-text-secondary);\r\n    margin: 0;\r\n    opacity: 0.8;\r\n    transition: font-weight var(--jf-transition);\r\n  }\r\n\r\n  .media-item:hover .media-info-below .media-date-added {\r\n    font-weight: 600;\r\n  }\r\n\r\n  /* Now Playing Overlay on Poster */\r\n  .now-playing-overlay {\r\n    position: absolute;\r\n    inset: 0;\r\n    background: rgba(0, 0, 0, 0.5);\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: center;\r\n    align-items: center;\r\n    gap: 12px;\r\n    z-index: 10;\r\n    border-radius: var(--jf-poster-radius);\r\n    animation: fadeIn 0.3s ease-out;\r\n  }\r\n\r\n  .now-playing-controls {\r\n    display: flex;\r\n    gap: 16px;\r\n    align-items: center;\r\n  }\r\n\r\n  .now-playing-controls ha-icon-button {\r\n    --mdc-icon-button-size: 40px;\r\n    --mdc-icon-size: 28px;\r\n    --mdc-ripple-color: transparent;\r\n    color: #fff;\r\n    background: rgba(255, 255, 255, 0.15) !important;\r\n    border-radius: 50% !important;\r\n    transition: background 0.2s;\r\n    overflow: hidden;\r\n  }\r\n\r\n  .now-playing-controls ha-icon-button:hover {\r\n    background: rgba(255, 255, 255, 0.25) !important;\r\n  }\r\n\r\n  .now-playing-controls ha-icon-button ha-icon {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    color: #fff;\r\n  }\r\n\r\n  .now-playing-status {\r\n    color: white;\r\n    font-weight: 700;\r\n    font-size: 0.8rem;\r\n    letter-spacing: 0.5px;\r\n    background: var(--primary-color);\r\n    padding: 2px 6px;\r\n    border-radius: 4px;\r\n    box-shadow: 0 2px 4px rgba(0,0,0,0.3);\r\n    transform: translateY(-8px);\r\n    white-space: nowrap;\r\n    text-transform: uppercase;\r\n  }\r\n  @keyframes fadeIn {\r\n    from { opacity: 0; }\r\n    to { opacity: 1; }\r\n  }\r\n  /* Loading state */\r\n  .loading {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    min-height: 200px;\r\n    color: var(--jf-text-secondary);\r\n  }\r\n\r\n  /* Error state */\r\n  .error {\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    justify-content: center;\r\n    min-height: 200px;\r\n    padding: 16px;\r\n    text-align: center;\r\n    color: var(--error-color, #F25C54);\r\n  }\r\n\r\n  .error ha-icon {\r\n    --mdc-icon-size: 48px;\r\n    margin-bottom: 8px;\r\n  }\r\n\r\n  /* Empty state */\r\n  .empty {\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    justify-content: center;\r\n    min-height: 200px;\r\n    padding: 16px;\r\n    text-align: center;\r\n    color: var(--jf-text-secondary);\r\n  }\r\n\r\n  .empty ha-icon {\r\n    --mdc-icon-size: 48px;\r\n    margin-bottom: 8px;\r\n    opacity: 0.5;\r\n  }\r\n\r\n  /* Responsive - smaller screens */\r\n  @media (max-width: 600px) {\r\n    .poster-container {\r\n      width: 120px;\r\n    }\r\n\r\n    .media-info-below {\r\n      max-width: 120px;\r\n    }\r\n\r\n    .hover-overlay .overlay-description {\r\n      -webkit-line-clamp: 2;\r\n    }\r\n  }\r\n  @keyframes spin {\r\n    from { transform: rotate(0deg); }\r\n    to { transform: rotate(360deg); }\r\n  }\r\n\r\n  .spinning {\r\n    animation: spin 1s linear infinite;\r\n    transform-origin: center;\r\n  }\r\n\r\n  /* Smart Pagination (Sliding Window) - iOS Style */\r\n  .pagination-container.smart {\r\n    overflow: hidden !important;\r\n    max-width: 80px; /* Approx 5 dots (8px + 8px gap * 5) */\r\n    margin: 0 auto;\r\n    padding: 8px 0 12px;\r\n    position: relative;\r\n    z-index: 100;\r\n  }\r\n\r\n  .pagination-track {\r\n    display: flex;\r\n    gap: 8px; /* Match standard gap */\r\n    transition: transform 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);\r\n    will-change: transform;\r\n    justify-content: flex-start;\r\n    padding-left: 0;\r\n  }\r\n\r\n  /* Smart Dot - Clone of .pagination-dot to ensure visual match */\r\n  .smart-dot {\r\n    width: 8px;\r\n    height: 8px;\r\n    border-radius: 50%;\r\n    background: var(--jf-text);\r\n    opacity: 0.25;\r\n    border: none;\r\n    cursor: pointer;\r\n    padding: 0;\r\n    transition: background var(--jf-transition), transform 0.3s ease, opacity 0.3s ease;\r\n    pointer-events: auto;\r\n    flex-shrink: 0;\r\n  }\r\n\r\n  .smart-dot:hover {\r\n    opacity: 0.5;\r\n  }\r\n\r\n  .smart-dot.active {\r\n    background: var(--jf-primary);\r\n    opacity: 1;\r\n    transform: scale(1.2);\r\n  }\r\n\r\n  /* Smart Dot Specific Modifiers */\r\n  .smart-dot.small {\r\n    transform: scale(0.6);\r\n    opacity: 0.6;\r\n  }\r\n\r\n  .smart-dot.hidden {\r\n    transform: scale(0);\r\n    opacity: 0;\r\n    pointer-events: none;\r\n  }\r\n\r\n\r\n  /* Touch Action Optimization - Prevent double-tap zoom delay */\r\n  .pagination-dot,\r\n  .smart-dot,\r\n  .media-item,\r\n  ha-icon-button {\r\n    touch-action: manipulation;\r\n  }\r\n\r\n  /* Reduced Motion Support - Respect user preference */\r\n  @media (prefers-reduced-motion: reduce) {\r\n    *,\r\n    *::before,\r\n    *::after {\r\n      animation-duration: 0.01ms !important;\r\n      animation-iteration-count: 1 !important;\r\n      transition-duration: 0.01ms !important;\r\n    }\r\n\r\n    /* Disable skeleton animation */\r\n    .poster-skeleton {\r\n      animation: none;\r\n      background: var(--jf-divider);\r\n    }\r\n\r\n    /* Keep transforms for layout but remove transitions */\r\n    .carousel,\r\n    .pagination-dot,\r\n    .scroll-dot,\r\n    .poster-inner,\r\n    .hover-overlay,\r\n    .media-item {\r\n      transition: none !important;\r\n    }\r\n  }\r\n`;","/**\r\n * Localization helper for JellyHA Library Card\r\n */\r\n\r\nconst translations: Record<string, Record<string, string>> = {\r\n    en: {\r\n        loading: 'Loading',\r\n        no_media: 'No recent media found',\r\n        error: 'Error loading media',\r\n        new: 'New',\r\n        minutes: 'min',\r\n        play: 'Play',\r\n        pause: 'Pause',\r\n        stop: 'Stop',\r\n        nothing_playing: 'Nothing is currently playing',\r\n        entity_not_found: 'Entity not found',\r\n        rewinding: 'REWINDING',\r\n        no_trailer: 'No trailer available',\r\n\r\n        // Editor\r\n        'editor.entity': 'Entity',\r\n        'editor.title': 'Title',\r\n        'editor.show_title': 'Show Title',\r\n        'editor.show_year': 'Show Year',\r\n        'editor.show_runtime': 'Show Runtime',\r\n        'editor.show_rating': 'Show Rating',\r\n        'editor.show_genres': 'Show Genre',\r\n        'editor.show_client': 'Show Jellyfin Client',\r\n        'editor.show_background': 'Show Background',\r\n        'editor.show_media_type_badge': 'Show Media Type Badge',\r\n        'editor.show_watched_status': 'Show Watched Status',\r\n        'editor.show_date_added': 'Show Date Added',\r\n        'editor.show_description': 'Show Description',\r\n        'editor.layout': 'Layout',\r\n        'editor.layout_carousel': 'Carousel',\r\n        'editor.layout_grid': 'Grid',\r\n        'editor.layout_list': 'List',\r\n        'editor.media_type': 'Media Type',\r\n        'editor.media_type_both': 'Movies & TV Shows',\r\n        'editor.media_type_movies': 'Movies Only',\r\n        'editor.media_type_series': 'TV Shows Only',\r\n        'editor.media_type_next_up': 'Next Up',\r\n        'editor.items_per_page': 'Items Per Page',\r\n        'editor.max_pages': 'Max Pages (0 = no limit)',\r\n        'editor.auto_swipe': 'Auto Swipe (sec, 0 = off)',\r\n        'editor.new_badge_days': 'New Badge Days (0 = off)',\r\n        'editor.click_action': 'Single Tap (Click)',\r\n        'editor.hold_action': 'Long Press (Hold)',\r\n        'editor.double_tap_action': 'Double Tap',\r\n        'editor.action_jellyfin': 'Open in Jellyfin',\r\n        'editor.action_cast': 'Cast to Chromecast',\r\n        'editor.action_more_info': 'More Information',\r\n        'editor.action_trailer': 'Watch Trailer',\r\n        'editor.action_none': 'No Action',\r\n        'editor.default_cast_device': 'Default Cast Device',\r\n        'editor.show_now_playing_overlay': 'Show \"Now Playing\" Overlay on Posters',\r\n        'editor.metadata_position': 'Metadata Position',\r\n        'editor.metadata_below': 'Below',\r\n        'editor.metadata_above': 'Above',\r\n        'editor.sort_order': 'Sort Order',\r\n        'editor.sort_date_added_desc': 'Date Added (Newest First)',\r\n        'editor.sort_date_added_asc': 'Date Added (Oldest First)',\r\n        'editor.sort_title_asc': 'Title (A-Z)',\r\n        'editor.sort_title_desc': 'Title (Z-A)',\r\n        'editor.sort_year_desc': 'Year (Newest First)',\r\n        'editor.sort_year_asc': 'Year (Oldest First)',\r\n        'editor.sort_last_played_desc': 'Last Played (Newest First)',\r\n        'editor.sort_last_played_asc': 'Last Played (Oldest First)',\r\n        'editor.enable_pagination': 'Enable Pagination',\r\n        'editor.show_pagination_dots': 'Show Pagination Dots',\r\n        'editor.filter_watch_status': 'Filter Watch Status',\r\n        'editor.filter_all': 'All',\r\n        'editor.filter_unwatched': 'Unwatched',\r\n        'editor.filter_watched': 'Watched',\r\n        'editor.filter_favorites': 'Filter Favorites',\r\n        'editor.filter_new_items': 'Filter New Items',\r\n        'editor.columns': 'Columns',\r\n        'editor.rows': 'Rows',\r\n        'editor.now_playing_sensor': 'Now Playing Sensor',\r\n        'editor.auto': 'Auto',\r\n        'editor.show_search': 'Show Search Bar',\r\n        'search.placeholder_title': 'Search Title',\r\n        'search.placeholder_genre': 'Genre',\r\n        'search.all_genres': 'All Genres',\r\n    },\r\n    de: {\r\n        loading: 'Laden',\r\n        no_media: 'Keine Medien gefunden',\r\n        error: 'Fehler beim Laden',\r\n        new: 'Neu',\r\n        minutes: 'Min',\r\n        play: 'Abspielen',\r\n        pause: 'Pause',\r\n        stop: 'Stopp',\r\n        nothing_playing: 'Nichts wird abgespielt',\r\n        entity_not_found: 'Entitt nicht gefunden',\r\n        rewinding: 'SPULEN',\r\n        no_trailer: 'Kein Trailer verfgbar',\r\n\r\n        // Editor\r\n        'editor.entity': 'Entitt',\r\n        'editor.title': 'Titel',\r\n        'editor.show_title': 'Titel anzeigen',\r\n        'editor.show_year': 'Jahr anzeigen',\r\n        'editor.show_runtime': 'Laufzeit anzeigen',\r\n        'editor.show_rating': 'Bewertung anzeigen',\r\n        'editor.show_genres': 'Genre anzeigen',\r\n        'editor.show_client': 'Jellyfin-Client anzeigen',\r\n        'editor.show_background': 'Hintergrund anzeigen',\r\n        'editor.show_media_type_badge': 'Medientyp-Abzeichen anzeigen',\r\n        'editor.show_watched_status': 'Gesehen-Status anzeigen',\r\n        'editor.show_date_added': 'Hinzugefgt am anzeigen',\r\n        'editor.show_description': 'Beschreibung anzeigen',\r\n        'editor.layout': 'Layout',\r\n        'editor.layout_carousel': 'Karussell',\r\n        'editor.layout_grid': 'Raster',\r\n        'editor.layout_list': 'Liste',\r\n        'editor.media_type': 'Medientyp',\r\n        'editor.media_type_both': 'Filme & Serien',\r\n        'editor.media_type_movies': 'Nur Filme',\r\n        'editor.media_type_series': 'Nur Serien',\r\n        'editor.media_type_next_up': 'Als Nchstes',\r\n        'editor.items_per_page': 'Elemente pro Seite',\r\n        'editor.max_pages': 'Max. Seiten (0 = kein Limit)',\r\n        'editor.auto_swipe': 'Auto-Swipe (Sek., 0 = aus)',\r\n        'editor.new_badge_days': 'Badge \"Neu\" Tage (0 = aus)',\r\n        'editor.click_action': 'Kurz drcken (Klick)',\r\n        'editor.hold_action': 'Lang drcken (Halten)',\r\n        'editor.double_tap_action': 'Doppeltippen',\r\n        'editor.action_jellyfin': 'In Jellyfin ffnen',\r\n        'editor.action_cast': 'An Chromecast senden',\r\n        'editor.action_more_info': 'Mehr Informationen',\r\n        'editor.action_trailer': 'Trailer ansehen',\r\n        'editor.action_none': 'Keine Aktion',\r\n        'editor.default_cast_device': 'Standard-Chromecast-Gert',\r\n        'editor.show_now_playing_overlay': '\"Jetzt luft\"-Overlay anzeigen',\r\n        'editor.metadata_position': 'Metadaten-Position',\r\n        'editor.metadata_below': 'Darunter',\r\n        'editor.metadata_above': 'Darber',\r\n        'editor.sort_order': 'Sortierung',\r\n        'editor.sort_date_added_desc': 'Hinzugefgt (Neueste zuerst)',\r\n        'editor.sort_date_added_asc': 'Hinzugefgt (lteste zuerst)',\r\n        'editor.sort_title_asc': 'Titel (A-Z)',\r\n        'editor.sort_title_desc': 'Titel (Z-A)',\r\n        'editor.sort_year_desc': 'Jahr (Neueste zuerst)',\r\n        'editor.sort_year_asc': 'Jahr (lteste zuerst)',\r\n        'editor.sort_last_played_desc': 'Zuletzt gespielt (Neueste zuerst)',\r\n        'editor.sort_last_played_asc': 'Zuletzt gespielt (lteste zuerst)',\r\n        'editor.enable_pagination': 'Seitennummerierung aktivieren',\r\n        'editor.show_pagination_dots': 'Paginierungspunkte anzeigen',\r\n        'editor.filter_watch_status': 'Gesehen-Status filtern',\r\n        'editor.filter_all': 'Alle',\r\n        'editor.filter_unwatched': 'Ungesehen',\r\n        'editor.filter_watched': 'Gesehen',\r\n        'editor.filter_favorites': 'Favoriten filtern',\r\n        'editor.filter_new_items': 'Neue Elemente filtern',\r\n        'editor.columns': 'Spalten',\r\n        'editor.rows': 'Zeilen',\r\n        'editor.now_playing_sensor': 'Sensor fr aktuelle Wiedergabe',\r\n        'editor.auto': 'Automatisch',\r\n        'editor.show_search': 'Suchleiste anzeigen',\r\n        'search.placeholder_title': 'Titel suchen',\r\n        'search.placeholder_genre': 'Genre',\r\n        'search.all_genres': 'Alle Genres',\r\n    },\r\n    fr: {\r\n        loading: 'Chargement',\r\n        no_media: 'Aucun mdia rcent trouv',\r\n        error: 'Erreur de chargement des mdias',\r\n        new: 'Nouveau',\r\n        minutes: 'min',\r\n        play: 'Lire',\r\n        pause: 'Pause',\r\n        stop: 'Arrt',\r\n        nothing_playing: 'Rien en lecture',\r\n        entity_not_found: 'Entit non trouve',\r\n        rewinding: 'BOBINAGE',\r\n        no_trailer: 'Aucune bande-annonce disponible',\r\n\r\n        // Editor\r\n        'editor.entity': 'Entit',\r\n        'editor.title': 'Titre',\r\n        'editor.show_title': 'Afficher le titre',\r\n        'editor.show_year': 'Afficher l\\'anne',\r\n        'editor.show_runtime': 'Afficher la dure',\r\n        'editor.show_rating': 'Afficher la note',\r\n        'editor.show_genres': 'Afficher le genre',\r\n        'editor.show_client': 'Afficher le client Jellyfin',\r\n        'editor.show_background': 'Afficher l\\'arrire-plan',\r\n        'editor.show_media_type_badge': 'Afficher le badge de type de mdia',\r\n        'editor.show_watched_status': 'Afficher le statut de visionnage',\r\n        'editor.show_date_added': 'Afficher la date d\\'ajout',\r\n        'editor.show_description': 'Afficher la description',\r\n        'editor.layout': 'Mise en page',\r\n        'editor.layout_carousel': 'Carrousel',\r\n        'editor.layout_grid': 'Grille',\r\n        'editor.layout_list': 'Liste',\r\n        'editor.media_type': 'Type de mdia',\r\n        'editor.media_type_both': 'Films et sries',\r\n        'editor.media_type_movies': 'Films seulement',\r\n        'editor.media_type_series': 'Sries seulement',\r\n        'editor.media_type_next_up': ' suivre',\r\n        'editor.items_per_page': 'lments par page',\r\n        'editor.max_pages': 'Pages max (0 = illimit)',\r\n        'editor.auto_swipe': 'Dfilement auto (sec, 0 = dsactiv)',\r\n        'editor.new_badge_days': 'Jours badge nouveau (0 = dsactiv)',\r\n        'editor.click_action': 'Appui court (Clic)',\r\n        'editor.hold_action': 'Appui long (Maintenir)',\r\n        'editor.double_tap_action': 'Double appui',\r\n        'editor.action_jellyfin': 'Ouvrir dans Jellyfin',\r\n        'editor.action_cast': 'Caster sur Chromecast',\r\n        'editor.action_more_info': 'Plus d\\'informations',\r\n        'editor.action_trailer': 'Voir la bande-annonce',\r\n        'editor.action_none': 'Aucune action',\r\n        'editor.default_cast_device': 'Appareil Cast par dfaut',\r\n        'editor.show_now_playing_overlay': 'Superposition \"En lecture\"',\r\n        'editor.metadata_position': 'Position des mtadonnes',\r\n        'editor.metadata_below': 'Dessous',\r\n        'editor.metadata_above': 'Dessus',\r\n        'editor.sort_order': 'Ordre de tri',\r\n        'editor.sort_date_added_desc': 'Date d\\'ajout (Plus rcent)',\r\n        'editor.sort_date_added_asc': 'Date d\\'ajout (Plus ancien)',\r\n        'editor.sort_title_asc': 'Titre (A-Z)',\r\n        'editor.sort_title_desc': 'Titre (Z-A)',\r\n        'editor.sort_year_desc': 'Anne (Plus rcent)',\r\n        'editor.sort_year_asc': 'Anne (Plus ancien)',\r\n        'editor.sort_last_played_desc': 'Dernire lecture (Plus rcent)',\r\n        'editor.sort_last_played_asc': 'Dernire lecture (Plus ancien)',\r\n        'editor.enable_pagination': 'Activer la pagination',\r\n        'editor.show_pagination_dots': 'Afficher les points de pagination',\r\n        'editor.filter_watch_status': 'Filtrer le statut de visionnage',\r\n        'editor.filter_all': 'Tous',\r\n        'editor.filter_unwatched': 'Non vus',\r\n        'editor.filter_watched': 'Vus',\r\n        'editor.filter_favorites': 'Filtrer les favoris',\r\n        'editor.filter_new_items': 'Filtrer les nouveaux lments',\r\n        'editor.columns': 'Colonnes',\r\n        'editor.rows': 'Lignes',\r\n        'editor.now_playing_sensor': 'Capteur de lecture en cours',\r\n        'editor.auto': 'Auto',\r\n        'editor.show_search': 'Afficher la barre de recherche',\r\n        'search.placeholder_title': 'Rechercher un titre',\r\n        'search.placeholder_genre': 'Genre',\r\n        'search.all_genres': 'Tous les genres',\r\n    },\r\n    es: {\r\n        loading: 'Cargando',\r\n        no_media: 'No se encontraron medios recientes',\r\n        error: 'Error al cargar medios',\r\n        new: 'Nuevo',\r\n        minutes: 'min',\r\n        play: 'Reproducir',\r\n        pause: 'Pausa',\r\n        stop: 'Detener',\r\n        nothing_playing: 'Nada sonando',\r\n        entity_not_found: 'Entidad no encontrada',\r\n        rewinding: 'REBOBINANDO',\r\n        no_trailer: 'No hay triler disponible',\r\n\r\n        // Editor\r\n        'editor.entity': 'Entidad',\r\n        'editor.title': 'Ttulo',\r\n        'editor.show_title': 'Mostrar ttulo',\r\n        'editor.show_year': 'Mostrar ao',\r\n        'editor.show_runtime': 'Mostrar duracin',\r\n        'editor.show_rating': 'Mostrar clasificacin',\r\n        'editor.show_genres': 'Mostrar gnero',\r\n        'editor.show_client': 'Mostrar cliente Jellyfin',\r\n        'editor.show_background': 'Mostrar fondo',\r\n        'editor.show_media_type_badge': 'Mostrar insignia de tipo de medio',\r\n        'editor.show_watched_status': 'Mostrar estado de visualizacin',\r\n        'editor.show_date_added': 'Mostrar fecha de adicin',\r\n        'editor.show_description': 'Mostrar descripcin',\r\n        'editor.layout': 'Diseo',\r\n        'editor.layout_carousel': 'Carrusel',\r\n        'editor.layout_grid': 'Cuadrcula',\r\n        'editor.layout_list': 'Lista',\r\n        'editor.media_type': 'Tipo de medio',\r\n        'editor.media_type_both': 'Pelculas y Series',\r\n        'editor.media_type_movies': 'Solo pelculas',\r\n        'editor.media_type_series': 'Solo series',\r\n        'editor.media_type_next_up': 'A continuacin',\r\n        'editor.items_per_page': 'Elementos por pgina',\r\n        'editor.max_pages': 'Mx. pginas (0 = sin lmite)',\r\n        'editor.auto_swipe': 'Deslizamiento automtico (seg, 0 = apagado)',\r\n        'editor.new_badge_days': 'Das de insignia nueva (0 = apagado)',\r\n        'editor.click_action': 'Pulsacin corta (Clic)',\r\n        'editor.hold_action': 'Pulsacin larga (Mantener)',\r\n        'editor.double_tap_action': 'Doble toque',\r\n        'editor.action_jellyfin': 'Abrir en Jellyfin',\r\n        'editor.action_cast': 'Cast a Chromecast',\r\n        'editor.action_more_info': 'Ms informacin',\r\n        'editor.action_trailer': 'Ver triler',\r\n        'editor.action_none': 'Ninguna accin',\r\n        'editor.default_cast_device': 'Dispositivo Cast predeterminado',\r\n        'editor.show_now_playing_overlay': 'Superposicin \"Reproduciendo\"',\r\n        'editor.metadata_position': 'Posicin de metadatos',\r\n        'editor.metadata_below': 'Debajo',\r\n        'editor.metadata_above': 'Arriba',\r\n        'editor.sort_order': 'Orden de clasificacin',\r\n        'editor.sort_date_added_desc': 'Fecha de adicin (Ms reciente)',\r\n        'editor.sort_date_added_asc': 'Fecha de adicin (Ms antiguo)',\r\n        'editor.sort_title_asc': 'Ttulo (A-Z)',\r\n        'editor.sort_title_desc': 'Ttulo (Z-A)',\r\n        'editor.sort_year_desc': 'Ao (Ms reciente)',\r\n        'editor.sort_year_asc': 'Ao (Ms antiguo)',\r\n        'editor.sort_last_played_desc': 'ltima reproduccin (Ms reciente)',\r\n        'editor.sort_last_played_asc': 'ltima reproduccin (Ms antiguo)',\r\n        'editor.enable_pagination': 'Habilitar paginacin',\r\n        'editor.show_pagination_dots': 'Mostrar puntos de paginacin',\r\n        'editor.filter_watch_status': 'Filtrar estado de visualizacin',\r\n        'editor.filter_all': 'Todos',\r\n        'editor.filter_unwatched': 'No vistos',\r\n        'editor.filter_watched': 'Vistos',\r\n        'editor.filter_favorites': 'Filtrar favoritos',\r\n        'editor.filter_new_items': 'Filtrar elementos nuevos',\r\n        'editor.columns': 'Columnas',\r\n        'editor.rows': 'Filas',\r\n        'editor.now_playing_sensor': 'Sensor de reproduccin actual',\r\n        'editor.auto': 'Auto',\r\n        'editor.show_search': 'Mostrar barra de bsqueda',\r\n        'search.placeholder_title': 'Buscar ttulo',\r\n        'search.placeholder_genre': 'Gnero',\r\n        'search.all_genres': 'Todos los gneros',\r\n    },\r\n    it: {\r\n        loading: 'Caricamento',\r\n        no_media: 'Nessun media recente trovato',\r\n        error: 'Errore nel caricamento dei media',\r\n        new: 'Nuovo',\r\n        minutes: 'min',\r\n        play: 'Riproduci',\r\n        pause: 'Pausa',\r\n        stop: 'Stop',\r\n        nothing_playing: 'Niente in riproduzione',\r\n        entity_not_found: 'Entit non trovata',\r\n        rewinding: 'RIAVVOLGIMENTO',\r\n        no_trailer: 'Nessun trailer disponibile',\r\n\r\n        // Editor\r\n        'editor.entity': 'Entit',\r\n        'editor.title': 'Titolo',\r\n        'editor.show_title': 'Mostra titolo',\r\n        'editor.show_year': 'Mostra anno',\r\n        'editor.show_runtime': 'Mostra durata',\r\n        'editor.show_rating': 'Mostra valutazione',\r\n        'editor.show_genres': 'Mostra genere',\r\n        'editor.show_client': 'Mostra client Jellyfin',\r\n        'editor.show_background': 'Mostra sfondo',\r\n        'editor.show_media_type_badge': 'Mostra badge tipo media',\r\n        'editor.show_watched_status': 'Mostra stato guardato',\r\n        'editor.show_date_added': 'Mostra data aggiunta',\r\n        'editor.show_description': 'Mostra descrizione',\r\n        'editor.layout': 'Layout',\r\n        'editor.layout_carousel': 'Carosello',\r\n        'editor.layout_grid': 'Griglia',\r\n        'editor.layout_list': 'Elenco',\r\n        'editor.media_type': 'Tipo di media',\r\n        'editor.media_type_both': 'Film e Serie TV',\r\n        'editor.media_type_movies': 'Solo Film',\r\n        'editor.media_type_series': 'Solo Serie TV',\r\n        'editor.media_type_next_up': 'In coda',\r\n        'editor.items_per_page': 'Elementi per pagina',\r\n        'editor.max_pages': 'Max pagine (0 = nessun limite)',\r\n        'editor.auto_swipe': 'Scorrimento automatico (sec, 0 = spento)',\r\n        'editor.new_badge_days': 'Giorni badge nuovo (0 = spento)',\r\n        'editor.click_action': 'Pressione breve (Click)',\r\n        'editor.hold_action': 'Pressione lunga (Tieni premuto)',\r\n        'editor.double_tap_action': 'Doppio tocco',\r\n        'editor.action_jellyfin': 'Apri in Jellyfin',\r\n        'editor.action_cast': 'Cast su Chromecast',\r\n        'editor.action_more_info': 'Pi informazioni',\r\n        'editor.action_trailer': 'Guarda il trailer',\r\n        'editor.action_none': 'Nessuna azione',\r\n        'editor.default_cast_device': 'Dispositivo Cast predefinito',\r\n        'editor.show_now_playing_overlay': 'Overlay \"In riproduzione\"',\r\n        'editor.metadata_position': 'Posizione metadati',\r\n        'editor.metadata_below': 'Sotto',\r\n        'editor.metadata_above': 'Sopra',\r\n        'editor.sort_order': 'Ordinamento',\r\n        'editor.sort_date_added_desc': 'Data aggiunta (Pi recente)',\r\n        'editor.sort_date_added_asc': 'Data aggiunta (Meno recente)',\r\n        'editor.sort_title_asc': 'Titolo (A-Z)',\r\n        'editor.sort_title_desc': 'Titolo (Z-A)',\r\n        'editor.sort_year_desc': 'Anno (Pi recente)',\r\n        'editor.sort_year_asc': 'Anno (Meno recente)',\r\n        'editor.sort_last_played_desc': 'Ultima riproduzione (Pi recente)',\r\n        'editor.sort_last_played_asc': 'Ultima riproduzione (Meno recente)',\r\n        'editor.enable_pagination': 'Abilita impaginazione',\r\n        'editor.show_pagination_dots': 'Mostra punti impaginazione',\r\n        'editor.filter_watch_status': 'Filtra stato guardato',\r\n        'editor.filter_all': 'Tutti',\r\n        'editor.filter_unwatched': 'Non guardati',\r\n        'editor.filter_watched': 'Guardati',\r\n        'editor.filter_favorites': 'Filtra preferiti',\r\n        'editor.filter_new_items': 'Filtra nuovi elementi',\r\n        'editor.columns': 'Colonne',\r\n        'editor.rows': 'Righe',\r\n        'editor.now_playing_sensor': 'Sensore in riproduzione',\r\n        'editor.auto': 'Auto',\r\n        'editor.show_search': 'Mostra barra di ricerca',\r\n        'search.placeholder_title': 'Cerca titolo',\r\n        'search.placeholder_genre': 'Genere',\r\n        'search.all_genres': 'Tutti i generi',\r\n    },\r\n    nl: {\r\n        loading: 'Laden',\r\n        no_media: 'Geen recente media gevonden',\r\n        error: 'Fout bij laden media',\r\n        new: 'Nieuw',\r\n        minutes: 'min',\r\n        play: 'Afspelen',\r\n        pause: 'Pauze',\r\n        stop: 'Stop',\r\n        nothing_playing: 'Niets aan het spelen',\r\n        entity_not_found: 'Entiteit niet gevonden',\r\n        rewinding: 'TERUGSPOELEN',\r\n        no_trailer: 'Geen trailer beschikbaar',\r\n\r\n        // Editor\r\n        'editor.entity': 'Entiteit',\r\n        'editor.title': 'Titel',\r\n        'editor.show_title': 'Titel tonen',\r\n        'editor.show_year': 'Jaar tonen',\r\n        'editor.show_runtime': 'Duur tonen',\r\n        'editor.show_rating': 'Beoordeling tonen',\r\n        'editor.show_genres': 'Genre tonen',\r\n        'editor.show_client': 'Jellyfin-client tonen',\r\n        'editor.show_background': 'Achtergrond tonen',\r\n        'editor.show_media_type_badge': 'Mediatype-badge tonen',\r\n        'editor.show_watched_status': 'Bekeken-status tonen',\r\n        'editor.show_date_added': 'Datum toegevoegd tonen',\r\n        'editor.show_description': 'Beschrijving tonen',\r\n        'editor.layout': 'Indeling',\r\n        'editor.layout_carousel': 'Carrousel',\r\n        'editor.layout_grid': 'Raster',\r\n        'editor.layout_list': 'Lijst',\r\n        'editor.media_type': 'Mediatype',\r\n        'editor.media_type_both': 'Films & Series',\r\n        'editor.media_type_movies': 'Alleen films',\r\n        'editor.media_type_series': 'Alleen series',\r\n        'editor.media_type_next_up': 'Volgende',\r\n        'editor.items_per_page': 'Items per pagina',\r\n        'editor.max_pages': 'Max. pagina\\'s (0 = geen limiet)',\r\n        'editor.auto_swipe': 'Auto-swipe (sec, 0 = uit)',\r\n        'editor.new_badge_days': 'Dagen badge nieuw (0 = uit)',\r\n        'editor.click_action': 'Kort indrukken (Klik)',\r\n        'editor.hold_action': 'Lang indrukken (Vasthouden)',\r\n        'editor.double_tap_action': 'Dubbel tikken',\r\n        'editor.action_jellyfin': 'Open in Jellyfin',\r\n        'editor.action_cast': 'Casten naar Chromecast',\r\n        'editor.action_more_info': 'Meer informatie',\r\n        'editor.action_trailer': 'Bekijk trailer',\r\n        'editor.action_none': 'Geen actie',\r\n        'editor.default_cast_device': 'Standaard Cast-apparaat',\r\n        'editor.show_now_playing_overlay': '\"Nu aan het spelen\"-overlay',\r\n        'editor.metadata_position': 'Positie metadata',\r\n        'editor.metadata_below': 'Onder',\r\n        'editor.metadata_above': 'Boven',\r\n        'editor.sort_order': 'Sorteervolgorde',\r\n        'editor.sort_date_added_desc': 'Datum toegevoegd (Nieuwste)',\r\n        'editor.sort_date_added_asc': 'Datum toegevoegd (Oudste)',\r\n        'editor.sort_title_asc': 'Titel (A-Z)',\r\n        'editor.sort_title_desc': 'Titel (Z-A)',\r\n        'editor.sort_year_desc': 'Jaar (Nieuwste)',\r\n        'editor.sort_year_asc': 'Jaar (Oudste)',\r\n        'editor.sort_last_played_desc': 'Laatst gespeeld (Nieuwste)',\r\n        'editor.sort_last_played_asc': 'Laatst gespeeld (Oudste)',\r\n        'editor.enable_pagination': 'Paginering inschakelen',\r\n        'editor.show_pagination_dots': 'Paginering-stippen tonen',\r\n        'editor.filter_watch_status': 'Kijkstatus filteren',\r\n        'editor.filter_all': 'Alles',\r\n        'editor.filter_unwatched': 'Onbekeken',\r\n        'editor.filter_watched': 'Bekeken',\r\n        'editor.filter_favorites': 'Favorieten filteren',\r\n        'editor.filter_new_items': 'Nieuwe items filteren',\r\n        'editor.columns': 'Kolommen',\r\n        'editor.rows': 'Rijen',\r\n        'editor.now_playing_sensor': 'Sensor \"Nu aan het spelen\"',\r\n        'editor.auto': 'Auto',\r\n        'editor.show_search': 'Zoekbalk tonen',\r\n        'search.placeholder_title': 'Zoek titel',\r\n        'search.placeholder_genre': 'Genre',\r\n        'search.all_genres': 'Alle genres',\r\n    },\r\n    sl: {\r\n        loading: 'Nalaganje',\r\n        no_media: 'Ni nedavnih medijev',\r\n        error: 'Napaka pri nalaganju medijev',\r\n        new: 'Novo',\r\n        minutes: 'min',\r\n        play: 'Predvajaj',\r\n        pause: 'Premor',\r\n        stop: 'Stop',\r\n        nothing_playing: 'Ni se ne predvaja',\r\n        entity_not_found: 'Entiteta ni najdena',\r\n        rewinding: 'PREVIJANJE',\r\n        no_trailer: 'Napovednik ni na voljo',\r\n\r\n        // Editor\r\n        'editor.entity': 'Entiteta',\r\n        'editor.title': 'Naslov',\r\n        'editor.show_title': 'Prikai naslov',\r\n        'editor.show_year': 'Prikai leto',\r\n        'editor.show_runtime': 'Prikai trajanje',\r\n        'editor.show_rating': 'Prikai oceno',\r\n        'editor.show_genres': 'Prikai anr',\r\n        'editor.show_client': 'Prikai Jellyfin odjemalec',\r\n        'editor.show_background': 'Prikai ozadje',\r\n        'editor.show_media_type_badge': 'Prikai znako tipa medija',\r\n        'editor.show_watched_status': 'Prikai status ogleda',\r\n        'editor.show_date_added': 'Prikai datum dodajanja',\r\n        'editor.show_description': 'Prikai opis',\r\n        'editor.layout': 'Postavitev',\r\n        'editor.layout_carousel': 'Vrtiljak',\r\n        'editor.layout_grid': 'Mrea',\r\n        'editor.layout_list': 'Seznam',\r\n        'editor.media_type': 'Tip medija',\r\n        'editor.media_type_both': 'Filmi in serije',\r\n        'editor.media_type_movies': 'Samo filmi',\r\n        'editor.media_type_series': 'Samo serije',\r\n        'editor.media_type_next_up': 'Naslednje',\r\n        'editor.items_per_page': 'Elementov na stran',\r\n        'editor.max_pages': 'Max strani (0 = brez omejitve)',\r\n        'editor.auto_swipe': 'Samodejno drsenje (sek, 0 = izklopljeno)',\r\n        'editor.new_badge_days': 'Dnevi za znako Novo (0 = izklopljeno)',\r\n        'editor.click_action': 'Kratek pritisk (Klik)',\r\n        'editor.hold_action': 'Dolg pritisk (Dri)',\r\n        'editor.double_tap_action': 'Dvojni dotik',\r\n        'editor.action_jellyfin': 'Odpri v Jellyfin',\r\n        'editor.action_cast': 'Predvajaj na Chromecast',\r\n        'editor.action_more_info': 'Ve informacij',\r\n        'editor.action_trailer': 'Poglej napovednik',\r\n        'editor.action_none': 'Brez akcije',\r\n        'editor.default_cast_device': 'Privzeta Chromecast naprava',\r\n        'editor.show_now_playing_overlay': 'Prikai \"Zdaj se predvaja\" prekrivanje',\r\n        'editor.metadata_position': 'Pozicija metapodatkov',\r\n        'editor.metadata_below': 'Spodaj',\r\n        'editor.metadata_above': 'Zgoraj',\r\n        'editor.sort_order': 'Vrstni red',\r\n        'editor.sort_date_added_desc': 'Datum dodajanja (Noveji naprej)',\r\n        'editor.sort_date_added_asc': 'Datum dodajanja (Stareji naprej)',\r\n        'editor.sort_title_asc': 'Naslov (A-Z)',\r\n        'editor.sort_title_desc': 'Naslov (Z-A)',\r\n        'editor.sort_year_desc': 'Leto (Noveji naprej)',\r\n        'editor.sort_year_asc': 'Leto (Stareji naprej)',\r\n        'editor.sort_last_played_desc': 'Zadnje predvajano (Noveji naprej)',\r\n        'editor.sort_last_played_asc': 'Zadnje predvajano (Stareji naprej)',\r\n        'editor.enable_pagination': 'Omogoi otevilevanje',\r\n        'editor.show_pagination_dots': 'Prikai pike otevilevanja',\r\n        'editor.filter_watch_status': 'Filtriraj status ogleda',\r\n        'editor.filter_all': 'Vse',\r\n        'editor.filter_unwatched': 'Neogledano',\r\n        'editor.filter_watched': 'Ogledano',\r\n        'editor.filter_favorites': 'Filtriraj priljubljene',\r\n        'editor.filter_new_items': 'Filtriraj nove elemente',\r\n        'editor.columns': 'Stolpci',\r\n        'editor.rows': 'Vrstice',\r\n        'editor.now_playing_sensor': 'Senzor predvajanja',\r\n        'editor.auto': 'Avtomatsko',\r\n        'editor.show_search': 'Prikai iskalno vrstico',\r\n        'search.placeholder_title': 'Ii naslov',\r\n        'search.placeholder_genre': 'anr',\r\n        'search.all_genres': 'Vsi anri',\r\n\r\n    },\r\n};\r\n\r\n/**\r\n * Get localized string\r\n * @param language - Language code (e.g., 'en', 'de')\r\n * @param key - Translation key\r\n * @returns Translated string or key if not found\r\n */\r\nexport function localize(language: string, key: string): string {\r\n    const lang = language.split('-')[0].toLowerCase();\r\n\r\n    // Try exact language\r\n    if (translations[lang]?.[key]) {\r\n        return translations[lang][key];\r\n    }\r\n\r\n    // Fallback to English\r\n    if (translations.en?.[key]) {\r\n        return translations.en[key];\r\n    }\r\n\r\n    // Return key if nothing found\r\n    return key;\r\n}\r\n","\r\nimport { LitElement, html, css, nothing, TemplateResult, render } from 'lit';\r\nimport { customElement, property, state, query } from 'lit/decorators.js';\r\nimport { HomeAssistant, MediaItem } from '../shared/types';\r\n\r\n@customElement('jellyha-item-details-modal')\r\nexport class JellyHAItemDetailsModal extends LitElement {\r\n    @property({ attribute: false }) public hass!: HomeAssistant;\r\n    @state() private _item?: MediaItem;\r\n    @state() private _nextUpItem?: MediaItem;\r\n    @state() private _defaultCastDevice?: string;\r\n    @state() private _open = false;\r\n    @state() private _confirmDelete = false;\r\n\r\n    // View States\r\n    @state() private _viewMode: 'default' | 'episodes' = 'default';\r\n    @state() private _episodes: MediaItem[] = [];\r\n\r\n    // Swipe to close state\r\n    @state() private _touchStartY = 0;\r\n    @state() private _currentTranslateY = 0;\r\n    @state() private _isDragging = false;\r\n    private _swipeClosingThreshold = 100;\r\n\r\n    private _portalContainer: HTMLElement | null = null;\r\n\r\n    public connectedCallback(): void {\r\n        super.connectedCallback();\r\n        this._portalContainer = document.createElement('div');\r\n        this._portalContainer.id = 'jellyha-modal-portal';\r\n        document.body.appendChild(this._portalContainer);\r\n    }\r\n\r\n    public disconnectedCallback(): void {\r\n        super.disconnectedCallback();\r\n        if (this._portalContainer) {\r\n            this._portalContainer.remove();\r\n            this._portalContainer = null;\r\n        }\r\n    }\r\n\r\n    public async showDialog(params: { item: MediaItem; hass: HomeAssistant; defaultCastDevice?: string }): Promise<void> {\r\n        this._item = params.item;\r\n        this.hass = params.hass;\r\n        this._defaultCastDevice = params.defaultCastDevice;\r\n        this._open = true;\r\n        this._open = true;\r\n        this._nextUpItem = undefined; // Reset\r\n        this._viewMode = 'default';\r\n        this._episodes = [];\r\n\r\n        if (this._item.type === 'Series') {\r\n            this._fetchNextUp(this._item);\r\n        }\r\n\r\n        // Fetch full details (MediaStreams, Backdrops) on demand\r\n        this._fetchFullDetails(this._item.id);\r\n\r\n        await this.updateComplete;\r\n    }\r\n\r\n    public closeDialog = () => {\r\n        this._open = false;\r\n        this._confirmDelete = false;\r\n        this.dispatchEvent(new CustomEvent('closed', { bubbles: true, composed: true }));\r\n        this.requestUpdate();\r\n    }\r\n\r\n    private async _fetchFullDetails(itemId: string): Promise<void> {\r\n        try {\r\n            // Fetch fresh details from backend (includes MediaStreams, Backdrops, etc.)\r\n            // Using callWS instead of callService to properly handle return_response\r\n            const response: any = await this.hass.callWS({\r\n                type: 'call_service',\r\n                domain: 'jellyha',\r\n                service: 'get_item',\r\n                service_data: {\r\n                    item_id: itemId,\r\n                    config_entry_id: this._item?.config_entry_id\r\n                },\r\n                return_response: true\r\n            });\r\n\r\n            // Access nested response from service call\r\n            const serviceResponse = response?.response || response;\r\n\r\n            if (serviceResponse && serviceResponse.item) {\r\n                // Merge details into existing item\r\n                this._item = { ...this._item!, ...serviceResponse.item };\r\n                this.requestUpdate();\r\n            }\r\n        } catch (err) {\r\n            console.warn('Failed to fetch full item details:', JSON.stringify(err, null, 2));\r\n        }\r\n    }\r\n\r\n    private async _fetchNextUp(series: MediaItem): Promise<void> {\r\n        // Find a valid entity_id for the WS call (we need the JellyHA sensor entity ID)\r\n        // We can try to find one from hass states that matches our integration\r\n        const entities = Object.keys(this.hass.states).filter(eid =>\r\n            this.hass.states[eid].attributes.integration === 'jellyha' ||\r\n            eid.startsWith('sensor.jellyha_') // Fallback convention\r\n        );\r\n\r\n        // Use the first one found, or if passed via config in card we could use that.\r\n        // But here we rely on the sensor being present.\r\n        const entityId = entities.length > 0 ? entities[0] : 'sensor.jellyha_library';\r\n\r\n        try {\r\n            const result = await this.hass.callWS<{ item: MediaItem | null }>({\r\n                type: 'jellyha/get_next_up',\r\n                entity_id: entityId,\r\n                series_id: series.id\r\n            });\r\n\r\n            if (result && result.item) {\r\n                this._nextUpItem = result.item;\r\n            }\r\n        } catch (err) {\r\n            console.warn('Failed to fetch Next Up:', err);\r\n        }\r\n    }\r\n\r\n    private async _fetchEpisodes(): Promise<void> {\r\n        if (!this._item || this._item.type !== 'Series' || !this._nextUpItem) return;\r\n\r\n        // Use the season from Next Up as the context\r\n        // If Next Up is s01e01, we fetch Season 1\r\n        const season = this._nextUpItem.season || 1;\r\n\r\n        // Find entity ID like in Next Up\r\n        const entities = Object.keys(this.hass.states).filter(eid =>\r\n            this.hass.states[eid].attributes.integration === 'jellyha' ||\r\n            eid.startsWith('sensor.jellyha_')\r\n        );\r\n        const entityId = entities.length > 0 ? entities[0] : 'sensor.jellyha_library';\r\n\r\n        try {\r\n            const result = await this.hass.callWS<{ items: MediaItem[] }>({\r\n                type: 'jellyha/get_episodes',\r\n                entity_id: entityId,\r\n                series_id: this._item.id,\r\n                season: season\r\n            });\r\n\r\n            if (result && result.items) {\r\n                this._episodes = result.items;\r\n                this._viewMode = 'episodes'; // Switch view once loaded\r\n                this.requestUpdate();\r\n            }\r\n        } catch (err) {\r\n            console.warn('Failed to fetch episodes:', err);\r\n        }\r\n    }\r\n\r\n    private _toggleEpisodesView = (e?: Event) => {\r\n        if (e) {\r\n            e.stopPropagation();\r\n            e.preventDefault();\r\n        }\r\n        if (this._viewMode === 'default') {\r\n            this._fetchEpisodes();\r\n        } else {\r\n            this._viewMode = 'default';\r\n        }\r\n    }\r\n\r\n\r\n    protected updated(): void {\r\n        if (this._portalContainer) {\r\n            render(this._renderDialogContent(), this._portalContainer);\r\n\r\n            // Manually attach non-passive listeners to content\r\n            const content = this._portalContainer.querySelector('.content');\r\n            if (content) {\r\n                // Remove old (deduping)\r\n                content.removeEventListener('touchstart', this._handleModalTouchStart as any);\r\n                content.removeEventListener('touchmove', this._handleModalTouchMove as any);\r\n                content.removeEventListener('touchend', this._handleModalTouchEnd as any);\r\n\r\n                // Add new\r\n                content.addEventListener('touchstart', this._handleModalTouchStart as any, { passive: true });\r\n                content.addEventListener('touchmove', this._handleModalTouchMove as any, { passive: false }); // Key fix\r\n                content.addEventListener('touchend', this._handleModalTouchEnd as any, { passive: true });\r\n            }\r\n        }\r\n    }\r\n\r\n    protected render(): TemplateResult {\r\n        return html``;\r\n    }\r\n\r\n\r\n    static styles = css`\r\n        /* Styles handled in _getPortalStyles */\r\n    `;\r\n\r\n    private _getPortalStyles() {\r\n        return html`\r\n        <style>\r\n             ha-dialog {\r\n                --mdc-dialog-z-index: 9999;\r\n                --mdc-dialog-min-width: 400px;\r\n                --mdc-dialog-max-width: 90vw;\r\n                --mdc-theme-surface: transparent; \r\n                --ha-dialog-background: transparent;\r\n                --mdc-dialog-box-shadow: none;\r\n                --dialog-content-padding: 0;\r\n                --mdc-dialog-content-padding: 0;\r\n                --dialog-surface-margin: 0;\r\n             }\r\n\r\n            .content {\r\n                display: flex; /* Flex container for children scrollers */\r\n                flex-direction: column;\r\n                \r\n                transform-origin: top center;\r\n                will-change: transform;\r\n                background: var(--ha-card-background, var(--card-background-color, #1c1c1c));\r\n                border-radius: 20px;\r\n                box-shadow: 0 10px 40px rgba(0,0,0,0.5); /* Card shadow */\r\n                padding: 24px;\r\n                max-height: 80vh;\r\n                overscroll-behavior-y: contain; /* Prevent browser overscroll/refresh */\r\n                \r\n                /* Hide scrollbar on the container itself */\r\n                scrollbar-width: none; \r\n                -ms-overflow-style: none; \r\n                overflow: hidden; /* Clip content to rounded corners */\r\n            }\r\n            \r\n            /* Episodes View specific */\r\n            .content.episodes {\r\n                overflow: hidden !important; \r\n                padding-right: 24px; \r\n            }\r\n\r\n            .content::-webkit-scrollbar {\r\n                display: none; \r\n                width: 0px !important;\r\n                height: 0px !important;\r\n                background: transparent;\r\n            }\r\n\r\n            /* Inner Layouts (Default View) */\r\n            .default-layout {\r\n                display: block; /* Mobile default */\r\n                overflow-y: auto;\r\n                height: 100%;\r\n                width: 100%;\r\n                padding-right: 4px; /* Space for scrollbar */\r\n                \r\n                /* Inset Scrollbar */\r\n                scrollbar-width: thin; \r\n                scrollbar-color: rgba(255, 255, 255, 0.2) transparent;\r\n            }\r\n            .default-layout::-webkit-scrollbar {\r\n                display: block;\r\n                width: 6px !important;\r\n                height: 6px !important;\r\n            }\r\n            .default-layout::-webkit-scrollbar-thumb {\r\n                background: rgba(255, 255, 255, 0.2);\r\n                border-radius: 3px;\r\n            }\r\n            .default-layout::-webkit-scrollbar-track {\r\n                background: transparent;\r\n            }\r\n\r\n            /* Desktop Grid */\r\n            @media (min-width: 601px) {\r\n                .default-layout {\r\n                    display: grid;\r\n                    grid-template-columns: 300px 1fr;\r\n                    gap: 24px;\r\n                    overflow-y: auto; \r\n                }\r\n                .content.episodes {\r\n                    max-height: 80vh;\r\n                }\r\n            }\r\n\r\n            .poster-col {\r\n                display: flex;\r\n                flex-direction: column;\r\n                gap: 16px;\r\n            }\r\n\r\n            .poster-img {\r\n                width: 100%;\r\n                aspect-ratio: 2/3;\r\n                object-fit: cover;\r\n                border-radius: 12px;\r\n                box-shadow: 0 4px 12px rgba(0,0,0,0.3);\r\n            }\r\n\r\n            .actions-col {\r\n                display: flex;\r\n                flex-direction: row;\r\n                gap: 0;\r\n                justify-content: space-between;\r\n                align-items: center;\r\n                min-height: 44px; /* Maintain height for delete confirmation */\r\n                width: 100%;\r\n            }\r\n\r\n            .details-col {\r\n                display: flex;\r\n                flex-direction: column;\r\n                gap: 16px;\r\n            }\r\n\r\n            .header-group h1 {\r\n                margin: 0;\r\n                font-size: 2rem;\r\n                font-weight: 700;\r\n                line-height: 1.2;\r\n                color: var(--primary-text-color);\r\n            }\r\n\r\n            .header-sub {\r\n                display: flex;\r\n                gap: 12px;\r\n                align-items: center;\r\n                margin-top: 8px;\r\n                color: var(--secondary-text-color);\r\n                font-size: 1rem;\r\n            }\r\n\r\n            .badge {\r\n                padding: 4px 8px;\r\n                border-radius: 6px;\r\n                background: rgba(var(--rgb-primary-text-color), 0.1);\r\n                font-size: 0.85rem;\r\n                font-weight: 600;\r\n                text-transform: uppercase;\r\n            }\r\n\r\n            .stats-row {\r\n                display: flex;\r\n                flex-wrap: wrap;\r\n                gap: 8px; /* Tighter gap for chips */\r\n                padding: 4px 0; /* Minimal vertical padding */\r\n                /* Remove container background for native look */\r\n                background: transparent;\r\n                border-radius: 0;\r\n            }\r\n\r\n            .stat-item {\r\n                display: flex;\r\n                gap: 6px;\r\n                align-items: center;\r\n                /* Native Chip Styling */\r\n                border: 1px solid var(--divider-color);\r\n                border-radius: 18px;\r\n                padding: 6px 12px;\r\n                font-size: 0.9rem;\r\n                font-weight: 500;\r\n                color: var(--primary-text-color);\r\n                background: transparent; \r\n            }\r\n\r\n            .description {\r\n                font-size: 1rem;\r\n                line-height: 1.6;\r\n                color: var(--primary-text-color);\r\n                white-space: pre-wrap;\r\n            }\r\n\r\n            .genres-list {\r\n                display: flex;\r\n                flex-wrap: wrap;\r\n                gap: 8px;\r\n            }\r\n\r\n            .genre-tag {\r\n                background: rgba(var(--rgb-primary-color), 0.15);\r\n                color: var(--primary-color);\r\n                padding: 4px 12px;\r\n                border-radius: 16px;\r\n                font-size: 0.85rem;\r\n                border: 1px solid rgba(var(--rgb-primary-color), 0.3);\r\n            }\r\n\r\n            .divider {\r\n                height: 1px;\r\n                background: var(--divider-color);\r\n                margin: 8px 0;\r\n            }\r\n\r\n            .media-info-grid {\r\n                display: grid;\r\n                grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));\r\n                gap: 12px;\r\n                font-size: 0.85rem;\r\n                color: var(--secondary-text-color);\r\n            }\r\n\r\n            .info-pair b {\r\n                color: var(--primary-text-color);\r\n                display: block;\r\n                margin-bottom: 2px;\r\n            }\r\n\r\n            .action-btn {\r\n                display: flex;\r\n                align-items: center;\r\n                justify-content: center;\r\n                padding: 10px;\r\n                border-radius: 50%; /* Circle shape */\r\n                border: none;\r\n                cursor: pointer;\r\n                background: transparent;\r\n                color: var(--secondary-text-color);\r\n                width: 44px;\r\n                height: 44px;\r\n                box-sizing: border-box;\r\n                transition: background 0.2s, color 0.2s;\r\n            }\r\n\r\n            .action-btn:hover {\r\n                background: rgba(255, 255, 255, 0.1);\r\n                color: var(--primary-text-color);\r\n            }\r\n\r\n            .action-btn.active {\r\n                color: var(--primary-color);\r\n            }\r\n            .favorite-btn.active {\r\n                color: #F44336;\r\n            }\r\n\r\n            .action-btn ha-icon {\r\n                --mdc-icon-size: 26px;\r\n            }\r\n\r\n            .btn-danger {\r\n                color: var(--error-color, #f44336);\r\n            }\r\n            .btn-danger:hover {\r\n                background: rgba(244, 67, 54, 0.15);\r\n            }\r\n\r\n            .confirmation-box {\r\n                display: flex;\r\n                gap: 12px;\r\n                align-items: center;\r\n                justify-content: center;\r\n                width: 100%;\r\n                background: rgba(244, 67, 54, 0.1);\r\n                border-radius: 8px;\r\n                padding: 4px 8px;\r\n            }\r\n            \r\n            .confirm-btn {\r\n                background: none;\r\n                border: none;\r\n                cursor: pointer;\r\n                color: var(--primary-text-color);\r\n                font-weight: 600;\r\n                padding: 8px 16px;\r\n                border-radius: 4px;\r\n            }\r\n            .confirm-btn:hover {\r\n                 background: rgba(255,255,255,0.1);\r\n            }\r\n            .confirm-yes {\r\n                color: var(--error-color);\r\n            }\r\n\r\n\r\n\r\n            /* Next Up Section */\r\n            .next-up-card {\r\n                background: var(--secondary-background-color, rgba(0, 0, 0, 0.1));\r\n                border-radius: 12px;\r\n                padding: 12px;\r\n                display: flex;\r\n                gap: 16px;\r\n                align-items: center;\r\n                margin-top: 16px;\r\n                border: 1px solid var(--divider-color);\r\n                cursor: pointer;\r\n                transition: background 0.2s, transform 0.1s;\r\n                position: relative;\r\n                overflow: hidden;\r\n            }\r\n            .next-up-card:hover {\r\n                background: rgba(var(--rgb-primary-text-color), 0.05);\r\n            }\r\n            .next-up-card:active {\r\n                background: rgba(var(--rgb-primary-text-color), 0.1);\r\n                transform: scale(0.98); /* Button press effect */\r\n            }\r\n            .next-up-thumb {\r\n                width: 120px;\r\n                aspect-ratio: 16/9;\r\n                object-fit: cover;\r\n                border-radius: 8px;\r\n            }\r\n            .next-up-info {\r\n                flex: 1;\r\n                display: flex;\r\n                flex-direction: column;\r\n                gap: 4px;\r\n            }\r\n            .next-up-label {\r\n                font-size: 0.75rem;\r\n                text-transform: uppercase;\r\n                letter-spacing: 0.5px;\r\n                color: var(--primary-color);\r\n                font-weight: 700;\r\n            }\r\n            .next-up-title {\r\n                font-size: 1.1rem;\r\n                font-weight: 600;\r\n                color: var(--primary-text-color);\r\n                margin: 0;\r\n            }\r\n            .next-up-meta {\r\n                font-size: 0.9rem;\r\n                color: var(--secondary-text-color);\r\n            }\r\n\r\n            @media (max-width: 600px) {\r\n                .poster-col { max-width: 350px; margin: 0 auto; width: 100%; margin-bottom: 24px; }\r\n            }\r\n\r\n            /* Episode List Styles */\r\n            .episodes-header {\r\n                 display: flex;\r\n                 align-items: center;\r\n                 gap: 12px;\r\n                 margin-bottom: 16px;\r\n            }\r\n            .back-btn {\r\n                background: none;\r\n                border: none;\r\n                color: var(--primary-text-color);\r\n                cursor: pointer;\r\n                padding: 8px;\r\n                border-radius: 50%;\r\n                display: flex; /* Fix icon alignment */\r\n            }\r\n            .back-btn:hover {\r\n                background: rgba(255,255,255,0.1);\r\n            }\r\n            .episodes-title {\r\n                margin: 0;\r\n                font-size: 1.5rem;\r\n                font-weight: 600;\r\n            }\r\n            .episodes-list {\r\n                display: flex;\r\n                flex-direction: column;\r\n                gap: 12px;\r\n                overflow-y: auto;\r\n                flex: 1; /* Take remaining height */\r\n                min-height: 0; /* Flexbox scroll fix */\r\n                padding-right: 4px; /* Space for scrollbar */\r\n                \r\n                /* Re-enable scrollbars for this list */\r\n                scrollbar-width: thin; \r\n                scrollbar-color: rgba(255, 255, 255, 0.2) transparent;\r\n            }\r\n            .episodes-list::-webkit-scrollbar {\r\n                display: block;\r\n                width: 6px !important;\r\n                height: 6px !important;\r\n            }\r\n            .episodes-list::-webkit-scrollbar-thumb {\r\n                background: rgba(255, 255, 255, 0.2);\r\n                border-radius: 3px;\r\n            }\r\n            .episodes-list::-webkit-scrollbar-track {\r\n                background: transparent;\r\n            }\r\n            .episode-row {\r\n                display: flex;\r\n                gap: 16px;\r\n                padding: 12px;\r\n                background: rgba(255,255,255,0.03);\r\n                border-radius: 12px;\r\n                align-items: center;\r\n                transition: background 0.2s;\r\n            }\r\n            .episode-row:hover {\r\n                background: rgba(255,255,255,0.08); /* Slightly lighter on hover */\r\n            }\r\n            .episode-row.next-up-highlight {\r\n                background: rgba(var(--rgb-primary-color), 0.1);\r\n                border-left: 3px solid var(--primary-color);\r\n            }\r\n            .episode-content {\r\n                flex: 1;\r\n                min-width: 0;\r\n                display: flex;\r\n                flex-direction: column;\r\n                justify-content: center;\r\n                gap: 4px;\r\n            }\r\n            .episode-footer {\r\n                display: flex;\r\n                justify-content: space-between;\r\n                align-items: center;\r\n            }\r\n            .episode-actions {\r\n                display: flex;\r\n                gap: 12px;\r\n            }\r\n            .episode-thumb {\r\n                width: 100px;\r\n                aspect-ratio: 16/9;\r\n                object-fit: cover;\r\n                border-radius: 8px;\r\n                flex-shrink: 0; \r\n                background: var(--secondary-background-color); /* Skeleton placeholder */\r\n                border: 1px solid rgba(255, 255, 255, 0.5);\r\n            }\r\n            .episode-info {\r\n                flex: 1;\r\n                min-width: 0; /* truncate text */\r\n            }\r\n            .episode-title {\r\n                margin: 0;\r\n                font-size: 1rem;\r\n                font-weight: 500;\r\n                line-height: 1.2;\r\n                color: var(--primary-text-color);\r\n            }\r\n            .episode-meta {\r\n                font-size: 0.85rem;\r\n                color: var(--secondary-text-color);\r\n                display: flex;\r\n                align-items: center;\r\n            }\r\n            .play-episode-btn {\r\n                background: transparent;\r\n                border: none;\r\n                color: var(--primary-color);\r\n                border-radius: 50%; /* Keep radius for hover effect */\r\n                width: 36px;\r\n                height: 36px;\r\n                display: flex;\r\n                align-items: center;\r\n                justify-content: center;\r\n                cursor: pointer;\r\n                transition: all 0.2s;\r\n            }\r\n            .play-episode-btn:hover {\r\n                background: rgba(255, 255, 255, 0.15);\r\n                color: var(--primary-color);\r\n            }\r\n            /* Specific override for the checkmark button */\r\n            .watched-btn {\r\n                color: var(--secondary-text-color);\r\n                opacity: 0.6;\r\n            }\r\n            .watched-btn:hover {\r\n                opacity: 1;\r\n            }\r\n            .watched-btn.active {\r\n                color: var(--primary-color);\r\n                opacity: 1;\r\n            }\r\n        </style>\r\n        `;\r\n    }\r\n\r\n    private _renderDialogContent(): TemplateResult {\r\n        if (!this._open || !this._item) return html``;\r\n\r\n        return html`\r\n            ${this._getPortalStyles()}\r\n            <ha-dialog\r\n                open\r\n                .escapeKeyAction=${\"close\"}\r\n                .scrimClickAction=${\"close\"}\r\n                @closed=${this.closeDialog}\r\n                hideActions\r\n                .heading=${\"\"} \r\n            >\r\n                <ha-card \r\n                    class=\"content ${this._viewMode}\"\r\n                    style=\"${this._isDragging || this._currentTranslateY > 0 ? `transform: translateY(${this._currentTranslateY}px); transition: ${this._isDragging ? 'none' : 'transform 0.3s ease-out'}` : ''}\"\r\n                >\r\n                    ${this._viewMode === 'episodes' ? this._renderEpisodesContent() : this._renderDefaultContent()}\r\n                </ha-card>\r\n            </ha-dialog>\r\n        `;\r\n    }\r\n\r\n    private _renderDefaultContent(): TemplateResult {\r\n        if (!this._item) return html``;\r\n        const item = this._item;\r\n        const isSeries = item.type === 'Series';\r\n        const year = item.year || (item.date_added ? new Date(item.date_added).getFullYear() : '');\r\n\r\n        return html`\r\n        <div class=\"default-layout\">\r\n            <div class=\"poster-col\">\r\n                <img class=\"poster-img\" src=\"${item.poster_url}\" alt=\"${item.name}\" />\r\n\r\n                <div class=\"actions-col\">\r\n                    ${this._confirmDelete\r\n                ? html`\r\n                        <div class=\"confirmation-box\">\r\n                            <span>Delete?</span>\r\n                            <button class=\"confirm-btn confirm-yes\" @click=${this._handleDeleteConfirm}>Yes</button>\r\n                            <button class=\"confirm-btn\" @click=${() => this._confirmDelete = false}>No</button>\r\n                        </div>\r\n                        `\r\n                : html`\r\n                        <button class=\"action-btn\" @click=${this._handlePlay} title=\"Play on Chromecast\">\r\n                            <ha-icon icon=\"mdi:cast\"></ha-icon>\r\n                        </button>\r\n                        \r\n                        ${isSeries && this._nextUpItem ? html`\r\n                                <button class=\"action-btn\" @click=${(e: Event) => { this._haptic(); this._toggleEpisodesView(e); }} title=\"View All Episodes\" type=\"button\">\r\n                                <ha-icon icon=\"mdi:format-list-bulleted\"></ha-icon>\r\n                                </button>\r\n                        ` : nothing}\r\n\r\n                        ${item.trailer_url ? html`\r\n                            <button class=\"action-btn\" @click=${this._handleWatchTrailer} title=\"Watch Trailer\">\r\n                                <ha-icon icon=\"mdi:filmstrip\"></ha-icon>\r\n                        ` : nothing}\r\n\r\n                        <button class=\"action-btn ${item.is_played ? 'active' : ''}\" @click=${this._handleWatched} title=\"${item.is_played ? 'Mark Unwatched' : 'Mark Watched'}\">\r\n                            <ha-icon icon=\"mdi:check\"></ha-icon>\r\n                        </button>\r\n\r\n                        <button class=\"action-btn favorite-btn ${item.is_favorite ? 'active' : ''}\" @click=${this._handleFavorite} title=\"${item.is_favorite ? 'Remove Favorite' : 'Add to Favorites'}\">\r\n                                <ha-icon icon=\"${item.is_favorite ? 'mdi:heart' : 'mdi:heart-outline'}\"></ha-icon>\r\n                        </button>\r\n\r\n                        <a href=\"${item.jellyfin_url}\" class=\"action-btn\" target=\"_blank\" title=\"Open in Jellyfin\" @click=${() => this._haptic()}>\r\n                            <ha-icon icon=\"mdi:popcorn\"></ha-icon>\r\n                        </a>\r\n\r\n                        <button class=\"action-btn\" @click=${() => { this._haptic(); this._confirmDelete = true; }} title=\"Delete Item\">\r\n                            <ha-icon icon=\"mdi:trash-can-outline\"></ha-icon>\r\n                        </button>\r\n                        \r\n                    `}\r\n                </div>\r\n            </div>\r\n\r\n            <div class=\"details-col\">\r\n                <div class=\"header-group\">\r\n                    <h1>${item.name}</h1>\r\n                    <div class=\"header-sub\">\r\n                        ${year ? html`<span>${year}</span>` : nothing}\r\n                        <span class=\"badge\">${item.type}</span>\r\n                        ${item.official_rating ? html`<span class=\"badge\">${item.official_rating}</span>` : nothing}\r\n                    </div>\r\n                </div>\r\n                \r\n                ${this._nextUpItem ? html`\r\n                    <div class=\"next-up-card\" @click=${this._playNextUp}>\r\n                        <img class=\"next-up-thumb\" src=\"${this._nextUpItem.backdrop_url || this._nextUpItem.poster_url}\" />\r\n                        <div class=\"next-up-info\">\r\n                            <span class=\"next-up-label\">Next Up</span>\r\n                            <h3 class=\"next-up-title\">${this._nextUpItem.name}</h3>\r\n                            <span class=\"next-up-meta\">S${this._nextUpItem.season} : E${this._nextUpItem.episode}  ${this._formatRuntime(this._nextUpItem.runtime_minutes)}</span>\r\n                        </div>\r\n                        <ha-icon icon=\"mdi:cast\" style=\"font-size: 36px; color: var(--primary-color); opacity: 1;\"></ha-icon>\r\n                    </div>\r\n                ` : nothing}\r\n\r\n                <div class=\"stats-row\">\r\n                    <div class=\"stat-item\">\r\n                        <ha-icon icon=\"mdi:star\" style=\"color: #FBC02D;\"></ha-icon>\r\n                        <span>${item.rating ? item.rating.toFixed(1) : 'N/A'}</span>\r\n                    </div>\r\n                    ${isSeries ? html`\r\n                        <div class=\"stat-item\">\r\n                            <ha-icon icon=\"mdi:television-classic\"></ha-icon>\r\n                            <span>${item.unplayed_count !== undefined ? item.unplayed_count + ' Unplayed' : ''}</span>\r\n                        </div>\r\n                        ` : html`\r\n                        <div class=\"stat-item\">\r\n                            <ha-icon icon=\"mdi:clock-outline\"></ha-icon>\r\n                            <span>${this._formatRuntime(item.runtime_minutes)}</span>\r\n                        </div>\r\n                        `}\r\n                </div>\r\n\r\n                    ${item.description ? html`<div class=\"description\">${item.description}</div>` : nothing}\r\n\r\n                    ${item.genres && item.genres.length > 0 ? html`\r\n                    <div class=\"genres-list\">\r\n                        ${item.genres.map(g => html`<span class=\"genre-tag\">${g}</span>`)}\r\n                    </div>\r\n                    ` : nothing}\r\n                \r\n                    <div class=\"divider\"></div>\r\n\r\n                    <div class=\"media-info-grid\">\r\n                    ${this._renderMediaDetails(isSeries && this._nextUpItem ? this._nextUpItem : item)}\r\n                    </div>\r\n            </div>\r\n        </div>\r\n        `;\r\n    }\r\n\r\n    private _renderEpisodesContent(): TemplateResult {\r\n        if (!this._item || !this._nextUpItem) return html``;\r\n\r\n        // Prefer explicit season name, fallback to \"Season X\"\r\n        const title = this._item.name;\r\n\r\n        // Use full height wrapper for sticky header + scrollable list\r\n        return html`\r\n            <div style=\"display: flex; flex-direction: column; height: 100%; overflow: hidden;\">\r\n                <div class=\"episodes-header\">\r\n                    <button class=\"back-btn\" @click=${(e: Event) => this._toggleEpisodesView(e)} type=\"button\">\r\n                        <ha-icon icon=\"mdi:arrow-left\"></ha-icon>\r\n                    </button>\r\n                    <h2 class=\"episodes-title\">${title}</h2>\r\n                </div>\r\n                \r\n                <div class=\"episodes-list\">\r\n                    ${this._episodes.map(ep => html`\r\n                        <div class=\"episode-row ${this._nextUpItem && ep.id === this._nextUpItem.id ? 'next-up-highlight' : ''}\" @click=${(e: Event) => { e.stopPropagation(); this._handlePlayEpisode(ep); }}>\r\n                            <img class=\"episode-thumb\" src=\"${ep.backdrop_url || ep.poster_url || this._item!.backdrop_url}\" />\r\n                            \r\n                            <div class=\"episode-content\">\r\n                                <h4 class=\"episode-title\">\r\n                                    ${ep.episode || ep.index_number}. ${ep.name}\r\n                                    ${this._nextUpItem && ep.id === this._nextUpItem.id ? html`<span style=\"font-size: 0.7em; background: var(--primary-color); color: white; padding: 2px 6px; border-radius: 4px; margin-left: 8px; vertical-align: middle; white-space: nowrap;\">NEXT UP</span>` : nothing}\r\n                                </h4>\r\n                                \r\n                                <div class=\"episode-footer\">\r\n                                    <div class=\"episode-meta\">\r\n                                        <span>${this._formatRuntime(ep.runtime_minutes)}</span>\r\n                                        ${ep.rating !== undefined ? html` <ha-icon icon=\"mdi:star\" style=\"--mdc-icon-size: 14px; color: #FBC02D; margin-left: 6px; transform: translateY(-1px);\"></ha-icon> ${ep.rating.toFixed(1)}` : nothing}\r\n                                    </div>\r\n\r\n                                    <div class=\"episode-actions\">\r\n                                        <button class=\"play-episode-btn watched-btn ${ep.is_played ? 'active' : ''}\" @click=${(e: Event) => { e.stopPropagation(); this._handleMarkEpisodeWatched(ep); }} type=\"button\" title=\"${ep.is_played ? 'Mark Unwatched' : 'Mark Watched'}\">\r\n                                            <ha-icon icon=\"mdi:check\"></ha-icon>\r\n                                        </button>\r\n\r\n                                        <button class=\"play-episode-btn\" @click=${(e: Event) => { e.stopPropagation(); this._handlePlayEpisode(ep); }} type=\"button\">\r\n                                            <ha-icon icon=\"mdi:cast\"></ha-icon>\r\n                                        </button>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    `)}\r\n                </div>\r\n            </div>\r\n        `;\r\n    }\r\n\r\n    private _formatRuntime(minutes?: number): string {\r\n        if (!minutes) return '';\r\n        const hours = Math.floor(minutes / 60);\r\n        const mins = minutes % 60;\r\n        if (hours > 0) return `${hours}h ${mins}m`;\r\n        return `${mins} min`;\r\n    }\r\n\r\n    private _renderMediaDetails(item: MediaItem): TemplateResult[] {\r\n        const details: TemplateResult[] = [];\r\n        const streams = item.media_streams || [];\r\n\r\n        // Find Video Stream\r\n        const videoStream = streams.find(s => s.Type?.toLowerCase() === 'video');\r\n        if (videoStream) {\r\n            if (videoStream.Codec) details.push(html`<div class=\"info-pair\"><b>Video</b><span>${videoStream.Codec.toUpperCase()}</span></div>`);\r\n            if (videoStream.Width && videoStream.Height) details.push(html`<div class=\"info-pair\"><b>Resolution</b><span>${videoStream.Width}x${videoStream.Height}</span></div>`);\r\n        }\r\n\r\n        // Find Primary Audio Stream (Default or First)\r\n        const audioStream = streams.find(s => s.Type?.toLowerCase() === 'audio' && !!s.IsDefault) ||\r\n            streams.find(s => s.Type?.toLowerCase() === 'audio');\r\n\r\n        if (audioStream) {\r\n            if (audioStream.Codec) details.push(html`<div class=\"info-pair\"><b>Audio</b><span>${audioStream.Codec.toUpperCase()}</span></div>`);\r\n            if (audioStream.Channels) details.push(html`<div class=\"info-pair\"><b>Channels</b><span>${audioStream.Channels} ch</span></div>`);\r\n        }\r\n        return details;\r\n    }\r\n\r\n\r\n    private _handlePlayEpisode = async (episode: MediaItem) => {\r\n        this._haptic();\r\n        if (!this._defaultCastDevice) {\r\n            this.dispatchEvent(new CustomEvent('hass-notification', {\r\n                detail: { message: 'No Chromecast device selected. Please configure a cast device in the card editor.' },\r\n                bubbles: true,\r\n                composed: true\r\n            }));\r\n            return;\r\n        }\r\n        try {\r\n            await this.hass.callService('jellyha', 'play_on_chromecast', {\r\n                entity_id: this._defaultCastDevice,\r\n                item_id: episode.id,\r\n            });\r\n            this.closeDialog();\r\n        } catch (err) {\r\n            console.error('Failed to cast episode', err);\r\n            this.dispatchEvent(new CustomEvent('hass-notification', {\r\n                detail: { message: 'Failed to cast episode. Check logs.' },\r\n                bubbles: true,\r\n                composed: true\r\n            }));\r\n        }\r\n    }\r\n\r\n    private _handlePlay = async () => {\r\n        this._haptic();\r\n        if (!this._item || !this._defaultCastDevice) {\r\n            if (!this._defaultCastDevice) {\r\n                this.dispatchEvent(new CustomEvent('hass-notification', {\r\n                    detail: { message: 'No Chromecast device selected. Please configure a cast device in the card editor.' },\r\n                    bubbles: true,\r\n                    composed: true\r\n                }));\r\n            }\r\n            return;\r\n        }\r\n        try {\r\n            await this.hass.callService('jellyha', 'play_on_chromecast', {\r\n                entity_id: this._defaultCastDevice,\r\n                item_id: this._item.id,\r\n            });\r\n            this.closeDialog();\r\n        } catch (err) {\r\n            console.error('Failed to cast', err);\r\n        }\r\n    }\r\n\r\n    private _haptic(type: 'selection' | 'light' | 'medium' | 'heavy' | 'success' | 'warning' | 'failure' = 'selection') {\r\n        const event = new CustomEvent('haptic', {\r\n            detail: type,\r\n            bubbles: true,\r\n            composed: true\r\n        });\r\n        this.dispatchEvent(event);\r\n    }\r\n\r\n    private _playNextUp = async () => {\r\n        this._haptic();\r\n\r\n        if (!this._nextUpItem || !this._defaultCastDevice) {\r\n            if (!this._defaultCastDevice) {\r\n                this.dispatchEvent(new CustomEvent('hass-notification', {\r\n                    detail: { message: 'No Chromecast device selected. Please configure a cast device in the card editor.' },\r\n                    bubbles: true,\r\n                    composed: true\r\n                }));\r\n            }\r\n            return;\r\n        }\r\n        try {\r\n            await this.hass.callService('jellyha', 'play_on_chromecast', {\r\n                entity_id: this._defaultCastDevice,\r\n                item_id: this._nextUpItem.id,\r\n            });\r\n            this.closeDialog();\r\n        } catch (err) {\r\n            console.error('Failed to cast next up', err);\r\n        }\r\n    }\r\n\r\n    private _handleFavorite = async () => {\r\n        if (!this._item) return;\r\n        this._haptic(); // Feedback\r\n        const newStatus = !this._item.is_favorite;\r\n        this._item = { ...this._item, is_favorite: newStatus };\r\n\r\n        await this.hass.callService('jellyha', 'update_favorite', {\r\n            item_id: this._item.id,\r\n            is_favorite: newStatus,\r\n        });\r\n        this.requestUpdate();\r\n    }\r\n\r\n    private _handleWatched = async () => {\r\n        if (!this._item) return;\r\n        this._haptic(); // Feedback\r\n        const newStatus = !this._item.is_played;\r\n        this._item = { ...this._item, is_played: newStatus };\r\n\r\n        await this.hass.callService('jellyha', 'mark_watched', {\r\n            item_id: this._item.id,\r\n            is_played: newStatus,\r\n        });\r\n        this.requestUpdate();\r\n    }\r\n\r\n    private _handleDeleteConfirm = async () => {\r\n        if (!this._item) return;\r\n        this._haptic(); // Feedback\r\n        const itemId = this._item.id;\r\n        this.closeDialog();\r\n\r\n        await this.hass.callService('jellyha', 'delete_item', {\r\n            item_id: itemId,\r\n        });\r\n    }\r\n\r\n    private _handleWatchTrailer = () => {\r\n        this._haptic();\r\n        const item = this._item;\r\n        if (!item?.trailer_url) return;\r\n        const url = item.trailer_url;\r\n\r\n        // Extract YouTube ID if possible\r\n        // Standard formats: youtube.com/watch?v=ID, youtu.be/ID\r\n        let youtubeId = '';\r\n        try {\r\n            const urlObj = new URL(url);\r\n            if (urlObj.hostname.includes('youtube.com')) {\r\n                youtubeId = urlObj.searchParams.get('v') || '';\r\n            } else if (urlObj.hostname.includes('youtu.be')) {\r\n                youtubeId = urlObj.pathname.slice(1);\r\n            }\r\n        } catch (e) {\r\n            // ignore invalid urls for now, will just open as is\r\n        }\r\n\r\n        if (youtubeId) {\r\n            const ua = navigator.userAgent || navigator.vendor || (window as any).opera;\r\n            const isAndroid = /android/i.test(ua);\r\n\r\n            if (isAndroid) {\r\n                window.open(`vnd.youtube:${youtubeId}`, '_blank');\r\n                return;\r\n            }\r\n        }\r\n\r\n        window.open(url, '_blank');\r\n    }\r\n\r\n    private _handleMarkEpisodeWatched = async (episode: MediaItem) => {\r\n        this._haptic();\r\n        const newStatus = !episode.is_played;\r\n\r\n        // Optimistic Update\r\n        this._episodes = this._episodes.map(ep =>\r\n            ep.id === episode.id ? { ...ep, is_played: newStatus, unplayed_count: newStatus ? 0 : 1 } : ep\r\n        );\r\n\r\n        // Dynamic Next Up Highlight Rotation\r\n        if (newStatus && this._nextUpItem && episode.id === this._nextUpItem.id) {\r\n            // Find index of current episode\r\n            const currentIndex = this._episodes.findIndex(ep => ep.id === episode.id);\r\n            if (currentIndex !== -1 && currentIndex < this._episodes.length - 1) {\r\n                // Move Next Up to the immediate next episode\r\n                this._nextUpItem = this._episodes[currentIndex + 1];\r\n            }\r\n        } else if (!newStatus && this._nextUpItem && episode.id !== this._nextUpItem.id) {\r\n            // If marking unwatched, check if this episode is *before* the current next up.\r\n            // If so, it should strictly become the new next up (first unwatched).\r\n            const currentIndex = this._episodes.findIndex(ep => ep.id === episode.id);\r\n            const nextUpIndex = this._episodes.findIndex(ep => ep.id === this._nextUpItem!.id);\r\n\r\n            if (currentIndex !== -1 && nextUpIndex !== -1 && currentIndex < nextUpIndex) {\r\n                this._nextUpItem = this._episodes[currentIndex];\r\n            }\r\n        }\r\n\r\n        this.requestUpdate();\r\n\r\n        await this.hass.callService('jellyha', 'mark_watched', {\r\n            item_id: episode.id,\r\n            is_played: newStatus,\r\n        });\r\n    }\r\n\r\n\r\n    /* Swipe to Close Logic */\r\n    private _getScrollParent(node: HTMLElement | null): HTMLElement | null {\r\n        if (!node) return null;\r\n\r\n        let parent = node;\r\n        while (parent && parent !== this._portalContainer && parent !== document.body) {\r\n            // Optimization: The '.content' element is our main scroll container.\r\n            // Check it explicitly to avoid costly getComputedStyle in loop if possible.\r\n            if (parent.classList?.contains('content')) {\r\n                if (parent.scrollHeight > parent.clientHeight) {\r\n                    return parent;\r\n                }\r\n                // If content fits, it's not scrolling, so we can swipe locally\r\n                return null;\r\n            }\r\n\r\n            // Fallback for nested scrollables (e.g. strict verify)\r\n            // Accessing scrollHeight forces reflow, but unavoidable if we want to know if it scrolls.\r\n            // accessing getComputedStyle forces style recalc. \r\n            // We can skip getComputedStyle if we assume standard block elements aren't scrollable without it?\r\n            // But let's keep it safe but maybe break early?\r\n            const { overflowY } = window.getComputedStyle(parent);\r\n            if ((overflowY === 'auto' || overflowY === 'scroll') && parent.scrollHeight > parent.clientHeight) {\r\n                return parent;\r\n            }\r\n\r\n            parent = parent.parentElement as HTMLElement;\r\n        }\r\n        return null;\r\n    }\r\n\r\n    private _handleModalTouchStart = (e: TouchEvent): void => {\r\n        const target = e.target as HTMLElement;\r\n        const scrollParent = this._getScrollParent(target);\r\n\r\n        // If we found a scrollable parent and it is scrolled down, disable swipe to close\r\n        if (scrollParent && scrollParent.scrollTop > 0) {\r\n            return;\r\n        }\r\n\r\n        this._touchStartY = e.touches[0].clientY;\r\n        this._isDragging = true;\r\n    }\r\n\r\n    private _handleModalTouchMove = (e: TouchEvent): void => {\r\n        if (!this._isDragging) return;\r\n\r\n        const deltaY = e.touches[0].clientY - this._touchStartY;\r\n\r\n        // Only allow pulling down (positive delta)\r\n        // If driving up (negative delta), we let native scroll handle it\r\n        if (deltaY > 0) {\r\n            // We are pulling down from top\r\n            if (e.cancelable) e.preventDefault();\r\n            this._currentTranslateY = deltaY;\r\n        } else {\r\n            // User is scrolling down (moving finger up), we let native scroll handle it\r\n            this._isDragging = false; // Stop tracking as a drag close\r\n        }\r\n    }\r\n\r\n    private _handleModalTouchEnd = (e: TouchEvent): void => {\r\n        if (!this._isDragging) return;\r\n        this._isDragging = false;\r\n\r\n        if (this._currentTranslateY > this._swipeClosingThreshold) {\r\n            // Close\r\n            this.closeDialog();\r\n            // Reset after a moment to keep UI clean ensuring dialog is gone\r\n            setTimeout(() => {\r\n                this._currentTranslateY = 0;\r\n            }, 300);\r\n        } else {\r\n            // Reset (snap back)\r\n            this._currentTranslateY = 0;\r\n        }\r\n    }\r\n}\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        'jellyha-item-details-modal': JellyHAItemDetailsModal;\r\n    }\r\n}\r\n","/**\r\n * Graphical editor for JellyHA Library Card\r\n */\r\n\r\nimport { LitElement, html, TemplateResult, css } from 'lit';\r\nimport { customElement, property, state } from 'lit/decorators.js';\r\nimport { JellyHALibraryCardConfig, HomeAssistant } from '../shared/types';\r\nimport { localize } from '../shared/localize';\r\n\r\n// Helper function to fire events\r\nfunction fireEvent(\r\n  node: EventTarget,\r\n  type: string,\r\n  detail?: Record<string, unknown>\r\n): void {\r\n  const event = new CustomEvent(type, {\r\n    bubbles: true,\r\n    composed: true,\r\n    detail,\r\n  });\r\n  node.dispatchEvent(event);\r\n}\r\n\r\n@customElement('jellyha-library-editor')\r\nexport class JellyHALibraryEditor extends LitElement {\r\n  @property({ attribute: false }) hass!: HomeAssistant;\r\n  @state() private _config!: JellyHALibraryCardConfig;\r\n\r\n  static styles = css`\r\n    .form-row {\r\n      margin-bottom: 16px;\r\n    }\r\n    .form-row ha-textfield,\r\n    .form-row ha-select,\r\n    .form-row ha-entity-picker,\r\n    .form-row ha-selector {\r\n      width: 100%;\r\n    }\r\n    .checkbox-row {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 8px;\r\n      margin-bottom: 8px;\r\n    }\r\n    .side-by-side {\r\n      display: grid;\r\n      grid-template-columns: 1fr 1fr;\r\n      gap: 16px;\r\n      margin-bottom: 16px;\r\n    }\r\n    .side-by-side > .form-row {\r\n      margin-bottom: 0;\r\n    }\r\n  `;\r\n\r\n  public setConfig(config: JellyHALibraryCardConfig): void {\r\n    this._config = config;\r\n  }\r\n\r\n  protected render(): TemplateResult {\r\n    if (!this.hass || !this._config) {\r\n      return html``;\r\n    }\r\n\r\n    const clickAction = this._config.click_action || 'more-info';\r\n    const holdAction = this._config.hold_action || 'jellyfin';\r\n    const doubleTapAction = this._config.double_tap_action || 'none';\r\n\r\n    const lang = this.hass.locale?.language || this.hass.language;\r\n\r\n    // Determine label for columns/rows slider\r\n    const isHorizontalGrid = this._config.layout === 'grid' &&\r\n      this._config.enable_pagination === false &&\r\n      (this._config.auto_swipe_interval || 0) > 0;\r\n    const columnsLabel = isHorizontalGrid ? localize(lang, 'editor.rows') : localize(lang, 'editor.columns');\r\n\r\n    return html`\r\n      <div class=\"card-config\">\r\n        <div class=\"form-row\">\r\n          <ha-selector\r\n            .hass=${this.hass}\r\n            .selector=${{ entity: { domain: 'sensor' } }}\r\n            .value=${this._config.entity}\r\n            label=\"${localize(lang, 'editor.entity')}\"\r\n            @value-changed=${this._entityChanged}\r\n          ></ha-selector>\r\n        </div>\r\n\r\n        <div class=\"form-row\">\r\n          <ha-textfield\r\n            label=\"${localize(lang, 'editor.title')}\"\r\n            .value=${this._config.title || ''}\r\n            @input=${this._titleChanged}\r\n          ></ha-textfield>\r\n        </div>\r\n\r\n        <div class=\"side-by-side\">\r\n          <div class=\"form-row\">\r\n            <ha-select\r\n              label=\"${localize(lang, 'editor.layout')}\"\r\n              .value=${this._config.layout || 'carousel'}\r\n              @selected=${this._layoutChanged}\r\n              @closed=${(e: Event) => e.stopPropagation()}\r\n            >\r\n              <mwc-list-item value=\"carousel\">${localize(lang, 'editor.layout_carousel')}</mwc-list-item>\r\n              <mwc-list-item value=\"grid\">${localize(lang, 'editor.layout_grid')}</mwc-list-item>\r\n              <mwc-list-item value=\"list\">${localize(lang, 'editor.layout_list')}</mwc-list-item>\r\n            </ha-select>\r\n          </div>\r\n\r\n          <div class=\"form-row\">\r\n            <ha-select\r\n              label=\"${localize(lang, 'editor.media_type')}\"\r\n              .value=${this._config.media_type || 'both'}\r\n              @selected=${this._mediaTypeChanged}\r\n              @closed=${(e: Event) => e.stopPropagation()}\r\n            >\r\n              <mwc-list-item value=\"both\">${localize(lang, 'editor.media_type_both')}</mwc-list-item>\r\n              <mwc-list-item value=\"movies\">${localize(lang, 'editor.media_type_movies')}</mwc-list-item>\r\n              <mwc-list-item value=\"series\">${localize(lang, 'editor.media_type_series')}</mwc-list-item>\r\n              <mwc-list-item value=\"next_up\">${localize(lang, 'editor.media_type_next_up')}</mwc-list-item>\r\n            </ha-select>\r\n          </div>\r\n        </div>\r\n\r\n        ${this._config.layout === 'grid' || this._config.layout === 'list'\r\n        ? html`\r\n              <div class=\"form-row\">\r\n                <ha-slider\r\n                  labeled\r\n                  min=\"1\"\r\n                  max=\"${this._config.layout === 'list' ? 8 : 12}\"\r\n                  .value=${this._config.columns || 1}\r\n                  @change=${this._columnsChanged}\r\n                ></ha-slider>\r\n                <span>${columnsLabel}: ${(this._config.columns || 1) === 1 ? localize(lang, 'editor.auto') : this._config.columns}</span>\r\n              </div>\r\n            `\r\n        : ''}\r\n\r\n        <div class=\"side-by-side\">\r\n          <div class=\"form-row\">\r\n            <ha-textfield\r\n              label=\"${localize(lang, 'editor.items_per_page')}\"\r\n              type=\"number\"\r\n              min=\"1\"\r\n              required\r\n              .value=${this._config.items_per_page !== undefined && this._config.items_per_page !== null ? String(this._config.items_per_page) : ''}\r\n              @input=${this._itemsPerPageChanged}\r\n            ></ha-textfield>\r\n          </div>\r\n\r\n          <div class=\"form-row\">\r\n            <ha-textfield\r\n              label=\"${localize(lang, 'editor.max_pages')}\"\r\n              type=\"number\"\r\n              min=\"0\"\r\n              max=\"20\"\r\n              .value=${this._config.max_pages !== undefined && this._config.max_pages !== null ? String(this._config.max_pages) : ''}\r\n              @input=${this._maxPagesChanged}\r\n            ></ha-textfield>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"side-by-side\">\r\n          <div class=\"form-row\">\r\n            <ha-textfield\r\n              label=\"${localize(lang, 'editor.auto_swipe')}\"\r\n              type=\"number\"\r\n              min=\"0\"\r\n              max=\"60\"\r\n              .value=${String(this._config.auto_swipe_interval || 0)}\r\n              @input=${this._autoSwipeIntervalChanged}\r\n            ></ha-textfield>\r\n          </div>\r\n\r\n          <div class=\"form-row\">\r\n            <ha-textfield\r\n              label=\"${localize(lang, 'editor.new_badge_days')}\"\r\n              type=\"number\"\r\n              min=\"0\"\r\n              max=\"30\"\r\n              .value=${this._config.new_badge_days !== undefined && this._config.new_badge_days !== null ? String(this._config.new_badge_days) : ''}\r\n              @input=${this._newBadgeDaysChanged}\r\n            ></ha-textfield>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"side-by-side\">\r\n          <div class=\"form-row\">\r\n            <ha-select\r\n              label=\"${localize(lang, 'editor.click_action')}\"\r\n              .value=${clickAction}\r\n              @selected=${this._clickActionChanged}\r\n              @closed=${(e: Event) => e.stopPropagation()}\r\n            >\r\n              <mwc-list-item value=\"jellyfin\">${localize(lang, 'editor.action_jellyfin')}</mwc-list-item>\r\n              <mwc-list-item value=\"cast\">${localize(lang, 'editor.action_cast')}</mwc-list-item>\r\n              <mwc-list-item value=\"more-info\">${localize(lang, 'editor.action_more_info')}</mwc-list-item>\r\n              <mwc-list-item value=\"trailer\">${localize(lang, 'editor.action_trailer')}</mwc-list-item>\r\n              <mwc-list-item value=\"none\">${localize(lang, 'editor.action_none')}</mwc-list-item>\r\n            </ha-select>\r\n          </div>\r\n\r\n          <div class=\"form-row\">\r\n            <ha-select\r\n              label=\"${localize(lang, 'editor.hold_action')}\"\r\n              .value=${holdAction}\r\n              @selected=${this._holdActionChanged}\r\n              @closed=${(e: Event) => e.stopPropagation()}\r\n            >\r\n              <mwc-list-item value=\"jellyfin\">${localize(lang, 'editor.action_jellyfin')}</mwc-list-item>\r\n              <mwc-list-item value=\"cast\">${localize(lang, 'editor.action_cast')}</mwc-list-item>\r\n              <mwc-list-item value=\"more-info\">${localize(lang, 'editor.action_more_info')}</mwc-list-item>\r\n              <mwc-list-item value=\"trailer\">${localize(lang, 'editor.action_trailer')}</mwc-list-item>\r\n              <mwc-list-item value=\"none\">${localize(lang, 'editor.action_none')}</mwc-list-item>\r\n            </ha-select>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"side-by-side\">\r\n          <div class=\"form-row\">\r\n            <ha-select\r\n              label=\"${localize(lang, 'editor.double_tap_action')}\"\r\n              .value=${doubleTapAction}\r\n              @selected=${this._doubleTapActionChanged}\r\n              @closed=${(e: Event) => e.stopPropagation()}\r\n            >\r\n              <mwc-list-item value=\"jellyfin\">${localize(lang, 'editor.action_jellyfin')}</mwc-list-item>\r\n              <mwc-list-item value=\"cast\">${localize(lang, 'editor.action_cast')}</mwc-list-item>\r\n              <mwc-list-item value=\"more-info\">${localize(lang, 'editor.action_more_info')}</mwc-list-item>\r\n              <mwc-list-item value=\"trailer\">${localize(lang, 'editor.action_trailer')}</mwc-list-item>\r\n              <mwc-list-item value=\"none\">${localize(lang, 'editor.action_none')}</mwc-list-item>\r\n            </ha-select>\r\n          </div>\r\n\r\n          ${clickAction === 'cast' || holdAction === 'cast' || doubleTapAction === 'cast'\r\n        ? html`\r\n                <div class=\"form-row\">\r\n                  <ha-entity-picker\r\n                    .hass=${this.hass}\r\n                    .value=${this._config.default_cast_device}\r\n                    .includeDomains=${['media_player']}\r\n                    @value-changed=${this._defaultCastDeviceChanged}\r\n                  ></ha-entity-picker>\r\n                </div>\r\n              `\r\n        : html`<div></div>`}\r\n        </div>\r\n\r\n        ${clickAction === 'cast' || holdAction === 'cast' || doubleTapAction === 'cast'\r\n        ? html`\r\n              <div class=\"checkbox-row\">\r\n                <ha-switch\r\n                  .checked=${this._config.show_now_playing !== false}\r\n                  @change=${this._showNowPlayingChanged}\r\n                ></ha-switch>\r\n                <span>${localize(lang, 'editor.show_now_playing_overlay')}</span>\r\n              </div>\r\n            `\r\n        : ''}\r\n\r\n    <div class=\"checkbox-row\">\r\n      <ha-switch\r\n        .checked=${this._config.show_title !== false}\r\n        @change=${this._showTitleChanged}\r\n      ></ha-switch>\r\n      <span>${localize(lang, 'editor.show_title')}</span>\r\n    </div>\r\n\r\n    <div class=\"checkbox-row\">\r\n      <ha-switch\r\n        .checked=${this._config.show_year !== false}\r\n        @change=${this._showYearChanged}\r\n      ></ha-switch>\r\n      <span>${localize(lang, 'editor.show_year')}</span>\r\n    </div>\r\n\r\n    <div class=\"checkbox-row\">\r\n      <ha-switch\r\n        .checked=${this._config.show_ratings !== false}\r\n        @change=${this._showRatingsChanged}\r\n      ></ha-switch>\r\n      <span>${localize(lang, 'editor.show_rating')}</span>\r\n    </div>\r\n\r\n    <div class=\"checkbox-row\">\r\n      <ha-switch\r\n        .checked=${this._config.show_runtime === true}\r\n        @change=${this._showRuntimeChanged}\r\n      ></ha-switch>\r\n      <span>${localize(lang, 'editor.show_runtime')}</span>\r\n    </div>\r\n\r\n    <div class=\"checkbox-row\">\r\n      <ha-switch\r\n        .checked=${this._config.show_date_added === true}\r\n        @change=${this._showDateAddedChanged}\r\n      ></ha-switch>\r\n      <span>${localize(lang, 'editor.show_date_added')}</span>\r\n    </div>\r\n\r\n    <div class=\"checkbox-row\">\r\n      <ha-switch\r\n        .checked=${this._config.show_genres === true}\r\n        @change=${this._showGenresChanged}\r\n      ></ha-switch>\r\n      <span>${localize(lang, 'editor.show_genres')}</span>\r\n    </div>\r\n\r\n    <div class=\"checkbox-row\">\r\n      <ha-switch\r\n        .checked=${this._config.show_description_on_hover !== false}\r\n        @change=${this._showDescriptionOnHoverChanged}\r\n      ></ha-switch>\r\n      <span>${localize(lang, 'editor.show_description')}</span>\r\n    </div>\r\n\r\n    <div class=\"checkbox-row\">\r\n      <ha-switch\r\n        .checked=${this._config.show_media_type_badge !== false}\r\n        @change=${this._showMediaTypeBadgeChanged}\r\n      ></ha-switch>\r\n      <span>${localize(lang, 'editor.show_media_type_badge')}</span>\r\n    </div>\r\n\r\n    <div class=\"checkbox-row\">\r\n      <ha-switch\r\n        .checked=${this._config.show_watched_status !== false}\r\n        @change=${this._showWatchedStatusChanged}\r\n      ></ha-switch>\r\n      <span>${localize(lang, 'editor.show_watched_status')}</span>\r\n    </div>\r\n\r\n    <div class=\"checkbox-row\">\r\n      <ha-switch\r\n        .checked=${this._config.show_search === true}\r\n        @change=${this._showSearchChanged}\r\n      ></ha-switch>\r\n      <span>${localize(lang, 'editor.show_search')}</span>\r\n    </div>\r\n\r\n    <div class=\"side-by-side\">\r\n      <div class=\"form-row\">\r\n        <ha-select\r\n          label=\"${localize(lang, 'editor.metadata_position')}\"\r\n          .value=${this._config.metadata_position || 'below'}\r\n          @selected=${this._metadataPositionChanged}\r\n          @closed=${(e: Event) => e.stopPropagation()}\r\n        >\r\n          <mwc-list-item value=\"below\">${localize(lang, 'editor.metadata_below')}</mwc-list-item>\r\n          <mwc-list-item value=\"above\">${localize(lang, 'editor.metadata_above')}</mwc-list-item>\r\n        </ha-select>\r\n      </div>\r\n\r\n      <div class=\"form-row\">\r\n        ${this._config.media_type !== 'next_up'\r\n        ? html`\r\n            <ha-select\r\n            label=\"${localize(lang, 'editor.sort_order')}\"\r\n            .value=${this._config.sort_option || 'date_added_desc'}\r\n            @selected=${this._sortOptionChanged}\r\n            @closed=${(e: Event) => e.stopPropagation()}\r\n            >\r\n            <mwc-list-item value=\"date_added_desc\">${localize(lang, 'editor.sort_date_added_desc')}</mwc-list-item>\r\n            <mwc-list-item value=\"date_added_asc\">${localize(lang, 'editor.sort_date_added_asc')}</mwc-list-item>\r\n            <mwc-list-item value=\"title_asc\">${localize(lang, 'editor.sort_title_asc')}</mwc-list-item>\r\n            <mwc-list-item value=\"title_desc\">${localize(lang, 'editor.sort_title_desc')}</mwc-list-item>\r\n            <mwc-list-item value=\"year_desc\">${localize(lang, 'editor.sort_year_desc')}</mwc-list-item>\r\n            <mwc-list-item value=\"year_asc\">${localize(lang, 'editor.sort_year_asc')}</mwc-list-item>\r\n            <mwc-list-item value=\"last_played_desc\">${localize(lang, 'editor.sort_last_played_desc')}</mwc-list-item>\r\n            <mwc-list-item value=\"last_played_asc\">${localize(lang, 'editor.sort_last_played_asc')}</mwc-list-item>\r\n            </ha-select>\r\n        `\r\n        : html`<div></div>`}\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"side-by-side\">\r\n      <div class=\"checkbox-row\">\r\n        <ha-switch\r\n          .checked=${this._config.enable_pagination !== false}\r\n          @change=${this._enablePaginationChanged}\r\n        ></ha-switch>\r\n        <span>${localize(lang, 'editor.enable_pagination')}</span>\r\n      </div>\r\n\r\n      <div class=\"checkbox-row\">\r\n        <ha-switch\r\n          .checked=${this._config.show_pagination_dots !== false}\r\n          @change=${this._showPaginationDotsChanged}\r\n        ></ha-switch>\r\n        <span>${localize(lang, 'editor.show_pagination_dots')}</span>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"form-row\">\r\n      <ha-select\r\n        label=\"${localize(lang, 'editor.filter_watch_status')}\"\r\n        .value=${this._config.status_filter || 'all'}\r\n        @selected=${this._statusFilterChanged}\r\n        @closed=${(e: Event) => e.stopPropagation()}\r\n      >\r\n        <mwc-list-item value=\"all\">${localize(lang, 'editor.filter_all')}</mwc-list-item>\r\n        <mwc-list-item value=\"unwatched\">${localize(lang, 'editor.filter_unwatched')}</mwc-list-item>\r\n        <mwc-list-item value=\"watched\">${localize(lang, 'editor.filter_watched')}</mwc-list-item>\r\n      </ha-select>\r\n    </div>\r\n\r\n    <div class=\"side-by-side\">\r\n      <div class=\"checkbox-row\">\r\n        <ha-switch\r\n          .checked=${this._config.filter_favorites === true}\r\n          @change=${this._filterFavoritesChanged}\r\n        ></ha-switch>\r\n        <span>${localize(lang, 'editor.filter_favorites')}</span>\r\n      </div>\r\n\r\n      <div class=\"checkbox-row\">\r\n        <ha-switch\r\n          .checked=${this._config.filter_newly_added === true}\r\n          @change=${this._filterNewlyAddedChanged}\r\n        ></ha-switch>\r\n        <span>${localize(lang, 'editor.filter_new_items')}</span>\r\n      </div>\r\n    </div>\r\n\r\n\r\n  </div>\r\n`;\r\n  }\r\n\r\n  private _entityChanged(e: CustomEvent): void {\r\n    this._updateConfig('entity', e.detail.value);\r\n  }\r\n\r\n  private _titleChanged(e: Event): void {\r\n    const target = e.target as HTMLInputElement;\r\n    this._updateConfig('title', target.value);\r\n  }\r\n\r\n  private _layoutChanged(e: Event): void {\r\n    const target = e.target as HTMLSelectElement;\r\n    this._updateConfig('layout', target.value);\r\n  }\r\n\r\n  private _columnsChanged(e: Event): void {\r\n    const target = e.target as HTMLInputElement;\r\n    this._updateConfig('columns', Number(target.value));\r\n  }\r\n\r\n  private _mediaTypeChanged(e: Event): void {\r\n    const target = e.target as HTMLSelectElement;\r\n    this._updateConfig('media_type', target.value);\r\n  }\r\n\r\n  private _itemsPerPageChanged(e: Event): void {\r\n    const target = e.target as HTMLInputElement;\r\n    const value = target.value.trim();\r\n    if (value !== '') {\r\n      this._updateConfig('items_per_page', Number(value));\r\n    } else {\r\n      // Allow clearing (will use default later or in card)\r\n      this._updateConfig('items_per_page', null);\r\n    }\r\n  }\r\n\r\n  private _maxPagesChanged(e: Event): void {\r\n    const target = e.target as HTMLInputElement;\r\n    const value = target.value;\r\n    if (value === '' || value === null) {\r\n      this._updateConfig('max_pages', null);\r\n    } else {\r\n      this._updateConfig('max_pages', Number(value));\r\n    }\r\n  }\r\n\r\n  private _autoSwipeIntervalChanged(e: Event): void {\r\n    const target = e.target as HTMLInputElement;\r\n    this._updateConfig('auto_swipe_interval', Number(target.value));\r\n  }\r\n\r\n  private _newBadgeDaysChanged(e: Event): void {\r\n    const target = e.target as HTMLInputElement;\r\n    const value = target.value;\r\n    if (value === '' || value === null) {\r\n      this._updateConfig('new_badge_days', null);\r\n    } else {\r\n      this._updateConfig('new_badge_days', Number(value));\r\n    }\r\n  }\r\n\r\n  private _clickActionChanged(e: Event): void {\r\n    const target = e.target as HTMLSelectElement;\r\n    this._updateConfig('click_action', target.value);\r\n  }\r\n\r\n  private _holdActionChanged(e: Event): void {\r\n    const target = e.target as HTMLSelectElement;\r\n    this._updateConfig('hold_action', target.value);\r\n  }\r\n\r\n  private _doubleTapActionChanged(e: Event): void {\r\n    const target = e.target as HTMLSelectElement;\r\n    this._updateConfig('double_tap_action', target.value);\r\n  }\r\n\r\n  private _defaultCastDeviceChanged(e: CustomEvent): void {\r\n    this._updateConfig('default_cast_device', e.detail.value);\r\n  }\r\n\r\n  private _showNowPlayingChanged(e: Event): void {\r\n    const target = e.target as HTMLInputElement;\r\n    this._updateConfig('show_now_playing', target.checked);\r\n  }\r\n\r\n  private _showTitleChanged(e: Event): void {\r\n    const target = e.target as HTMLInputElement;\r\n    this._updateConfig('show_title', target.checked);\r\n  }\r\n\r\n  private _showYearChanged(e: Event): void {\r\n    const target = e.target as HTMLInputElement;\r\n    this._updateConfig('show_year', target.checked);\r\n  }\r\n\r\n  private _showRatingsChanged(e: Event): void {\r\n    const target = e.target as HTMLInputElement;\r\n    this._updateConfig('show_ratings', target.checked);\r\n  }\r\n\r\n  private _showRuntimeChanged(e: Event): void {\r\n    const target = e.target as HTMLInputElement;\r\n    this._updateConfig('show_runtime', target.checked);\r\n  }\r\n\r\n  private _showMediaTypeBadgeChanged(e: Event): void {\r\n    const target = e.target as HTMLInputElement;\r\n    this._updateConfig('show_media_type_badge', target.checked);\r\n  }\r\n\r\n  private _showWatchedStatusChanged(e: Event): void {\r\n    const target = e.target as HTMLInputElement;\r\n    this._updateConfig('show_watched_status', target.checked);\r\n  }\r\n\r\n  private _showGenresChanged(e: Event): void {\r\n    const target = e.target as HTMLInputElement;\r\n    this._updateConfig('show_genres', target.checked);\r\n  }\r\n\r\n  private _showDateAddedChanged(e: Event): void {\r\n    const target = e.target as HTMLInputElement;\r\n    this._updateConfig('show_date_added', target.checked);\r\n  }\r\n\r\n  private _showDescriptionOnHoverChanged(e: Event): void {\r\n    const target = e.target as HTMLInputElement;\r\n    this._updateConfig('show_description_on_hover', target.checked);\r\n  }\r\n\r\n  private _metadataPositionChanged(e: Event): void {\r\n    const target = e.target as HTMLSelectElement;\r\n    this._updateConfig('metadata_position', target.value);\r\n  }\r\n\r\n  private _horizontalAlignmentChanged(e: Event): void {\r\n    const target = e.target as HTMLSelectElement;\r\n    this._updateConfig('horizontal_alignment', target.value);\r\n  }\r\n\r\n  private _enablePaginationChanged(e: Event): void {\r\n    const target = e.target as HTMLInputElement;\r\n    this._updateConfig('enable_pagination', target.checked);\r\n  }\r\n\r\n  private _showPaginationDotsChanged(e: Event): void {\r\n    const target = e.target as HTMLInputElement;\r\n    this._updateConfig('show_pagination_dots', target.checked);\r\n  }\r\n\r\n  private _filterFavoritesChanged(e: Event): void {\r\n    const target = e.target as HTMLInputElement;\r\n    this._updateConfig('filter_favorites', target.checked);\r\n  }\r\n\r\n  private _statusFilterChanged(e: Event): void {\r\n    const target = e.target as HTMLSelectElement;\r\n    this._updateConfig('status_filter', target.value);\r\n  }\r\n\r\n  private _filterNewlyAddedChanged(e: Event): void {\r\n    const target = e.target as HTMLInputElement;\r\n    this._updateConfig('filter_newly_added', target.checked);\r\n  }\r\n\r\n  private _showSearchChanged(e: Event): void {\r\n    const target = e.target as HTMLInputElement;\r\n    this._updateConfig('show_search', target.checked);\r\n  }\r\n\r\n  private _sortOptionChanged(e: Event): void {\r\n    const target = e.target as HTMLSelectElement;\r\n    this._updateConfig('sort_option', target.value);\r\n  }\r\n\r\n  private _updateConfig(key: string, value: unknown): void {\r\n    if (!this._config) {\r\n      return;\r\n    }\r\n\r\n    const newConfig = { ...this._config, [key]: value };\r\n    this._config = newConfig;\r\n\r\n    fireEvent(this as unknown as EventTarget, 'config-changed', { config: newConfig });\r\n  }\r\n}\r\n\r\ndeclare global {\r\n  interface HTMLElementTagNameMap {\r\n    'jellyha-library-editor': JellyHALibraryEditor;\r\n  }\r\n}\r\n\r\n","import { LitElement, html, nothing, TemplateResult } from 'lit';\r\nimport { customElement, property, state } from 'lit/decorators.js';\r\nimport { HomeAssistant, MediaItem, JellyHALibraryCardConfig } from '../shared/types';\r\nimport { isNewItem, formatDate, formatRuntime, addImageParams } from '../shared/utils';\r\nimport { localize } from '../shared/localize';\r\nimport { cardStyles } from '../styles/jellyha-library-styles';\r\n\r\n@customElement('jellyha-media-item')\r\nexport class JellyHAMediaItem extends LitElement {\r\n  @property({ attribute: false }) hass!: HomeAssistant;\r\n  @property({ attribute: false }) config!: JellyHALibraryCardConfig;\r\n  @property({ attribute: false }) item!: MediaItem;\r\n  @property({ type: String }) layout: 'grid' | 'list' = 'grid';\r\n  @property({ type: Boolean }) isNextUpHighlight = false;\r\n\r\n  @state() private _pressStartTime: number = 0;\r\n  @state() private _holdTimer?: number;\r\n  @state() private _isHoldActive: boolean = false;\r\n  @state() private _itemTouchStartX: number = 0;\r\n  @state() private _itemTouchStartY: number = 0;\r\n  @state() private _clickTimer?: number;\r\n\r\n  // Local state for rewind animation\r\n  @state() private _rewindActive: boolean = false;\r\n\r\n  static styles = cardStyles;\r\n\r\n  protected render(): TemplateResult {\r\n    if (!this.item || !this.config || !this.hass) return html``;\r\n\r\n    if (this.layout === 'list') {\r\n      return this._renderListItem();\r\n    }\r\n    return this._renderMediaItem();\r\n  }\r\n\r\n  private _renderListItem(): TemplateResult {\r\n    const item = this.item;\r\n    const isNew = isNewItem(item, this.config.new_badge_days || 0);\r\n    const rating = this._getRating(item);\r\n    const showMediaTypeBadge = this.config.show_media_type_badge !== false;\r\n    const isPlaying = this._isItemPlaying(item);\r\n\r\n    return html`\r\n      <div\r\n        class=\"media-item list-item ${isPlaying ? 'playing' : ''} ${!this.config.show_title ? 'no-title' : ''} ${this.config.metadata_position === 'above' ? 'metadata-above' : ''}\"\r\n        tabindex=\"0\"\r\n        role=\"button\"\r\n        aria-label=\"${item.name}\"\r\n        @mousedown=\"${this._handleMouseDown}\"\r\n        @mouseup=\"${this._handleMouseUp}\"\r\n        @touchstart=\"${this._handleTouchStart}\"\r\n        @touchmove=\"${this._handleTouchMove}\"\r\n        @touchend=\"${this._handleTouchEnd}\"\r\n        @touchcancel=\"${this._handleTouchEnd}\"\r\n        @keydown=\"${this._handleKeydown}\"\r\n        @contextmenu=\"${this._handleContextMenu}\"\r\n      >\r\n        <div class=\"list-poster-wrapper\">\r\n          ${this.config.metadata_position === 'above' && this.config.show_date_added && item.date_added\r\n        ? html`<p class=\"list-date-added\">${formatDate(item.date_added, this.hass?.locale?.language || this.hass?.language)}</p>`\r\n        : nothing}\r\n          <div class=\"poster-container\" id=\"poster-${item.id}\">\r\n            <div class=\"poster-inner\">\r\n              <img\r\n                class=\"poster\"\r\n                src=\"${addImageParams(item.poster_url, 160)}\"\r\n                alt=\"${item.name}\"\r\n                width=\"80\"\r\n                height=\"120\"\r\n                loading=\"lazy\"\r\n                decoding=\"async\"\r\n                @load=\"${this._handleImageLoad}\"\r\n                @error=\"${this._handleImageError}\"\r\n              />\r\n              <div class=\"poster-skeleton\"></div>\r\n              \r\n              ${showMediaTypeBadge && !isPlaying && !item.series_name\r\n        ? html`<span class=\"list-type-badge ${item.series_name ? 'series' : (item.type === 'Movie' ? 'movie' : 'series')}\">\r\n                    ${item.series_name && item.season !== undefined && item.episode !== undefined\r\n            ? `S${String(item.season).padStart(2, '0')}E${String(item.episode).padStart(2, '0')}`\r\n            : (item.type === 'Movie' ? 'Movie' : 'Series')}\r\n                  </span>`\r\n        : nothing}\r\n\r\n              ${item.series_name && !isPlaying\r\n        ? html`\r\n            <div class=\"censor-bar list-bar ${this.isNextUpHighlight ? 'highlight' : ''}\">\r\n              <span>${item.series_name}</span>\r\n            </div>\r\n              `\r\n        : nothing}\r\n              \r\n              ${!isPlaying ? this._renderStatusBadge(item, isNew) : nothing}\r\n              ${this._renderNowPlayingOverlay(item)}\r\n            </div>\r\n          </div>\r\n          ${this.config.metadata_position !== 'above' && this.config.show_date_added && item.date_added\r\n        ? html`<p class=\"list-date-added\">${formatDate(item.date_added, this.hass?.locale?.language || this.hass?.language)}</p>`\r\n        : nothing}\r\n        </div>\r\n        \r\n        <div class=\"list-info\">\r\n          ${this.config.show_title\r\n        ? html`<h3 class=\"list-title\">${item.name}</h3>`\r\n        : nothing}\r\n          \r\n          <div class=\"list-metadata\">\r\n            ${showMediaTypeBadge && !isPlaying\r\n        ? html`<span class=\"list-type-badge ${item.series_name ? 'series' : (item.type === 'Movie' ? 'movie' : 'series')}\">\r\n                  ${item.series_name && item.season !== undefined && item.episode !== undefined\r\n            ? `S${String(item.season).padStart(2, '0')}E${String(item.episode).padStart(2, '0')}`\r\n            : (item.type === 'Movie' ? 'Movie' : 'Series')}\r\n                </span>`\r\n        : nothing}\r\n            ${this.config.show_year && item.year\r\n        ? html`<span class=\"list-year\">${item.year}</span>`\r\n        : nothing}\r\n            ${this.config.show_ratings && rating\r\n        ? html`<span class=\"list-rating\">\r\n                  <ha-icon icon=\"mdi:star\"></ha-icon>\r\n                  ${rating.toFixed(1)}\r\n                </span>`\r\n        : nothing}\r\n            ${this.config.show_runtime && item.runtime_minutes\r\n        ? html`<span class=\"list-runtime\">\r\n                  <ha-icon icon=\"mdi:clock-outline\"></ha-icon>\r\n                  ${formatRuntime(item.runtime_minutes)}\r\n                </span>`\r\n        : nothing}\r\n          </div>\r\n          \r\n          ${this.config.show_genres && item.genres && item.genres.length > 0\r\n        ? html`<p class=\"list-genres\">${item.genres.slice(0, 3).join(', ')}</p>`\r\n        : nothing}\r\n          \r\n          ${this.config.show_description_on_hover !== false && item.description\r\n        ? html`<p class=\"list-description\">${item.description}</p>`\r\n        : nothing}\r\n        </div>\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  private _renderMediaItem(): TemplateResult {\r\n    const item = this.item;\r\n    const isNew = isNewItem(item, this.config.new_badge_days || 0);\r\n    const rating = this._getRating(item);\r\n    const showMediaTypeBadge = this.config.show_media_type_badge !== false;\r\n    const isPlaying = this._isItemPlaying(item);\r\n\r\n    return html`\r\n      <div\r\n        class=\"media-item ${isPlaying ? 'playing' : ''}\"\r\n        tabindex=\"0\"\r\n        role=\"button\"\r\n        aria-label=\"${item.name}\"\r\n        @mousedown=\"${this._handleMouseDown}\"\r\n        @mouseup=\"${this._handleMouseUp}\"\r\n        @touchstart=\"${this._handleTouchStart}\"\r\n        @touchmove=\"${this._handleTouchMove}\"\r\n        @touchend=\"${this._handleTouchEnd}\"\r\n        @touchcancel=\"${this._handleTouchEnd}\"\r\n        @keydown=\"${this._handleKeydown}\"\r\n        @contextmenu=\"${this._handleContextMenu}\"\r\n      >\r\n        ${this.config.metadata_position === 'above'\r\n        ? html`\r\n              <div class=\"media-info-above\">\r\n                ${this.config.show_title\r\n            ? html`<p class=\"media-title\">${item.name}</p>`\r\n            : nothing}\r\n                ${this.config.show_year && item.year\r\n            ? html`<p class=\"media-year\">${item.year}</p>`\r\n            : nothing}\r\n                ${this.config.show_date_added && item.date_added\r\n            ? html`<p class=\"media-date-added\">${formatDate(item.date_added, this.hass?.locale?.language || this.hass?.language)}</p>`\r\n            : nothing}\r\n              </div>\r\n            `\r\n        : nothing}\r\n        <div class=\"poster-container\" id=\"poster-${item.id}\">\r\n          <div class=\"poster-inner\">\r\n            <img\r\n              class=\"poster\"\r\n              src=\"${addImageParams(item.poster_url, 300)}\"\r\n              alt=\"${item.name}\"\r\n              width=\"140\"\r\n              height=\"210\"\r\n              loading=\"lazy\"\r\n              decoding=\"async\"\r\n              @load=\"${this._handleImageLoad}\"\r\n              @error=\"${this._handleImageError}\"\r\n            />\r\n            <div class=\"poster-skeleton\"></div>\r\n            \r\n            ${showMediaTypeBadge && !isPlaying\r\n        ? html`\r\n            <span class=\"media-type-badge ${item.series_name ? 'series' : (item.type === 'Movie' ? 'movie' : 'series')}\">\r\n              ${item.series_name && item.season !== undefined && item.episode !== undefined\r\n            ? `S${String(item.season).padStart(2, '0')}E${String(item.episode).padStart(2, '0')}`\r\n            : (item.type === 'Movie' ? 'Movie' : 'Series')}\r\n            </span>\r\n          `\r\n        : nothing}\r\n\r\n            ${item.series_name && !isPlaying\r\n        ? html`\r\n            <div class=\"censor-bar ${this.isNextUpHighlight ? 'highlight' : ''}\">\r\n              <span>${item.series_name}</span>\r\n            </div>\r\n              `\r\n        : nothing}\r\n            \r\n            ${!isPlaying ? this._renderStatusBadge(item, isNew) : nothing}\r\n            \r\n            ${this.config.show_ratings && rating && !isPlaying\r\n        ? html`\r\n                  <span class=\"rating\">\r\n                    <ha-icon icon=\"mdi:star\"></ha-icon>\r\n                    ${rating.toFixed(1)}\r\n                  </span>\r\n                `\r\n        : nothing}\r\n            \r\n            ${this.config.show_runtime && item.runtime_minutes && !isPlaying\r\n        ? html`\r\n                  <span class=\"runtime\">\r\n                    <ha-icon icon=\"mdi:clock-outline\"></ha-icon>\r\n                    ${formatRuntime(item.runtime_minutes)}\r\n                  </span>\r\n                `\r\n        : nothing}\r\n            \r\n            ${!isPlaying ? html`\r\n            <div class=\"hover-overlay\">\r\n              ${item.year ? html`<span class=\"overlay-year\">${item.year}</span>` : nothing}\r\n              <h3 class=\"overlay-title\">${item.name}</h3>\r\n              ${this.config.show_genres && item.genres && item.genres.length > 0\r\n          ? html`<span class=\"overlay-genres\">${item.genres.slice(0, 3).join(', ')}</span>`\r\n          : nothing}\r\n              ${this.config.show_description_on_hover !== false && item.description\r\n          ? html`<p class=\"overlay-description\">${item.description}</p>`\r\n          : nothing}\r\n            </div>` : nothing}\r\n\r\n            ${this._renderNowPlayingOverlay(item)}\r\n          </div>\r\n        </div>\r\n        \r\n        ${this.config.metadata_position === 'below'\r\n        ? html`\r\n              <div class=\"media-info-below\">\r\n                ${this.config.show_title\r\n            ? html`<p class=\"media-title\">${item.name}</p>`\r\n            : nothing}\r\n                ${this.config.show_year && item.year\r\n            ? html`<p class=\"media-year\">${item.year}</p>`\r\n            : nothing}\r\n                ${this.config.show_date_added && item.date_added\r\n            ? html`<p class=\"media-date-added\">${formatDate(item.date_added, this.hass?.locale?.language || this.hass?.language)}</p>`\r\n            : nothing}\r\n              </div>\r\n            `\r\n        : nothing}\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  private _renderStatusBadge(item: MediaItem, isNew: boolean): TemplateResult {\r\n    const showWatched = this.config.show_watched_status !== false;\r\n\r\n    if (showWatched && item.is_played) {\r\n      return html`\r\n        <div class=\"status-badge watched\">\r\n          <ha-icon icon=\"mdi:check-bold\"></ha-icon>\r\n        </div>\r\n      `;\r\n    }\r\n\r\n    if (showWatched && item.type === 'Series' && (item.unplayed_count || 0) > 0) {\r\n      return html`\r\n        <div class=\"status-badge unplayed\">\r\n          ${item.unplayed_count}\r\n        </div>\r\n      `;\r\n    }\r\n\r\n    if (isNew) {\r\n      return html`<span class=\"new-badge\">${localize(this.hass.locale?.language || this.hass.language, 'new')}</span>`;\r\n    }\r\n\r\n    return html``;\r\n  }\r\n\r\n  private _renderNowPlayingOverlay(item: MediaItem): TemplateResult | typeof nothing {\r\n    if (!this.config.show_now_playing || !this._isItemPlaying(item)) {\r\n      return nothing;\r\n    }\r\n\r\n    const player = this.hass.states[this.config.default_cast_device!];\r\n\r\n    return html`\r\n      <div \r\n        class=\"now-playing-overlay\" \r\n        @click=\"${() => this._handleRewind(this.config.default_cast_device!)}\"\r\n        @mousedown=\"${this._stopPropagation}\"\r\n        @mouseup=\"${this._stopPropagation}\"\r\n        @touchstart=\"${this._stopPropagation}\"\r\n        @touchend=\"${this._stopPropagation}\"\r\n        @touchcancel=\"${this._stopPropagation}\"\r\n        role=\"button\"\r\n        tabindex=\"0\"\r\n      >\r\n        <span class=\"now-playing-status\">\r\n          ${this._rewindActive ? 'REWINDING' : player.state}\r\n        </span>\r\n        <div class=\"now-playing-controls\">\r\n          <ha-icon-button\r\n            class=\"${this._rewindActive ? 'spinning' : ''}\"\r\n            .label=${'Play/Pause'}\r\n            @click=\"${(e: Event) => { e.stopPropagation(); this._handlePlayPause(this.config.default_cast_device!); }}\"\r\n          >\r\n            <ha-icon icon=\"${this._rewindActive ? 'mdi:loading' : (player.state === 'playing' ? 'mdi:pause' : 'mdi:play')}\"></ha-icon>\r\n          </ha-icon-button>\r\n          <ha-icon-button\r\n            class=\"stop\"\r\n            .label=${'Stop'}\r\n            @click=\"${(e: Event) => { e.stopPropagation(); this._handleStop(this.config.default_cast_device!); }}\"\r\n          >\r\n            <ha-icon icon=\"mdi:stop\"></ha-icon>\r\n          </ha-icon-button>\r\n        </div>\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  /* --- Helpers --- */\r\n\r\n  private _isItemPlaying(item: MediaItem): boolean {\r\n    if (!this.config.default_cast_device || !this.hass) return false;\r\n\r\n    const player = this.hass.states[this.config.default_cast_device];\r\n    if (!player || (player.state !== 'playing' && player.state !== 'paused' && player.state !== 'buffering')) {\r\n      return false;\r\n    }\r\n\r\n    const playingTitle = player.attributes.media_title as string;\r\n    const playingSeries = player.attributes.media_series_title as string;\r\n\r\n    return (\r\n      (item.name && (playingTitle === item.name || playingSeries === item.name)) ||\r\n      (item.type === 'Series' && playingSeries === item.name)\r\n    );\r\n  }\r\n\r\n  private _getRating(item: MediaItem): number | null {\r\n    if (this.config.rating_source === 'auto') {\r\n      return item.rating || null;\r\n    }\r\n    return item.rating || null;\r\n  }\r\n\r\n  /* --- Event Handlers --- */\r\n\r\n  private _fireAction(type: 'click' | 'hold' | 'double_tap'): void {\r\n    const event = new CustomEvent('jellyha-action', {\r\n      detail: { type, item: this.item },\r\n      bubbles: true,\r\n      composed: true,\r\n    });\r\n    this.dispatchEvent(event);\r\n  }\r\n\r\n  private _startHoldTimer(): void {\r\n    this._pressStartTime = Date.now();\r\n    this._isHoldActive = false;\r\n    this._holdTimer = window.setTimeout(() => {\r\n      this._isHoldActive = true;\r\n\r\n      // Trigger visual pulse\r\n      const poster = this.shadowRoot?.querySelector(`#poster-${this.item.id}`);\r\n      if (poster) {\r\n        poster.classList.add('hold-pulse');\r\n        // Remove class after animation completes to allow re-triggering\r\n        setTimeout(() => {\r\n          poster.classList.remove('hold-pulse');\r\n        }, 300);\r\n      }\r\n\r\n      this._dispatchHaptic('medium');\r\n      this._fireAction('hold');\r\n    }, 500);\r\n  }\r\n\r\n  private _clearHoldTimer(): void {\r\n    if (this._holdTimer) {\r\n      clearTimeout(this._holdTimer);\r\n      this._holdTimer = undefined;\r\n    }\r\n  }\r\n\r\n  private _handleMouseDown(e: MouseEvent): void {\r\n    if (e.button !== 0) return;\r\n    this._startHoldTimer();\r\n  }\r\n\r\n  private _handleMouseUp(e: MouseEvent): void {\r\n    if (this._isHoldActive) {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    } else {\r\n      const duration = Date.now() - this._pressStartTime;\r\n      if (duration < 500) {\r\n        this._handleTap();\r\n      }\r\n    }\r\n    this._clearHoldTimer();\r\n  }\r\n\r\n  private _handleTap(): void {\r\n    const doubleTapAction = this.config.double_tap_action || 'none';\r\n\r\n    // If no double tap action is configured, trigger click immediately\r\n    if (doubleTapAction === 'none') {\r\n      this._dispatchHaptic('light');\r\n      this._fireAction('click');\r\n      return;\r\n    }\r\n\r\n    if (this._clickTimer) {\r\n      // Double tap detected\r\n      clearTimeout(this._clickTimer);\r\n      this._clickTimer = undefined;\r\n      this._dispatchHaptic('medium');\r\n      this._fireAction('double_tap');\r\n    } else {\r\n      // First tap, start timer\r\n      this._clickTimer = window.setTimeout(() => {\r\n        this._clickTimer = undefined;\r\n        this._dispatchHaptic('light');\r\n        this._fireAction('click');\r\n      }, 250);\r\n    }\r\n  }\r\n\r\n  private _handleContextMenu(e: Event): void {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    return;\r\n  }\r\n\r\n  private _handleTouchStart(e: TouchEvent): void {\r\n    if (e.touches.length > 0) {\r\n      this._itemTouchStartX = e.touches[0].clientX;\r\n      this._itemTouchStartY = e.touches[0].clientY;\r\n\r\n      const target = e.currentTarget as HTMLElement;\r\n      target.classList.add('active-press');\r\n    }\r\n    this._startHoldTimer();\r\n  }\r\n\r\n  private _handleTouchMove(e: TouchEvent): void {\r\n    if (e.touches.length > 0) {\r\n      const diffX = Math.abs(e.touches[0].clientX - this._itemTouchStartX);\r\n      const diffY = Math.abs(e.touches[0].clientY - this._itemTouchStartY);\r\n\r\n      if (diffX > 10 || diffY > 10) {\r\n        this._clearHoldTimer();\r\n        const target = e.currentTarget as HTMLElement;\r\n        target.classList.remove('active-press');\r\n      }\r\n    }\r\n  }\r\n\r\n  private _handleTouchEnd(e: TouchEvent): void {\r\n    const target = e.currentTarget as HTMLElement;\r\n    target.classList.remove('active-press');\r\n\r\n    this._clearHoldTimer();\r\n\r\n    let dist = 0;\r\n    if (e.changedTouches.length > 0) {\r\n      const diffX = e.changedTouches[0].clientX - this._itemTouchStartX;\r\n      const diffY = e.changedTouches[0].clientY - this._itemTouchStartY;\r\n      dist = Math.sqrt(diffX * diffX + diffY * diffY);\r\n    }\r\n\r\n    if (e.cancelable) e.preventDefault();\r\n\r\n    if (this._isHoldActive) {\r\n      this._isHoldActive = false;\r\n      return;\r\n    }\r\n\r\n    if (dist > 10) {\r\n      return;\r\n    }\r\n\r\n    this._handleTap();\r\n  }\r\n\r\n  private _handleKeydown(e: KeyboardEvent): void {\r\n    if (e.key === 'Enter' || e.key === ' ') {\r\n      e.preventDefault();\r\n      this._fireAction('click');\r\n    }\r\n  }\r\n\r\n  private _handleImageLoad(e: Event): void {\r\n    const img = e.target as HTMLImageElement;\r\n    img.classList.add('loaded');\r\n  }\r\n\r\n  private _handleImageError(e: Event): void {\r\n    const img = e.target as HTMLImageElement;\r\n    img.style.display = 'none';\r\n  }\r\n\r\n  /* --- Playback Control Handlers --- */\r\n\r\n  private _stopPropagation(e: Event): void {\r\n    e.stopPropagation();\r\n  }\r\n\r\n  private _handlePlayPause(entityId: string): void {\r\n    this._dispatchHaptic();\r\n    this.hass.callService('media_player', 'media_play_pause', { entity_id: entityId });\r\n  }\r\n\r\n  private _handleStop(entityId: string): void {\r\n    this._dispatchHaptic();\r\n    this.hass.callService('media_player', 'turn_off', { entity_id: entityId });\r\n  }\r\n\r\n  private _handleRewind(entityId: string): void {\r\n    this._rewindActive = true;\r\n    setTimeout(() => {\r\n      this._rewindActive = false;\r\n    }, 2000);\r\n\r\n    this._dispatchHaptic();\r\n\r\n    const player = this.hass.states[entityId];\r\n    if (player && player.attributes.media_position) {\r\n      const position = player.attributes.media_position as number;\r\n      const validTime = player.attributes.media_position_updated_at as string;\r\n      let currentPosition = position;\r\n\r\n      if (validTime) {\r\n        const now = new Date().getTime();\r\n        const updated = new Date(validTime).getTime();\r\n        const diff = (now - updated) / 1000;\r\n        if (player.state === 'playing') {\r\n          currentPosition += diff;\r\n        }\r\n      }\r\n\r\n      const newPosition = Math.max(0, currentPosition - 20);\r\n\r\n      this.hass.callService('media_player', 'media_seek', {\r\n        entity_id: entityId,\r\n        seek_position: newPosition\r\n      });\r\n    }\r\n  }\r\n\r\n  private _dispatchHaptic(type: 'selection' | 'light' | 'medium' | 'heavy' | 'success' | 'warning' | 'failure' = 'selection'): void {\r\n    const event = new CustomEvent('haptic', {\r\n      detail: type,\r\n      bubbles: true,\r\n      composed: true,\r\n    });\r\n    this.dispatchEvent(event);\r\n  }\r\n}\r\n","/**\r\n * JellyHA Library Card for Home Assistant\r\n * \r\n * A Lovelace card that displays media from your Jellyfin server\r\n */\r\n\r\nimport { LitElement, html, nothing, PropertyValues, TemplateResult } from 'lit';\r\nimport { customElement, property, state, query } from 'lit/decorators.js';\r\n\r\nimport { HomeAssistant, LovelaceCard, MediaItem, SensorData, JellyHALibraryCardConfig } from '../shared/types';\r\nimport { isNewItem } from '../shared/utils';\r\nimport { JellyHAItemDetailsModal } from '../components/jellyha-item-details-modal';\r\nimport { cardStyles } from '../styles/jellyha-library-styles';\r\nimport { localize } from '../shared/localize';\r\n\r\n// Import modal for side effects (registration)\r\nimport '../components/jellyha-item-details-modal';\r\n\r\n// Import editor for side effects\r\nimport '../editors/jellyha-library-editor';\r\n\r\n// Import media item for side effects\r\nimport '../components/jellyha-media-item';\r\n\r\n// Register card in the custom cards array\r\nconst CARD_VERSION = '1.0.0';\r\n\r\nconsole.info(\r\n  `%c JELLYHA-LIBRARY-CARD %c v${CARD_VERSION} `,\r\n  'color: white; background: #00a4dc; font-weight: bold;',\r\n  'color: #00a4dc; background: white; font-weight: bold;'\r\n);\r\n\r\n// Register card for picker\r\nwindow.customCards = window.customCards || [];\r\nwindow.customCards.push({\r\n  type: 'jellyha-library-card',\r\n  name: 'JellyHA Library',\r\n  description: 'Display media from Jellyfin',\r\n  preview: true,\r\n});\r\n\r\nconst DEFAULT_CONFIG: Partial<JellyHALibraryCardConfig> = {\r\n  title: '',\r\n  layout: 'carousel',\r\n  media_type: 'both',\r\n  items_per_page: 3,\r\n  max_pages: 5,\r\n  auto_swipe_interval: 0, // 0 = disabled, otherwise seconds\r\n  columns: 2,\r\n  show_title: true,\r\n  show_year: true,\r\n  show_runtime: true,\r\n  show_ratings: true,\r\n  show_media_type_badge: true,\r\n  show_genres: true,\r\n  show_description_on_hover: true,\r\n  enable_pagination: true,\r\n  metadata_position: 'below',\r\n  show_date_added: false,\r\n  rating_source: 'auto',\r\n  new_badge_days: 3,\r\n  theme: 'auto',\r\n  show_watched_status: true,\r\n  click_action: 'more-info',\r\n  hold_action: 'jellyfin',\r\n  default_cast_device: '',\r\n  show_now_playing: true,\r\n  filter_favorites: false,\r\n  status_filter: 'all',\r\n  filter_newly_added: false,\r\n  sort_option: 'date_added_desc',\r\n};\r\n\r\n// Helper function to fire events (replaces custom-card-helpers)\r\nfunction fireEvent(\r\n  node: EventTarget,\r\n  type: string,\r\n  detail?: Record<string, unknown>\r\n): void {\r\n  const event = new CustomEvent(type, {\r\n    bubbles: true,\r\n    composed: true,\r\n    detail,\r\n  });\r\n  node.dispatchEvent(event);\r\n}\r\n\r\n@customElement('jellyha-library-card')\r\nexport class JellyHALibraryCard extends LitElement {\r\n  @property({ attribute: false }) hass!: HomeAssistant;\r\n  @state() private _config!: JellyHALibraryCardConfig;\r\n  @state() private _currentPage = 0;\r\n  @state() private _itemsPerPage = 5;\r\n  @state() private _pressStartTime: number = 0;\r\n  @state() private _holdTimer?: number;\r\n  @state() private _isHoldActive: boolean = false;\r\n  @state() private _rewindActive: boolean = false;\r\n  @state() private _items: MediaItem[] = [];\r\n  @state() private _error?: string;\r\n  @state() private _lastUpdate: string = '';\r\n  @state() private _mostRecentNextUpItemId?: string;\r\n  @state() private _searchQuery = '';\r\n  @state() private _searchGenre = '';\r\n  @query('jellyha-item-details-modal') private _modal!: JellyHAItemDetailsModal;\r\n\r\n  private _touchStartX: number = 0;\r\n  private _touchStartY: number = 0;\r\n  private _isOverscrolling: boolean = false;\r\n  private _elasticAnchorX: number = 0;\r\n  private _itemTouchStartX: number = 0;\r\n  private _itemTouchStartY: number = 0;\r\n\r\n  private _resizeObserver?: ResizeObserver;\r\n  private _resizeHandler?: () => void;\r\n  private _containerWidth = 0;\r\n  private readonly ITEM_WIDTH = 148; // 140px poster + 8px gap - tighter packing\r\n  private readonly LIST_ITEM_MIN_WIDTH = 380; // Minimum width per list column\r\n  private _autoSwipeTimer?: number;\r\n  private _effectiveListColumns = 1; // Calculated based on container width\r\n\r\n  private _isSwiping = false;\r\n  private _autoSwipePaused = false;\r\n  private _animationFrameId?: number;\r\n  private _lastFrameTime = 0;\r\n  private _scrollAccumulator = 0;\r\n\r\n  // Scroll indicator state (for non-paginated scrollable content)\r\n  @state() private _scrollProgress = 0; // 0-1 representing scroll position\r\n  @state() private _hasScrollableContent = false;\r\n  private readonly SCROLL_INDICATOR_DOTS = 5; // Number of dots in scroll indicator\r\n\r\n  static styles = cardStyles;\r\n\r\n  constructor() {\r\n    super();\r\n    this._onDotClick = this._onDotClick.bind(this);\r\n    this._handleTouchStart = this._handleTouchStart.bind(this);\r\n    this._handleTouchMove = this._handleTouchMove.bind(this);\r\n    this._handleTouchEnd = this._handleTouchEnd.bind(this);\r\n    // Pointer events for Android Companion App\r\n    this._handlePointerDown = this._handlePointerDown.bind(this);\r\n    this._handlePointerMove = this._handlePointerMove.bind(this);\r\n    this._handlePointerUp = this._handlePointerUp.bind(this);\r\n    // Scroll handler for elastic indicator\r\n    this._handleScroll = this._handleScroll.bind(this);\r\n  }\r\n\r\n  connectedCallback(): void {\r\n    super.connectedCallback();\r\n    this._setupResizeHandler();\r\n    // Add interaction listeners for auto-swipe\r\n    this.addEventListener('mouseenter', this._handleMouseEnter);\r\n    this.addEventListener('mouseleave', this._handleMouseLeave);\r\n    this.addEventListener('touchstart', this._handleTouchStartInteraction, { passive: true });\r\n    this.addEventListener('touchend', this._handleTouchEndInteraction);\r\n    this._setupAutoSwipe();\r\n  }\r\n\r\n  disconnectedCallback(): void {\r\n    super.disconnectedCallback();\r\n    this._resizeObserver?.disconnect();\r\n    if (this._resizeHandler) {\r\n      window.removeEventListener('resize', this._resizeHandler);\r\n    }\r\n    this.removeEventListener('mouseenter', this._handleMouseEnter);\r\n    this.removeEventListener('mouseleave', this._handleMouseLeave);\r\n    this.removeEventListener('touchstart', this._handleTouchStartInteraction);\r\n    this.removeEventListener('touchend', this._handleTouchEndInteraction);\r\n    this._clearAutoSwipe();\r\n  }\r\n\r\n  private _setupAutoSwipe(): void {\r\n    this._clearAutoSwipe();\r\n    const interval = this._config?.auto_swipe_interval;\r\n    if (!interval || interval <= 0) return;\r\n\r\n    if (this._config.enable_pagination !== false) {\r\n      // Version 1: Paginated (Interval-based)\r\n      this._autoSwipeTimer = window.setInterval(() => {\r\n        if (!this._autoSwipePaused) {\r\n          this._handleAutoSwipePage();\r\n        }\r\n      }, interval * 1000);\r\n    } else {\r\n      // Version 2: Continuous Scroll (RAF-based)\r\n      this._startContinuousScroll();\r\n    }\r\n  }\r\n\r\n  private _clearAutoSwipe(): void {\r\n    if (this._autoSwipeTimer) {\r\n      clearInterval(this._autoSwipeTimer);\r\n      this._autoSwipeTimer = undefined;\r\n    }\r\n    if (this._animationFrameId) {\r\n      cancelAnimationFrame(this._animationFrameId);\r\n      this._animationFrameId = undefined;\r\n    }\r\n  }\r\n\r\n  /* Interaction Handlers for Pausing */\r\n  private _handleMouseEnter = (): void => { this._autoSwipePaused = true; };\r\n  private _handleMouseLeave = (): void => { this._autoSwipePaused = false; };\r\n  private _handleTouchStartInteraction = (): void => { this._autoSwipePaused = true; };\r\n  // Resume after a delay on touch end to let momentum settle (if any) or just resume\r\n  private _handleTouchEndInteraction = (): void => {\r\n    setTimeout(() => { this._autoSwipePaused = false; }, 2000);\r\n  };\r\n\r\n  /* Continuous Scroll Logic */\r\n  private _startContinuousScroll(): void {\r\n    const scrollFn = (timestamp: number) => {\r\n      if (!this._lastFrameTime) this._lastFrameTime = timestamp;\r\n      const deltaTime = timestamp - this._lastFrameTime;\r\n      this._lastFrameTime = timestamp;\r\n\r\n      if (!this._autoSwipePaused && this._config.auto_swipe_interval) {\r\n        const scrollContainer = this.shadowRoot?.querySelector('.carousel, .grid-wrapper, .list-wrapper') as HTMLElement;\r\n\r\n        if (scrollContainer) {\r\n          const { scrollLeft, scrollWidth, clientWidth } = scrollContainer;\r\n\r\n          // Sync accumulator if it's way off (e.g. user manually scrolled)\r\n          // We allow small drift, but if user drags, we need to re-sync\r\n          // Initialize if 0 (first run) or drift > 10\r\n          if (Math.abs(this._scrollAccumulator - scrollLeft) > 10) {\r\n            this._scrollAccumulator = scrollLeft;\r\n          }\r\n\r\n          // Calculate speed: We want to scroll 'clientWidth' pixels in 'interval' seconds\r\n          // pixelsPerMs = clientWidth / (interval * 1000)\r\n          const pxPerMs = clientWidth / (this._config.auto_swipe_interval * 1000);\r\n          const scrollStep = pxPerMs * deltaTime;\r\n\r\n          // Infinite Scroll Reset Logic\r\n          // We assume content is duplicated. Loop point is approx half scrollWidth.\r\n          const resetThreshold = scrollWidth / 2;\r\n\r\n          this._scrollAccumulator += scrollStep;\r\n\r\n          if (this._scrollAccumulator >= resetThreshold) {\r\n            // Seamlessly jump back\r\n            this._scrollAccumulator = this._scrollAccumulator - resetThreshold;\r\n            scrollContainer.scrollLeft = this._scrollAccumulator;\r\n          } else {\r\n            // Normal scroll\r\n            // Use the accumulated value for precise sub-pixel tracking\r\n            scrollContainer.scrollLeft = this._scrollAccumulator;\r\n          }\r\n        }\r\n      }\r\n\r\n      this._animationFrameId = requestAnimationFrame(scrollFn);\r\n    };\r\n\r\n    this._animationFrameId = requestAnimationFrame(scrollFn);\r\n  }\r\n\r\n  /* Pagination Auto Swipe Logic */\r\n  private async _handleAutoSwipePage(): Promise<void> {\r\n    // Determine if we need to loop\r\n    // Re-calculate basic stats\r\n    const items = this._items || []; // Use cached items\r\n    const itemsPerPage = this._config.items_per_page || this._itemsPerPage;\r\n    const maxPages = this._config.max_pages || 10;\r\n    const totalPages = Math.min(Math.ceil(items.length / itemsPerPage), maxPages);\r\n\r\n    if (this._currentPage >= totalPages - 1) {\r\n      // Loop back to start\r\n      await this._animatePageChange('next', () => { // Animate direction 'next' usually feels like forward movement even when looping\r\n        this._currentPage = 0;\r\n      });\r\n    } else {\r\n      // Normal next page\r\n      this._nextPage();\r\n    }\r\n  }\r\n\r\n  /* Pagination Handlers */\r\n  private async _nextPage(): Promise<void> {\r\n    if (!this._config?.entity || !this.hass) return;\r\n    const entity = this.hass.states[this._config.entity];\r\n    if (!entity) return;\r\n\r\n    // Get items directly as per previous implementation logic\r\n    // Use _items fetched from WebSocket\r\n    const items = this._filterItems(this._items || []);\r\n\r\n    const itemsPerPage = this._config.items_per_page || this._itemsPerPage;\r\n    const maxPages = this._config.max_pages || 10;\r\n    const totalPages = Math.min(Math.ceil(items.length / itemsPerPage), maxPages);\r\n\r\n    if (this._currentPage < totalPages - 1) {\r\n      await this._animatePageChange('next', () => {\r\n        this._currentPage++;\r\n      });\r\n    }\r\n  }\r\n\r\n  private async _prevPage(): Promise<void> {\r\n    if (this._currentPage > 0) {\r\n      await this._animatePageChange('prev', () => {\r\n        this._currentPage--;\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Helper to set scroll position after page change\r\n   */\r\n  private _setScrollPosition(position: 'start' | 'end'): void {\r\n    const scrollContainer = this.shadowRoot?.querySelector('.carousel, .grid-wrapper, .list-wrapper');\r\n    if (scrollContainer) {\r\n      if (position === 'start') {\r\n        scrollContainer.scrollLeft = 0;\r\n      } else {\r\n        // Set to max scroll width to jump to end\r\n        scrollContainer.scrollLeft = scrollContainer.scrollWidth;\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Helper to animate page changes (Slide & Fade)\r\n   **/\r\n  private async _animatePageChange(direction: 'next' | 'prev', updateState: () => void): Promise<void> {\r\n    const scrollContainer = this.shadowRoot?.querySelector('.carousel, .grid-wrapper, .list-wrapper') as HTMLElement;\r\n    if (!scrollContainer) {\r\n      updateState();\r\n      return;\r\n    }\r\n\r\n    // Phase 1: Exit\r\n    const exitTranslate = direction === 'next' ? '-30px' : '30px';\r\n    scrollContainer.style.transition = 'transform 0.2s ease-out, opacity 0.2s ease-out';\r\n    scrollContainer.style.transform = `translateX(${exitTranslate})`;\r\n    scrollContainer.style.opacity = '0';\r\n\r\n    // Wait for exit animation\r\n    await new Promise(resolve => setTimeout(resolve, 200));\r\n\r\n    // Phase 2: Update State & Reset properties\r\n    updateState();\r\n    await this.updateComplete;\r\n\r\n    // Reset scroll position based on direction\r\n    this._setScrollPosition(direction === 'next' ? 'start' : 'end');\r\n\r\n    // Phase 3: Prepare Enter\r\n    const enterTranslate = direction === 'next' ? '30px' : '-30px';\r\n    scrollContainer.style.transition = 'none';\r\n    scrollContainer.style.opacity = '0';\r\n    scrollContainer.style.transform = `translateX(${enterTranslate})`;\r\n\r\n    // Force reflow using getComputedStyle (batched read, safer)\r\n    void scrollContainer.offsetHeight;\r\n\r\n    // Phase 4: Enter Animation\r\n    scrollContainer.style.transition = 'transform 0.25s ease-out, opacity 0.25s ease-out';\r\n    scrollContainer.style.transform = 'translateX(0)';\r\n    scrollContainer.style.opacity = '1';\r\n\r\n    // Cleanup after animation\r\n    await new Promise(resolve => setTimeout(resolve, 250));\r\n    scrollContainer.style.transition = '';\r\n    scrollContainer.style.transform = '';\r\n    scrollContainer.style.opacity = '';\r\n  }\r\n\r\n  /**\r\n   * Helper to get total pages (used for elastic check)\r\n   */\r\n  private _getTotalPages(): number {\r\n    if (!this._config?.entity || !this.hass) return 1;\r\n    const entity = this.hass.states[this._config.entity];\r\n    if (!entity) return 1;\r\n\r\n    // Quick estimation logic as per _nextPage\r\n    // Use _items fetched from WebSocket\r\n    const items = this._filterItems(this._items || []);\r\n    const itemsPerPage = this._config.items_per_page || this._itemsPerPage;\r\n    const maxPages = this._config.max_pages || 10;\r\n    return Math.min(Math.ceil(items.length / itemsPerPage), maxPages);\r\n  }\r\n\r\n  // Touch/Swipe handlers\r\n  private _handleTouchStart(e: TouchEvent): void {\r\n    this._touchStartX = e.touches[0].clientX;\r\n    this._touchStartY = e.touches[0].clientY;\r\n    this._isSwiping = false;\r\n    this._isOverscrolling = false;\r\n    this._elasticAnchorX = 0;\r\n  }\r\n\r\n  private _handleTouchMove(e: TouchEvent): void {\r\n    if (!this._touchStartX) return;\r\n    const diffX = e.touches[0].clientX - this._touchStartX;\r\n    const diffY = e.touches[0].clientY - this._touchStartY;\r\n\r\n    // Only swipe/scroll logic if horizontal movement > vertical\r\n    if (Math.abs(diffX) > Math.abs(diffY)) {\r\n      // Elastic Scroll Effect Logic\r\n      const scrollContainer = this.shadowRoot?.querySelector('.carousel, .grid-wrapper, .list-wrapper') as HTMLElement;\r\n      if (scrollContainer && Math.abs(diffX) > 0) {\r\n        const { scrollLeft, scrollWidth, clientWidth } = scrollContainer;\r\n        const maxScroll = scrollWidth - clientWidth;\r\n        const isStart = scrollLeft <= 5;\r\n        const isEnd = scrollLeft >= maxScroll - 5;\r\n        const showPagination = this._config.show_pagination !== false;\r\n\r\n        let shouldElastic = false;\r\n\r\n        if (showPagination) {\r\n          // If paginated: only elastic on FIRST page (left pull) or LAST page (right pull)\r\n          const totalPages = this._getTotalPages();\r\n          if (isStart && diffX > 0 && this._currentPage === 0) shouldElastic = true;\r\n          if (isEnd && diffX < 0 && this._currentPage >= totalPages - 1) shouldElastic = true;\r\n        } else {\r\n          // If not paginated: elastic on both ends\r\n          if (isStart && diffX > 0) shouldElastic = true;\r\n          if (isEnd && diffX < 0) shouldElastic = true;\r\n        }\r\n\r\n        if (shouldElastic) {\r\n          if (!this._isOverscrolling) {\r\n            // First frame of overscroll - anchor here\r\n            this._isOverscrolling = true;\r\n            this._elasticAnchorX = diffX;\r\n          }\r\n\r\n          if (e.cancelable) e.preventDefault(); // Stop native scroll to control transform manually\r\n          // Apply resistance (0.3 factor) to the delta from anchor\r\n          const resistance = 0.3;\r\n          const elasticDiff = diffX - this._elasticAnchorX;\r\n\r\n          scrollContainer.style.transition = 'none'; // Follow finger exactly\r\n          scrollContainer.style.transform = `translateX(${elasticDiff * resistance}px)`;\r\n          return;\r\n        }\r\n      }\r\n\r\n      if (Math.abs(diffX) > 30) {\r\n        this._isSwiping = true;\r\n        // Allow native scroll to happen otherwise\r\n      }\r\n    }\r\n  }\r\n\r\n  private _handleTouchEnd(e: TouchEvent): void {\r\n    // Handle Elastic Reset\r\n    if (this._isOverscrolling) {\r\n      const scrollContainer = this.shadowRoot?.querySelector('.carousel, .grid-wrapper, .list-wrapper') as HTMLElement;\r\n      if (scrollContainer) {\r\n        scrollContainer.style.transition = 'transform 0.4s cubic-bezier(0.25, 0.8, 0.5, 1)';\r\n        scrollContainer.style.transform = '';\r\n      }\r\n      this._isOverscrolling = false;\r\n      this._elasticAnchorX = 0;\r\n      this._touchStartX = 0;\r\n      this._isSwiping = false;\r\n      return; // Stop here, do not trigger page switch\r\n    }\r\n\r\n    if (!this._isSwiping) {\r\n      this._touchStartX = 0;\r\n      return;\r\n    }\r\n\r\n    // If pagination is disabled, don't switch pages\r\n    if (this._config.show_pagination === false) {\r\n      this._touchStartX = 0;\r\n      this._isSwiping = false;\r\n      return;\r\n    }\r\n\r\n    const diffX = e.changedTouches[0].clientX - this._touchStartX;\r\n    const threshold = 50; // Minimum swipe distance\r\n    // Check for either carousel or grid wrapper (whichever is active)\r\n    const scrollContainer = this.shadowRoot?.querySelector('.carousel, .grid-wrapper, .list-wrapper');\r\n\r\n    if (diffX < -threshold) {\r\n      // Swipe Left (Next Page)\r\n      // Only switch if we are at the end of scroll\r\n      if (scrollContainer) {\r\n        const { scrollLeft, scrollWidth, clientWidth } = scrollContainer;\r\n        if (scrollLeft + clientWidth >= scrollWidth - 10) {\r\n          this._nextPage();\r\n        }\r\n      } else {\r\n        this._nextPage();\r\n      }\r\n    } else if (diffX > threshold) {\r\n      // Swipe Right (Prev Page)\r\n      // Only switch if we are at the start of scroll\r\n      if (scrollContainer) {\r\n        if (scrollContainer.scrollLeft <= 10) {\r\n          this._prevPage();\r\n        }\r\n      } else {\r\n        this._prevPage();\r\n      }\r\n    }\r\n\r\n    this._touchStartX = 0;\r\n    this._isSwiping = false;\r\n  }\r\n\r\n  // Pointer events for Android Companion App (uses same logic as touch)\r\n  // Pointer events for Android Companion App (uses same logic as touch)\r\n  private _handlePointerDown(e: PointerEvent): void {\r\n    if (e.pointerType === 'mouse') return; // Skip mouse, only handle touch/pen\r\n    this._touchStartX = e.clientX;\r\n    this._touchStartY = e.clientY;\r\n    this._isSwiping = false;\r\n    this._isOverscrolling = false;\r\n    this._elasticAnchorX = 0;\r\n    // Capture pointer for better tracking on Android\r\n    (e.target as HTMLElement).setPointerCapture?.(e.pointerId);\r\n  }\r\n\r\n  private _handlePointerMove(e: PointerEvent): void {\r\n    if (e.pointerType === 'mouse' || !this._touchStartX) return;\r\n    const diffX = e.clientX - this._touchStartX;\r\n    const diffY = e.clientY - this._touchStartY;\r\n\r\n    // Only swipe/scroll logic if horizontal movement > vertical\r\n    if (Math.abs(diffX) > Math.abs(diffY)) {\r\n      // Elastic Scroll Effect Logic\r\n      const scrollContainer = this.shadowRoot?.querySelector('.carousel, .grid-wrapper, .list-wrapper') as HTMLElement;\r\n      if (scrollContainer && Math.abs(diffX) > 0) {\r\n        const { scrollLeft, scrollWidth, clientWidth } = scrollContainer;\r\n        const maxScroll = scrollWidth - clientWidth;\r\n        const isStart = scrollLeft <= 5;\r\n        const isEnd = scrollLeft >= maxScroll - 5;\r\n        const showPagination = this._config.show_pagination !== false;\r\n\r\n        let shouldElastic = false;\r\n\r\n        if (showPagination) {\r\n          const totalPages = this._getTotalPages();\r\n          if (isStart && diffX > 0 && this._currentPage === 0) shouldElastic = true;\r\n          if (isEnd && diffX < 0 && this._currentPage >= totalPages - 1) shouldElastic = true;\r\n        } else {\r\n          if (isStart && diffX > 0) shouldElastic = true;\r\n          if (isEnd && diffX < 0) shouldElastic = true;\r\n        }\r\n\r\n        if (shouldElastic) {\r\n          if (!this._isOverscrolling) {\r\n            this._isOverscrolling = true;\r\n            this._elasticAnchorX = diffX;\r\n          }\r\n\r\n          if (e.cancelable) e.preventDefault();\r\n          const resistance = 0.3;\r\n          const elasticDiff = diffX - this._elasticAnchorX;\r\n\r\n          scrollContainer.style.transition = 'none';\r\n          scrollContainer.style.transform = `translateX(${elasticDiff * resistance}px)`;\r\n          return;\r\n        }\r\n      }\r\n\r\n      if (Math.abs(diffX) > 30) {\r\n        this._isSwiping = true;\r\n      }\r\n    }\r\n  }\r\n\r\n  private _handlePointerUp(e: PointerEvent): void {\r\n    // Release pointer capture\r\n    (e.target as HTMLElement).releasePointerCapture?.(e.pointerId);\r\n\r\n    // Handle Elastic Reset\r\n    if (this._isOverscrolling) {\r\n      const scrollContainer = this.shadowRoot?.querySelector('.carousel, .grid-wrapper, .list-wrapper') as HTMLElement;\r\n      if (scrollContainer) {\r\n        scrollContainer.style.transition = 'transform 0.4s cubic-bezier(0.25, 0.8, 0.5, 1)';\r\n        scrollContainer.style.transform = '';\r\n      }\r\n      this._isOverscrolling = false;\r\n      this._elasticAnchorX = 0;\r\n      this._touchStartX = 0;\r\n      this._isSwiping = false;\r\n      return;\r\n    }\r\n\r\n    if (e.pointerType === 'mouse' || !this._isSwiping) {\r\n      this._touchStartX = 0;\r\n      return;\r\n    }\r\n\r\n    // If pagination is disabled, don't switch pages\r\n    if (this._config.show_pagination === false) {\r\n      this._touchStartX = 0;\r\n      this._isSwiping = false;\r\n      return;\r\n    }\r\n\r\n    const diffX = e.clientX - this._touchStartX;\r\n    const threshold = 50;\r\n    const scrollContainer = this.shadowRoot?.querySelector('.carousel, .grid-wrapper, .list-wrapper');\r\n\r\n    if (diffX < -threshold) {\r\n      if (scrollContainer) {\r\n        const { scrollLeft, scrollWidth, clientWidth } = scrollContainer;\r\n        if (scrollLeft + clientWidth >= scrollWidth - 10) {\r\n          this._nextPage();\r\n        }\r\n      } else {\r\n        this._nextPage();\r\n      }\r\n    } else if (diffX > threshold) {\r\n      if (scrollContainer) {\r\n        if (scrollContainer.scrollLeft <= 10) {\r\n          this._prevPage();\r\n        }\r\n      } else {\r\n        this._prevPage();\r\n      }\r\n    }\r\n    this._touchStartX = 0;\r\n    this._isSwiping = false;\r\n  }\r\n\r\n  // Scroll handler for elastic dot indicator\r\n  private _handleScroll(e: Event): void {\r\n    const target = e.target as HTMLElement;\r\n    const scrollWidth = target.scrollWidth;\r\n    const clientWidth = target.clientWidth;\r\n    const scrollLeft = target.scrollLeft;\r\n\r\n    // Check if content is scrollable\r\n    const isScrollable = scrollWidth > clientWidth + 10; // 10px buffer\r\n    if (isScrollable !== this._hasScrollableContent) {\r\n      this._hasScrollableContent = isScrollable;\r\n    }\r\n\r\n    // Calculate scroll progress (0 to 1)\r\n    if (isScrollable) {\r\n      let progress = 0;\r\n      // Check if we are in infinite scroll mode (pagination disabled + auto swipe enabled)\r\n      const isInfiniteScroll = this._config.enable_pagination === false && (this._config.auto_swipe_interval || 0) > 0;\r\n\r\n      if (isInfiniteScroll) {\r\n        // In infinite scroll, content is duplicated, so the full loop is half the scroll width\r\n        const loopThreshold = scrollWidth / 2;\r\n        progress = scrollLeft / loopThreshold;\r\n      } else {\r\n        const maxScroll = scrollWidth - clientWidth;\r\n        progress = scrollLeft / maxScroll;\r\n      }\r\n\r\n      // Round to 1 when close to end (within 10px or 2%)\r\n      // For infinite scroll, we just clamp, as it will reset automatically\r\n      if (!isInfiniteScroll && (scrollWidth - clientWidth - scrollLeft < 10 || progress > 0.98)) {\r\n        progress = 1;\r\n      }\r\n      // Round to 0 when at start\r\n      if (scrollLeft < 10 || progress < 0.02) {\r\n        progress = 0;\r\n      }\r\n      progress = Math.min(1, Math.max(0, progress));\r\n      // Always update - no threshold, ensures smooth tracking\r\n      this._scrollProgress = progress;\r\n    }\r\n  }\r\n\r\n  // Render scroll indicator for non-paginated scrollable content\r\n  private _renderScrollIndicator(): TemplateResult {\r\n    if (!this._hasScrollableContent || this._config.show_pagination_dots === false) return html``;\r\n\r\n    const numDots = this.SCROLL_INDICATOR_DOTS;\r\n    const progress = this._scrollProgress;\r\n\r\n    // Use round for immediate snapping to nearest dot (consistent in both directions)\r\n    const activeIndex = Math.round(progress * (numDots - 1));\r\n\r\n    return html`\r\n      <div class=\"scroll-indicator\">\r\n        ${Array.from({ length: numDots }, (_, i) => {\r\n      const isActive = i === activeIndex;\r\n      // Pill shape at start (first dot when at 0) or end (last dot when at 1)\r\n      const isPill = (i === 0 && progress < 0.1) || (i === numDots - 1 && progress > 0.9);\r\n\r\n      return html`\r\n        <span \r\n          class=\"scroll-dot ${isActive ? 'active' : ''} ${isPill ? 'pill' : ''}\"\r\n        ></span>\r\n      `;\r\n    })}\r\n      </div>\r\n    `;\r\n  }\r\n\r\n\r\n\r\n  private _setupResizeHandler(): void {\r\n    // Create resize handler function\r\n    this._resizeHandler = () => {\r\n      const rect = this.getBoundingClientRect();\r\n      const width = rect.width;\r\n\r\n      // If width is 0 (hidden), don't update layout yet\r\n      if (width === 0) return;\r\n\r\n      const contentWidth = Math.max(0, width - 32); // Subtract padding\r\n\r\n      if (contentWidth !== this._containerWidth) {\r\n        this._containerWidth = contentWidth;\r\n        // Logic for items per page based on ITEM_WIDTH constant (e.g. 150px)\r\n        const ITEM_WIDTH = 160;\r\n        const newItemsPerPage = Math.max(2, Math.floor(contentWidth / ITEM_WIDTH));\r\n\r\n        if (newItemsPerPage !== this._itemsPerPage) {\r\n          this._itemsPerPage = newItemsPerPage;\r\n          // Only reset page if drastic change? Or just ensure valid page\r\n          // this._currentPage = 0; // Don't reset page on resize, annoying\r\n          this.requestUpdate();\r\n        }\r\n\r\n        // Calculate effective list columns\r\n        if (this._config) {\r\n          const configColumns = this._config.columns || 1;\r\n          const LIST_ITEM_MIN_WIDTH = 300;\r\n          if (configColumns > 1) {\r\n            const maxFitColumns = Math.max(1, Math.floor(contentWidth / LIST_ITEM_MIN_WIDTH));\r\n            const newEffectiveColumns = Math.min(configColumns, maxFitColumns);\r\n            if (newEffectiveColumns !== this._effectiveListColumns) {\r\n              this._effectiveListColumns = newEffectiveColumns;\r\n              this.requestUpdate();\r\n            }\r\n          } else if (this._effectiveListColumns !== 1) {\r\n            this._effectiveListColumns = 1;\r\n            this.requestUpdate();\r\n          }\r\n        }\r\n      }\r\n    };\r\n\r\n    // Use ResizeObserver for robust detection\r\n    try {\r\n      this._resizeObserver = new ResizeObserver(() => {\r\n        // Debounce slightly if needed, or just call handler\r\n        if (this._resizeHandler) {\r\n          window.requestAnimationFrame(() => this._resizeHandler!());\r\n        }\r\n      });\r\n      this._resizeObserver.observe(this);\r\n    } catch (e) {\r\n      // Fallback for very old browsers (unlikely in HA)\r\n      console.warn('ResizeObserver not supported, falling back to window resize', e);\r\n      window.addEventListener('resize', this._resizeHandler);\r\n    }\r\n\r\n    // Call once initially\r\n    this._resizeHandler();\r\n  }\r\n\r\n\r\n\r\n  private _handleDotClick(page: number): void {\r\n    if (page !== this._currentPage) {\r\n      this._currentPage = page;\r\n      this.requestUpdate();\r\n    }\r\n  }\r\n\r\n  private _onDotClick(e: Event): void {\r\n    e.stopPropagation();\r\n    e.preventDefault();\r\n    const target = e.currentTarget as HTMLButtonElement;\r\n    const page = parseInt(target.dataset.page || '0', 10);\r\n    this._handleDotClick(page);\r\n  }\r\n\r\n  /**\r\n   * Set card configuration\r\n   */\r\n  public setConfig(config: JellyHALibraryCardConfig): void {\r\n    if (!config.entity) {\r\n      throw new Error('Please define an entity');\r\n    }\r\n\r\n    this._config = { ...DEFAULT_CONFIG, ...config };\r\n    // Initialize effective list columns from config\r\n    this._effectiveListColumns = this._config.columns || 1;\r\n  }\r\n\r\n  /**\r\n   * Return the card editor element\r\n   */\r\n  public static getConfigElement(): HTMLElement {\r\n    return document.createElement('jellyha-library-editor');\r\n  }\r\n\r\n  /**\r\n   * Return default stub config for card picker\r\n   */\r\n  public static getStubConfig(): Partial<JellyHALibraryCardConfig> {\r\n    return {\r\n      entity: 'sensor.jellyha_library',\r\n      ...DEFAULT_CONFIG,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get card size for layout\r\n   */\r\n  public getCardSize(): number {\r\n    return this._config?.layout === 'list' ? 5 : 3;\r\n  }\r\n\r\n  public getLayoutOptions() {\r\n    return {\r\n      grid_rows: 6,\r\n      grid_columns: 12,\r\n    };\r\n  }\r\n\r\n  public getGridOptions() {\r\n    return {\r\n      columns: 12,\r\n      rows: 6,\r\n      min_columns: 12,\r\n      min_rows: 4,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Determine if component should update\r\n   */\r\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\r\n    if (!this._config) {\r\n      return false;\r\n    }\r\n\r\n    // Always update if internal carousel state changes or items change\r\n    if (changedProps.has('_currentPage') || changedProps.has('_itemsPerPage') || changedProps.has('_items') || changedProps.has('_error') || changedProps.has('_searchQuery') || changedProps.has('_searchGenre')) {\r\n      return true;\r\n    }\r\n\r\n    // Update if scroll indicator state changes\r\n    if (changedProps.has('_scrollProgress') || changedProps.has('_hasScrollableContent')) {\r\n      return true;\r\n    }\r\n\r\n    if (changedProps.has('hass')) {\r\n      const oldHass = changedProps.get('hass') as HomeAssistant | undefined;\r\n      if (oldHass) {\r\n        const oldState = oldHass.states[this._config.entity];\r\n        const newState = this.hass.states[this._config.entity];\r\n\r\n        // Also check default cast device state\r\n        const castEntity = this._config.default_cast_device;\r\n        if (castEntity) {\r\n          const oldCastState = oldHass.states[castEntity];\r\n          const newCastState = this.hass.states[castEntity];\r\n          if (oldCastState !== newCastState) return true;\r\n        }\r\n\r\n        return oldState !== newState;\r\n      }\r\n    }\r\n\r\n    return changedProps.has('_config');\r\n  }\r\n\r\n  /**\r\n   * Fetch items from WebSocket\r\n   */\r\n  private async _fetchItems(): Promise<void> {\r\n    if (!this._config || !this.hass) return;\r\n\r\n    const entityState = this.hass.states[this._config.entity];\r\n    if (!entityState) return;\r\n\r\n    this._error = undefined; // Reset error\r\n\r\n\r\n    try {\r\n      let result;\r\n      if (this._config.media_type === 'next_up') {\r\n        result = await this.hass.callWS<{ items: MediaItem[] }>({\r\n          type: 'jellyha/get_user_next_up',\r\n          entity_id: this._config.entity\r\n        });\r\n      } else {\r\n        result = await this.hass.callWS<{ items: MediaItem[] }>({\r\n          type: 'jellyha/get_items',\r\n          entity_id: this._config.entity\r\n        });\r\n      }\r\n\r\n      if (result && result.items) {\r\n        this._items = result.items;\r\n        // For Next Up media type, the default API sort is DatePlayed Descending.\r\n        // So the first item in the raw list is the most recently watched series' next episode.\r\n        // We capture this ID to consistently highlight it regardless of frontend sorting.\r\n        if (this._config.media_type === 'next_up' && this._items.length > 0) {\r\n          this._mostRecentNextUpItemId = this._items[0].id;\r\n        } else {\r\n          this._mostRecentNextUpItemId = undefined;\r\n        }\r\n      } else {\r\n        // Fallback or empty\r\n        this._items = [];\r\n        this._mostRecentNextUpItemId = undefined;\r\n      }\r\n    } catch (err) {\r\n      console.error('Error fetching JellyHA items:', err);\r\n      // For Next Up, if WS fails (e.g. old backend), we might just show error or empty\r\n      this._error = `Error fetching items: ${err}`;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Called after update - check for scrollable content and fetch data\r\n   */\r\n  protected updated(changedProps: PropertyValues): void {\r\n    super.updated(changedProps);\r\n\r\n    // Check if we need to fetch items\r\n    if (changedProps.has('hass') || changedProps.has('_config')) {\r\n      const entity = this.hass?.states[this._config?.entity];\r\n      if (entity) {\r\n        const entryId = (entity.attributes as unknown as SensorData).entry_id;\r\n        const lastUpdated = (entity.attributes as unknown as SensorData).last_updated;\r\n\r\n        // If entry_id changed or last_updated changed, fetch items\r\n        // Also fetch if we haven't fetched yet (empty items)\r\n        if (lastUpdated !== this._lastUpdate || (this._items.length === 0 && entryId)) {\r\n          this._lastUpdate = lastUpdated;\r\n          this._fetchItems();\r\n        }\r\n      }\r\n    }\r\n\r\n    // Check if carousel/grid/list is scrollable after render\r\n    if (!this._config.enable_pagination) {\r\n\r\n      requestAnimationFrame(() => {\r\n        const scrollable = this.shadowRoot?.querySelector('.carousel.scrollable, .grid-wrapper, .list-wrapper') as HTMLElement;\r\n        if (scrollable) {\r\n          const isScrollable = scrollable.scrollWidth > scrollable.clientWidth + 10;\r\n          if (isScrollable !== this._hasScrollableContent) {\r\n            this._hasScrollableContent = isScrollable;\r\n          }\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Render the card\r\n   */\r\n  protected render(): TemplateResult {\r\n    if (!this._config || !this.hass) {\r\n      return html``;\r\n    }\r\n\r\n    const entity = this.hass.states[this._config.entity];\r\n\r\n    if (!entity) {\r\n      return this._renderError(`Entity not found: ${this._config.entity}`);\r\n    }\r\n\r\n    if (this._error) {\r\n      return this._renderError(this._error);\r\n    }\r\n\r\n\r\n    const items = this._filterItems(this._items || []);\r\n\r\n    return html`\r\n      <ha-card>\r\n        <div class=\"card-inner\">\r\n            ${this._config.title\r\n        ? html`\r\n                  <div class=\"card-header\">\r\n                    <h2>${this._config.title}</h2>\r\n                  </div>\r\n                `\r\n        : nothing}\r\n            ${this._config.show_search ? this._renderSearchBar(items) : nothing}\r\n            <div class=\"card-content\">\r\n              ${items.length === 0\r\n        ? this._renderEmpty()\r\n        : this._renderLayout(items)}\r\n            </div>\r\n        </div>\r\n        <jellyha-item-details-modal .hass=${this.hass}></jellyha-item-details-modal>\r\n      </ha-card>\r\n    `;\r\n  }\r\n\r\n  /**\r\n   * Filter items based on config\r\n   */\r\n  private _filterItems(items: MediaItem[]): MediaItem[] {\r\n    let filtered = items;\r\n\r\n    // Filter by search query\r\n    if (this._searchQuery) {\r\n      const q = this._searchQuery.toLowerCase();\r\n      filtered = filtered.filter((item) => item.name.toLowerCase().includes(q));\r\n    }\r\n\r\n    // Filter by genre\r\n    if (this._searchGenre) {\r\n      filtered = filtered.filter((item) => item.genres && item.genres.includes(this._searchGenre));\r\n    }\r\n\r\n    // Filter by media type\r\n    if (this._config.media_type === 'movies') {\r\n      filtered = filtered.filter((item) => item.type === 'Movie');\r\n    } else if (this._config.media_type === 'series') {\r\n      filtered = filtered.filter((item) => item.type === 'Series');\r\n    } else if (this._config.media_type === 'next_up') {\r\n      // Next Up items are already filtered by backend\r\n      // But we might want to ensure they are valid\r\n\r\n      // CRITICAL: For Next Up, we MUST respect the server's order (which is by Last Played).\r\n      // If we let the card re-sort by default (Date Added), it scrambles the order.\r\n      // So we bypass the entire client-side sorting block below.\r\n\r\n      // Apply limit based on items_per_page * max_pages (same as below)\r\n      const maxPages = this._config.max_pages;\r\n      if (maxPages !== undefined && maxPages !== null && maxPages > 0) {\r\n        const limit = (this._config.items_per_page || 5) * maxPages;\r\n        filtered = filtered.slice(0, limit);\r\n      }\r\n      return filtered;\r\n    }\r\n\r\n    // Filter by favorites\r\n    if (this._config.filter_favorites) {\r\n      filtered = filtered.filter((item) => item.is_favorite === true);\r\n    }\r\n\r\n    // Filter by unwatched\r\n    // Filter by watch status\r\n    const statusFilter = this._config.status_filter || 'all';\r\n    if (statusFilter === 'unwatched') {\r\n      filtered = filtered.filter((item) => !item.is_played);\r\n    } else if (statusFilter === 'watched') {\r\n      filtered = filtered.filter((item) => item.is_played === true);\r\n    }\r\n    // Filter by newly added\r\n    if (this._config.filter_newly_added) {\r\n      filtered = filtered.filter((item) => isNewItem(item, this._config.new_badge_days || 0));\r\n    }\r\n\r\n    // Sorting\r\n    const sortOption = this._config.sort_option || 'date_added_desc';\r\n    filtered.sort((a, b) => {\r\n      switch (sortOption) {\r\n        case 'date_added_asc':\r\n          return (a.date_added || '').localeCompare(b.date_added || '');\r\n        case 'date_added_desc':\r\n          return (b.date_added || '').localeCompare(a.date_added || '');\r\n\r\n        case 'title_asc':\r\n          return (a.name || '').localeCompare(b.name || '');\r\n        case 'title_desc':\r\n          return (b.name || '').localeCompare(a.name || '');\r\n\r\n        case 'year_asc':\r\n          return (a.year || 0) - (b.year || 0);\r\n        case 'year_desc':\r\n          return (b.year || 0) - (a.year || 0);\r\n\r\n        case 'last_played_asc':\r\n          return (a.last_played_date || '').localeCompare(b.last_played_date || '');\r\n        case 'last_played_desc':\r\n          return (b.last_played_date || '').localeCompare(a.last_played_date || '');\r\n\r\n        default:\r\n          return 0;\r\n      }\r\n    });\r\n\r\n    // Apply limit based on items_per_page * max_pages\r\n    const maxPages = this._config.max_pages;\r\n    if (maxPages !== undefined && maxPages !== null && maxPages > 0) {\r\n      const limit = (this._config.items_per_page || 5) * maxPages;\r\n      filtered = filtered.slice(0, limit);\r\n    }\r\n\r\n    return filtered;\r\n  }\r\n\r\n  /**\r\n   * Render media item action handler\r\n   */\r\n  private _handleItemAction(e: CustomEvent): void {\r\n    const { type, item } = e.detail;\r\n    this._performAction(item, type);\r\n  }\r\n\r\n  /**\r\n   * Render layout based on config\r\n   */\r\n  private _renderLayout(items: MediaItem[]): TemplateResult {\r\n    const layout = this._config.layout || 'carousel';\r\n    const enablePagination = this._config.enable_pagination !== false;\r\n\r\n    if (layout === 'carousel') {\r\n      return this._renderCarousel(items, enablePagination);\r\n    }\r\n\r\n    if (layout === 'list') {\r\n      return this._renderList(items, enablePagination);\r\n    }\r\n\r\n    if (layout === 'grid') {\r\n      return this._renderGrid(items, enablePagination);\r\n    }\r\n\r\n    return html`\r\n      <div class=\"${layout}\">\r\n        ${items.map((item) => html`\r\n            <jellyha-media-item\r\n                .hass=${this.hass}\r\n                .config=${this._config}\r\n                .item=${item}\r\n                .layout=${'grid'}\r\n                @jellyha-action=${this._handleItemAction}\r\n            ></jellyha-media-item>\r\n        `)}\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  /**\r\n   * Render carousel with optional pagination\r\n   */\r\n  private _renderCarousel(items: MediaItem[], showPagination: boolean): TemplateResult {\r\n    const itemsPerPage = this._config.items_per_page || this._itemsPerPage;\r\n    const rawMaxPages = this._config.max_pages;\r\n    const maxPagesNum = rawMaxPages ? Number(rawMaxPages) : 0;\r\n    const effectiveMaxPages = (maxPagesNum > 0) ? maxPagesNum : Infinity;\r\n    const totalPages = Math.min(Math.ceil(items.length / itemsPerPage), effectiveMaxPages);\r\n\r\n    const startIdx = this._currentPage * itemsPerPage;\r\n    // For Infinite Scroll (no pagination), duplicate items ONLY if auto swipe is enabled\r\n    const shouldDuplicate = !showPagination && (this._config.auto_swipe_interval || 0) > 0;\r\n    const visibleItems = showPagination\r\n      ? items.slice(startIdx, startIdx + itemsPerPage)\r\n      : (shouldDuplicate ? [...items, ...items] : items);\r\n\r\n    return html`\r\n      <div \r\n        class=\"carousel-wrapper ${this._config.horizontal_alignment !== 'left' ? 'align-center' : ''}\"\r\n        @touchstart=\"${this._handleTouchStart}\"\r\n        @touchmove=\"${this._handleTouchMove}\"\r\n        @touchend=\"${this._handleTouchEnd}\"\r\n        @pointerdown=\"${this._handlePointerDown}\"\r\n        @pointermove=\"${this._handlePointerMove}\"\r\n        @pointerup=\"${this._handlePointerUp}\"\r\n      >\r\n        <div \r\n          class=\"carousel ${showPagination ? 'paginated' : 'scrollable'}\"\r\n          @scroll=\"${!showPagination ? this._handleScroll : nothing}\"\r\n        >\r\n          ${visibleItems.map((item) => html`\r\n            <jellyha-media-item\r\n                .hass=${this.hass}\r\n                .config=${this._config}\r\n                .item=${item}\r\n                .layout=${'grid'}\r\n                .isNextUpHighlight=${this._config.media_type === 'next_up' && item.id === this._mostRecentNextUpItemId}\r\n                @jellyha-action=${this._handleItemAction}\r\n            ></jellyha-media-item>\r\n          `)}\r\n        </div>\r\n        ${showPagination && totalPages > 1\r\n        ? this._renderPagination(totalPages)\r\n        : nothing}\r\n        ${!showPagination ? this._renderScrollIndicator() : nothing}\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  /**\r\n   * Render list with optional pagination\r\n   */\r\n  private _renderList(items: MediaItem[], enablePagination: boolean): TemplateResult {\r\n    const itemsPerPage = this._config.items_per_page || this._itemsPerPage;\r\n    const rawMaxPages = this._config.max_pages;\r\n    const maxPagesNum = rawMaxPages ? Number(rawMaxPages) : 0;\r\n    const effectiveMaxPages = (maxPagesNum > 0) ? maxPagesNum : Infinity;\r\n    const totalPages = Math.min(Math.ceil(items.length / itemsPerPage), effectiveMaxPages);\r\n\r\n    const startIdx = this._currentPage * itemsPerPage;\r\n    // For Infinite Scroll (no pagination), duplicate items ONLY if auto swipe is enabled\r\n    const shouldDuplicate = !enablePagination && (this._config.auto_swipe_interval || 0) > 0;\r\n    const visibleItems = enablePagination\r\n      ? items.slice(startIdx, startIdx + itemsPerPage)\r\n      : (shouldDuplicate ? [...items, ...items] : items);\r\n\r\n    // Use effective columns (calculated based on container width)\r\n    const columns = this._effectiveListColumns;\r\n    const isSingleColumn = columns === 1;\r\n\r\n    return html`\r\n      <div \r\n        class=\"list-wrapper\"\r\n        @touchstart=\"${this._handleTouchStart}\"\r\n        @touchmove=\"${this._handleTouchMove}\"\r\n        @touchend=\"${this._handleTouchEnd}\"\r\n        @pointerdown=\"${this._handlePointerDown}\"\r\n        @pointermove=\"${this._handlePointerMove}\"\r\n        @pointerup=\"${this._handlePointerUp}\"\r\n      >\r\n        <div \r\n          class=\"list ${enablePagination ? 'paginated' : ''} ${isSingleColumn ? 'single-column' : ''}\"\r\n          style=\"--jf-list-columns: ${columns}\"\r\n        >\r\n          ${visibleItems.map((item) => html`\r\n            <jellyha-media-item\r\n                .hass=${this.hass}\r\n                .config=${this._config}\r\n                .item=${item}\r\n                .layout=${'list'}\r\n                .isNextUpHighlight=${this._config.media_type === 'next_up' && item.id === this._mostRecentNextUpItemId}\r\n                @jellyha-action=${this._handleItemAction}\r\n            ></jellyha-media-item>\r\n          `)}\r\n        </div>\r\n        ${enablePagination && totalPages > 1\r\n        ? this._renderPagination(totalPages)\r\n        : nothing}\r\n      </div>\r\n    `;\r\n  }\r\n  /**\r\n   * Render grid with optional pagination\r\n   */\r\n  private _renderGrid(items: MediaItem[], enablePagination: boolean): TemplateResult {\r\n    const itemsPerPage = this._config.items_per_page || this._itemsPerPage;\r\n    const rawMaxPages = this._config.max_pages;\r\n    const maxPagesNum = rawMaxPages ? Number(rawMaxPages) : 0;\r\n    const effectiveMaxPages = (maxPagesNum > 0) ? maxPagesNum : Infinity;\r\n    const totalPages = Math.min(Math.ceil(items.length / itemsPerPage), effectiveMaxPages);\r\n\r\n    const startIdx = this._currentPage * itemsPerPage;\r\n    // For Infinite Scroll (no pagination), duplicate items ONLY if auto swipe is enabled\r\n    const shouldDuplicate = !enablePagination && (this._config.auto_swipe_interval || 0) > 0;\r\n    const visibleItems = enablePagination\r\n      ? items.slice(startIdx, startIdx + itemsPerPage)\r\n      : (shouldDuplicate ? [...items, ...items] : items);\r\n\r\n    const columns = this._config.columns || 1;\r\n    const isAutoColumns = columns === 1;\r\n    const isHorizontal = !enablePagination && (this._config.auto_swipe_interval || 0) > 0;\r\n\r\n    return html`\r\n      <div class=\"grid-outer\">\r\n        <div \r\n          class=\"grid-wrapper\"\r\n          @touchstart=\"${this._handleTouchStart}\"\r\n          @touchmove=\"${this._handleTouchMove}\"\r\n          @touchend=\"${this._handleTouchEnd}\"\r\n          @pointerdown=\"${this._handlePointerDown}\"\r\n          @pointermove=\"${this._handlePointerMove}\"\r\n          @pointerup=\"${this._handlePointerUp}\"\r\n          @scroll=\"${!enablePagination ? this._handleScroll : nothing}\"\r\n        >\r\n          <div\r\n            class=\"grid ${enablePagination ? 'paginated' : ''} ${isAutoColumns ? 'auto-columns' : ''} ${isHorizontal ? 'horizontal' : ''}\"\r\n            style=\"--jf-columns: ${columns}; --jf-grid-rows: ${columns}\"\r\n          >\r\n            ${visibleItems.map((item) => html`\r\n                <jellyha-media-item\r\n                    .hass=${this.hass}\r\n                    .config=${this._config}\r\n                    .item=${item}\r\n                    .layout=${'grid'}\r\n                    .isNextUpHighlight=${this._config.media_type === 'next_up' && item.id === this._mostRecentNextUpItemId}\r\n                    @jellyha-action=${this._handleItemAction}\r\n                ></jellyha-media-item>\r\n            `)}\r\n          </div>\r\n        </div>\r\n        ${enablePagination && totalPages > 1\r\n        ? this._renderPagination(totalPages)\r\n        : nothing}\r\n        ${!enablePagination ? this._renderScrollIndicator() : nothing}\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  /**\r\n   * Main Pagination Render Dispatcher\r\n   * Decides between standard and smart pagination based on page count\r\n   */\r\n  private _renderPagination(totalPages: number): TemplateResult {\r\n    if (this._config.show_pagination_dots === false) return html``;\r\n\r\n    // Hybrid Approach: Use standard simple dots for small counts\r\n    if (totalPages <= 5) {\r\n      return this._renderStandardPagination(totalPages);\r\n    }\r\n    // Use Smart Sliding Dots for larger counts\r\n    return this._renderSmartPagination(totalPages);\r\n  }\r\n\r\n  /**\r\n   * Render Standard Pagination (Existing Logic preserved)\r\n   */\r\n  private _renderStandardPagination(totalPages: number): TemplateResult {\r\n    return html`\r\n      <div class=\"pagination-dots\">\r\n        ${Array.from({ length: totalPages }, (_, i) => html`\r\n          <button\r\n            type=\"button\"\r\n            class=\"pagination-dot ${i === this._currentPage ? 'active' : ''}\"\r\n            data-page=\"${i}\"\r\n            @click=\"${this._onDotClick}\"\r\n            aria-label=\"${i === this._currentPage ? `Page ${i + 1}, current page` : `Go to page ${i + 1}`}\"\r\n            aria-current=\"${i === this._currentPage ? 'true' : 'false'}\"\r\n          ></button>\r\n        `)}\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  /**\r\n   * Render Smart Sliding Pagination (iOS Style)\r\n   */\r\n  private _renderSmartPagination(totalPages: number): TemplateResult {\r\n    const DOT_SIZE = 8; // width/height\r\n    const GAP = 8;      // gap\r\n    const VISIBLE_DOTS = 5;\r\n\r\n    // Calculate translate X to center the current page\r\n    // Window Width = (VISIBLE_DOTS * (DOT_SIZE + GAP)) - GAP\r\n    // 5 * 16 - 8 = 72px\r\n\r\n    // Center of Window = 72 / 2 = 36px\r\n    // Center of First Dot (Index 0) = DOT_SIZE/2 = 4px\r\n\r\n    // If Page 0 is active:\r\n    // We want Dot 0 center (4px) to be at Window Center (36px).\r\n    // Shift needed = 36 - 4 = 32px to the right.\r\n\r\n    // General Formula:\r\n    // Track Position = - (currentPage * (DOT_SIZE + GAP)) + CenterOffset\r\n    // CenterOffset = (WindowWidth / 2) - (DOT_SIZE / 2)\r\n\r\n    const singleDotSpace = DOT_SIZE + GAP;\r\n    const windowWidth = (VISIBLE_DOTS * singleDotSpace) - GAP;\r\n    const centerOffset = (windowWidth / 2) - (DOT_SIZE / 2);\r\n\r\n    const trackShift = -(this._currentPage * singleDotSpace) + centerOffset;\r\n\r\n    return html`\r\n      <div class=\"pagination-container smart\" style=\"width: ${windowWidth}px\">\r\n        <div \r\n          class=\"pagination-track\" \r\n          style=\"transform: translateX(${trackShift}px); width: ${totalPages * singleDotSpace}px\"\r\n        >\r\n          ${Array.from({ length: totalPages }, (_, i) => {\r\n      const distance = Math.abs(i - this._currentPage);\r\n      let classes = 'smart-dot';\r\n      if (i === this._currentPage) classes += ' active';\r\n      else if (distance > 2) classes += ' hidden'; // Hide far dots (> 2 steps away)\r\n      else if (distance === 2) classes += ' small'; // Edge dots (2 steps away)\r\n\r\n      return html`\r\n              <button\r\n                type=\"button\"\r\n                class=\"${classes}\"\r\n                data-page=\"${i}\"\r\n                @click=\"${this._onDotClick}\"\r\n                aria-label=\"${i === this._currentPage ? `Page ${i + 1} of ${totalPages}, current page` : `Go to page ${i + 1} of ${totalPages}`}\"\r\n                aria-current=\"${i === this._currentPage ? 'true' : 'false'}\"\r\n              ></button>\r\n            `;\r\n    })}\r\n        </div>\r\n      </div>\r\n    `;\r\n  }\r\n\r\n\r\n\r\n\r\n\r\n\r\n  /**\r\n   * Perform configured action\r\n   */\r\n  private _performAction(item: MediaItem, type: 'click' | 'hold' | 'double_tap'): void {\r\n    let action = 'none';\r\n\r\n    if (type === 'click') {\r\n      action = this._config.click_action || 'more-info';\r\n    } else if (type === 'hold') {\r\n      action = this._config.hold_action || 'jellyfin';\r\n    } else if (type === 'double_tap') {\r\n      action = this._config.double_tap_action || 'none';\r\n    }\r\n\r\n    switch (action) {\r\n      case 'jellyfin':\r\n        window.open(item.jellyfin_url, '_blank');\r\n        break;\r\n      case 'cast':\r\n        this._castMedia(item);\r\n        break;\r\n      case 'more-info':\r\n        this._showItemDetails(item);\r\n        break;\r\n      case 'trailer':\r\n        if (item.trailer_url) {\r\n          window.open(item.trailer_url, '_blank');\r\n        } else {\r\n          fireEvent(this, 'hass-notification', {\r\n            message: localize(this.hass.locale?.language || this.hass.language, 'no_trailer'),\r\n          });\r\n        }\r\n        break;\r\n      case 'none':\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n\r\n  private async _castMedia(item: MediaItem): Promise<void> {\r\n    const entityId = this._config.default_cast_device;\r\n    if (!entityId) {\r\n      console.warn('JellyHA: No default cast device configured');\r\n      return;\r\n    }\r\n    try {\r\n      await this.hass.callService('jellyha', 'play_on_chromecast', {\r\n        entity_id: entityId,\r\n        item_id: item.id,\r\n      });\r\n    } catch (err) {\r\n      console.error('JellyHA: Failed to cast media', err);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Render empty state\r\n   */\r\n  private _renderEmpty(): TemplateResult {\r\n    return html`\r\n      <div class=\"empty\">\r\n        <ha-icon icon=\"mdi:movie-open-outline\"></ha-icon>\r\n        <p>${localize(this.hass.locale?.language || this.hass.language, 'no_media')}</p>\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  /**\r\n   * Render error state\r\n   */\r\n  private _renderError(message: string): TemplateResult {\r\n    return html`\r\n      <ha-card>\r\n        <div class=\"error\">\r\n          <ha-icon icon=\"mdi:alert-circle\"></ha-icon>\r\n          <p>${message}</p>\r\n        </div>\r\n      </ha-card>\r\n    `;\r\n  }\r\n  private _showItemDetails(item: MediaItem): void {\r\n    if (this._modal) {\r\n      this._modal.showDialog({\r\n        item,\r\n        hass: this.hass,\r\n        defaultCastDevice: this._config.default_cast_device\r\n      });\r\n    }\r\n  }\r\n\r\n  private _handleSearchInput(e: Event): void {\r\n    const target = e.target as HTMLInputElement;\r\n    this._searchQuery = target.value;\r\n    this._currentPage = 0; // Reset to first page\r\n  }\r\n\r\n  private _handleGenreChange(e: Event): void {\r\n    const target = e.target as HTMLSelectElement;\r\n    this._searchGenre = target.value;\r\n    this._currentPage = 0; // Reset to first page\r\n  }\r\n\r\n  private _renderSearchBar(allItems: MediaItem[]): TemplateResult {\r\n    // Collect all unique genres from the current items (before filtering by search/genre)\r\n    // to populate the dropdown.\r\n    // Note: We should probably use 'this._items' (raw items) instead of filtered 'items' passed to renderLayout\r\n    // to ensure the genre list is complete.\r\n    const genres = new Set<string>();\r\n    (this._items || []).forEach(item => {\r\n      if (item.genres) {\r\n        item.genres.forEach(g => genres.add(g));\r\n      }\r\n    });\r\n    const sortedGenres = Array.from(genres).sort();\r\n\r\n    const lang = this.hass.locale?.language || this.hass.language;\r\n\r\n    return html`\r\n      <div class=\"search-container\">\r\n        <div class=\"search-input-wrapper\">\r\n          <ha-icon icon=\"mdi:magnify\" class=\"search-icon\"></ha-icon>\r\n          <input \r\n            type=\"text\" \r\n            class=\"search-input\" \r\n            placeholder=\"${localize(lang, 'search.placeholder_title')}\"\r\n            .value=\"${this._searchQuery}\"\r\n            @input=\"${this._handleSearchInput}\"\r\n          />\r\n          ${this._searchQuery ? html`\r\n            <button class=\"clear-search\" @click=\"${() => { this._searchQuery = ''; this._currentPage = 0; }}\">\r\n              <ha-icon icon=\"mdi:close\"></ha-icon>\r\n            </button>\r\n          ` : nothing}\r\n        </div>\r\n        \r\n        <div class=\"search-select-wrapper\">\r\n          <select class=\"search-select\" @change=\"${this._handleGenreChange}\" .value=\"${this._searchGenre}\">\r\n             <option value=\"\">${localize(lang, 'search.all_genres')}</option>\r\n             ${sortedGenres.map(genre => html`\r\n               <option value=\"${genre}\">${genre}</option>\r\n             `)}\r\n          </select>\r\n          <ha-icon icon=\"mdi:chevron-down\" class=\"select-icon\"></ha-icon>\r\n        </div>\r\n      </div>\r\n    `;\r\n  }\r\n}\r\n\r\ndeclare global {\r\n  interface HTMLElementTagNameMap {\r\n    'jellyha-library-card': JellyHALibraryCard;\r\n  }\r\n}\r\n\r\n","/**\r\n * Graphical editor for JellyHA Now Playing Card\r\n */\r\n\r\nimport { LitElement, html, TemplateResult, css } from 'lit';\r\nimport { customElement, property, state } from 'lit/decorators.js';\r\nimport { JellyHANowPlayingCardConfig, HomeAssistant } from '../shared/types';\r\nimport { localize } from '../shared/localize';\r\n\r\n// Helper function to fire events\r\nfunction fireEvent(\r\n  node: EventTarget,\r\n  type: string,\r\n  detail?: Record<string, unknown>\r\n): void {\r\n  const event = new CustomEvent(type, {\r\n    bubbles: true,\r\n    composed: true,\r\n    detail,\r\n  });\r\n  node.dispatchEvent(event);\r\n}\r\n\r\n@customElement('jellyha-now-playing-editor')\r\nexport class JellyHANowPlayingEditor extends LitElement {\r\n  @property({ attribute: false }) hass!: HomeAssistant;\r\n  @state() private _config!: JellyHANowPlayingCardConfig;\r\n\r\n  static styles = css`\r\n    .form-row {\r\n      margin-bottom: 16px;\r\n    }\r\n    .form-row ha-textfield,\r\n    .form-row ha-select,\r\n    .form-row ha-entity-picker,\r\n    .form-row ha-selector {\r\n      width: 100%;\r\n    }\r\n    .checkbox-row {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 8px;\r\n      margin-bottom: 8px;\r\n    }\r\n  `;\r\n\r\n  public setConfig(config: JellyHANowPlayingCardConfig): void {\r\n    this._config = config;\r\n  }\r\n\r\n  protected render(): TemplateResult {\r\n    if (!this.hass || !this._config) {\r\n      return html``;\r\n    }\r\n\r\n    // Filter for JellyHA Now Playing sensors\r\n    const nowPlayingSensors = Object.keys(this.hass.states).filter(\r\n      (entity) => entity.startsWith('sensor.jellyha_now_playing_')\r\n    );\r\n\r\n    const lang = this.hass.locale?.language || this.hass.language;\r\n\r\n    return html`\r\n      <div class=\"card-config\">\r\n        <div class=\"form-row\">\r\n          <ha-select\r\n            label=\"${localize(lang, 'editor.now_playing_sensor')}\"\r\n            .value=${this._config.entity || ''}\r\n            @selected=${this._entityChanged}\r\n            @closed=${(e: Event) => e.stopPropagation()}\r\n          >\r\n            ${nowPlayingSensors.map(\r\n      (entity) => html`\r\n                <mwc-list-item .value=${entity}>\r\n                  ${this.hass.states[entity].attributes.friendly_name || entity}\r\n                </mwc-list-item>\r\n              `\r\n    )}\r\n          </ha-select>\r\n        </div>\r\n\r\n        <div class=\"form-row\">\r\n          <ha-textfield\r\n            label=\"${localize(lang, 'editor.title')} (Optional)\"\r\n            .value=${this._config.title || ''}\r\n            @input=${this._titleChanged}\r\n          ></ha-textfield>\r\n        </div>\r\n\r\n        <div class=\"checkbox-row\">\r\n          <ha-switch\r\n            .checked=${this._config.show_title !== false}\r\n            @change=${this._showTitleChanged}\r\n          ></ha-switch>\r\n          <span>${localize(lang, 'editor.show_title')}</span>\r\n        </div>\r\n\r\n        <div class=\"checkbox-row\">\r\n          <ha-switch\r\n            .checked=${this._config.show_media_type_badge !== false}\r\n            @change=${this._showMediaTypeBadgeChanged}\r\n          ></ha-switch>\r\n          <span>${localize(lang, 'editor.show_media_type_badge')}</span>\r\n        </div>\r\n\r\n        <div class=\"checkbox-row\">\r\n          <ha-switch\r\n            .checked=${this._config.show_year !== false}\r\n            @change=${this._showYearChanged}\r\n          ></ha-switch>\r\n          <span>${localize(lang, 'editor.show_year')}</span>\r\n        </div>\r\n\r\n        <div class=\"checkbox-row\">\r\n          <ha-switch\r\n            .checked=${this._config.show_runtime === true}\r\n            @change=${this._showRuntimeChanged}\r\n          ></ha-switch>\r\n          <span>${localize(lang, 'editor.show_runtime')}</span>\r\n        </div>\r\n\r\n        <div class=\"checkbox-row\">\r\n          <ha-switch\r\n            .checked=${this._config.show_ratings === true}\r\n            @change=${this._showRatingsChanged}\r\n          ></ha-switch>\r\n          <span>${localize(lang, 'editor.show_rating')}</span>\r\n        </div>\r\n\r\n        <div class=\"checkbox-row\">\r\n          <ha-switch\r\n            .checked=${this._config.show_genres === true}\r\n            @change=${this._showGenresChanged}\r\n          ></ha-switch>\r\n          <span>${localize(lang, 'editor.show_genres')}</span>\r\n        </div>\r\n\r\n        <div class=\"checkbox-row\">\r\n          <ha-switch\r\n            .checked=${this._config.show_client !== false}\r\n            @change=${this._showClientChanged}\r\n          ></ha-switch>\r\n          <span>${localize(lang, 'editor.show_client')}</span>\r\n        </div>\r\n\r\n        <div class=\"checkbox-row\">\r\n          <ha-switch\r\n            .checked=${this._config.show_background === true}\r\n            @change=${this._showBackgroundChanged}\r\n          ></ha-switch>\r\n          <span>${localize(lang, 'editor.show_background')}</span>\r\n        </div>\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  private _entityChanged(e: Event): void {\r\n    const target = e.target as HTMLSelectElement;\r\n    this._updateConfig('entity', target.value);\r\n  }\r\n\r\n  private _titleChanged(e: Event): void {\r\n    const target = e.target as HTMLInputElement;\r\n    this._updateConfig('title', target.value);\r\n  }\r\n\r\n  private _showTitleChanged(e: Event): void {\r\n    const target = e.target as HTMLInputElement;\r\n    this._updateConfig('show_title', target.checked);\r\n  }\r\n\r\n  private _showMediaTypeBadgeChanged(e: Event): void {\r\n    const target = e.target as HTMLInputElement;\r\n    this._updateConfig('show_media_type_badge', target.checked);\r\n  }\r\n\r\n  private _showRatingsChanged(e: Event): void {\r\n    const target = e.target as HTMLInputElement;\r\n    this._updateConfig('show_ratings', target.checked);\r\n  }\r\n\r\n  private _showRuntimeChanged(e: Event): void {\r\n    const target = e.target as HTMLInputElement;\r\n    this._updateConfig('show_runtime', target.checked);\r\n  }\r\n\r\n  private _showGenresChanged(e: Event): void {\r\n    const target = e.target as HTMLInputElement;\r\n    this._updateConfig('show_genres', target.checked);\r\n  }\r\n\r\n  private _showYearChanged(e: Event): void {\r\n    const target = e.target as HTMLInputElement;\r\n    this._updateConfig('show_year', target.checked);\r\n  }\r\n\r\n  private _showClientChanged(e: Event): void {\r\n    const target = e.target as HTMLInputElement;\r\n    this._updateConfig('show_client', target.checked);\r\n  }\r\n\r\n  private _showBackgroundChanged(e: Event): void {\r\n    const target = e.target as HTMLInputElement;\r\n    this._updateConfig('show_background', target.checked);\r\n  }\r\n\r\n  private _updateConfig(key: string, value: unknown): void {\r\n    if (!this._config) {\r\n      return;\r\n    }\r\n\r\n    const newConfig = { ...this._config, [key]: value };\r\n    this._config = newConfig;\r\n\r\n    fireEvent(this as unknown as EventTarget, 'config-changed', { config: newConfig });\r\n  }\r\n}\r\n\r\ndeclare global {\r\n  interface HTMLElementTagNameMap {\r\n    'jellyha-now-playing-editor': JellyHANowPlayingEditor;\r\n  }\r\n}\r\n","import { LitElement, html, TemplateResult, css, PropertyValues, nothing } from 'lit';\r\nimport { customElement, property, state } from 'lit/decorators.js';\r\nimport {\r\n    HomeAssistant,\r\n    JellyHANowPlayingCardConfig,\r\n    NowPlayingSensorData\r\n} from '../shared/types';\r\nimport { localize } from '../shared/localize';\r\nimport { formatRuntime, addImageParams } from '../shared/utils';\r\n\r\n// Import editor for side effects\r\nimport '../editors/jellyha-now-playing-editor';\r\n\r\nimport '../editors/jellyha-now-playing-editor';\r\n\r\n// Register card in the custom cards array\r\nwindow.customCards = window.customCards || [];\r\nwindow.customCards.push({\r\n    type: 'jellyha-now-playing-card',\r\n    name: 'JellyHA Now Playing',\r\n    description: 'Display currently playing media from Jellyfin',\r\n    preview: true,\r\n});\r\n\r\n@customElement('jellyha-now-playing-card')\r\nexport class JellyHANowPlayingCard extends LitElement {\r\n    @property({ attribute: false }) public hass!: HomeAssistant;\r\n    @state() private _config!: JellyHANowPlayingCardConfig;\r\n    @state() private _rewindActive: boolean = false;\r\n    @state() private _overflowState: number = 0; // 0=All, 1=Hide Genres, 2=Hide Meta\r\n    private _resizeObserver?: ResizeObserver;\r\n\r\n    // Cache backdrop URL to prevent flicker on every update\r\n    private _cachedBackdropUrl: string | undefined;\r\n    private _cachedItemId: string | undefined;\r\n\r\n    public setConfig(config: JellyHANowPlayingCardConfig): void {\r\n        this._config = {\r\n            show_title: true,\r\n            show_media_type_badge: true,\r\n            show_year: true,\r\n            show_client: true,\r\n            show_background: true,\r\n            show_genres: true,\r\n            show_ratings: true,\r\n            show_runtime: true,\r\n            ...config,\r\n        };\r\n    }\r\n\r\n    public static getConfigElement(): HTMLElement {\r\n        return document.createElement('jellyha-now-playing-editor');\r\n    }\r\n\r\n    public static getStubConfig(hass: HomeAssistant): Partial<JellyHANowPlayingCardConfig> {\r\n        const entities = Object.keys(hass.states);\r\n        const entity = entities.find((e) => e.startsWith('sensor.jellyha_now_playing_')) || '';\r\n        return {\r\n            entity,\r\n            show_title: true,\r\n            show_media_type_badge: true,\r\n            show_year: true,\r\n            show_client: true,\r\n            show_background: true,\r\n            show_genres: true,\r\n            show_ratings: true,\r\n            show_runtime: true,\r\n        };\r\n    }\r\n\r\n    public getCardSize(): number {\r\n        return 3;\r\n    }\r\n\r\n    public getLayoutOptions() {\r\n        return {\r\n            grid_rows: 3,\r\n            grid_columns: 12,\r\n        };\r\n    }\r\n\r\n    public getGridOptions() {\r\n        return {\r\n            columns: 12,\r\n            rows: 3,\r\n            min_columns: 6,\r\n            min_rows: 3,\r\n            max_rows: 5\r\n        };\r\n    }\r\n\r\n    protected render(): TemplateResult {\r\n        if (!this.hass || !this._config) {\r\n            return html``;\r\n        }\r\n\r\n        const entityId = this._config.entity;\r\n        if (!entityId) {\r\n            return this._renderError('Please configure a JellyHA Now Playing sensor entity');\r\n        }\r\n\r\n        const stateObj = this.hass.states[entityId];\r\n        if (!stateObj) {\r\n            return this._renderError(localize(this.hass.locale?.language || this.hass.language, 'entity_not_found') || 'Entity not found');\r\n        }\r\n\r\n        const attributes = stateObj.attributes as unknown as NowPlayingSensorData;\r\n        const isPlaying = !!attributes.item_id;\r\n\r\n        if (!isPlaying) {\r\n            return this._renderEmpty();\r\n        }\r\n\r\n        const progressPercent = attributes.progress_percent || 0;\r\n        const imageUrl = attributes.image_url;\r\n\r\n        // Cache backdrop URL to prevent flicker - only update when item changes\r\n        const currentItemId = attributes.item_id;\r\n        if (currentItemId !== this._cachedItemId) {\r\n            this._cachedItemId = currentItemId;\r\n            const rawBackdropUrl = attributes.backdrop_url || attributes.image_url;\r\n            this._cachedBackdropUrl = rawBackdropUrl ? addImageParams(rawBackdropUrl, 640) : undefined;\r\n        }\r\n\r\n        const backdropUrl = this._cachedBackdropUrl;\r\n        const showBackground = this._config.show_background && backdropUrl;\r\n        const isPaused = attributes.is_paused;\r\n\r\n        return html`\r\n            <ha-card class=\"jellyha-now-playing ${showBackground ? 'has-background' : ''} ${this._config.title ? 'has-title' : ''}\">\r\n                ${showBackground ? html`\r\n                    <div class=\"card-background\" style=\"background-image: url('${backdropUrl}')\"></div>\r\n                    <div class=\"card-overlay\"></div>\r\n                ` : nothing}\r\n                \r\n                <div class=\"card-content\">\r\n                    ${this._config.title ? html`\r\n                        <div class=\"card-header\">${this._config.title}</div>\r\n                    ` : nothing}\r\n                    \r\n                    <div class=\"main-container\">\r\n                        ${imageUrl ? html`\r\n                            <div class=\"poster-container\" @click=${this._handlePosterRewind}>\r\n                                <img src=\"${addImageParams(imageUrl, 160)}\" alt=\"${attributes.title}\" loading=\"eager\" fetchpriority=\"high\" />\r\n                                ${this._rewindActive ? html`\r\n                                    <div class=\"rewind-overlay\">\r\n                                        <span>${localize(this.hass.locale?.language || this.hass.language, 'rewinding')}</span>\r\n                                    </div>\r\n                                ` : nothing}\r\n                            </div>\r\n                        ` : nothing}\r\n                        \r\n                        <div class=\"info-container\">\r\n                            <div class=\"info-top\">\r\n                                <div class=\"header\">\r\n                                    ${this._config.show_title !== false ? html`<div class=\"title\">${attributes.title}</div>` : nothing}\r\n                                    ${attributes.series_title ? html`<div class=\"series\">${attributes.series_title}</div>` : nothing}\r\n                                    ${this._config.show_client !== false ? html`\r\n                                        <div class=\"device-info\">\r\n                                            <span>${attributes.device_name} (${attributes.client})</span>\r\n                                        </div>\r\n                                    ` : nothing}\r\n                                </div>\r\n\r\n                                ${this._overflowState < 2 ? html`\r\n                                    <div class=\"meta-container\">\r\n                                        ${this._config.show_media_type_badge !== false ? html`\r\n                                            <span class=\"badge meta-priority-4 ${attributes.media_type?.toLowerCase()}\">\r\n                                                ${(attributes.media_type?.toLowerCase() === 'episode' && attributes.season !== undefined && attributes.episode !== undefined)\r\n                        ? `S${String(attributes.season).padStart(2, '0')}E${String(attributes.episode).padStart(2, '0')}`\r\n                        : attributes.media_type}\r\n                                            </span>\r\n                                        ` : nothing}\r\n                                        ${this._config.show_year !== false && attributes.year ? html`\r\n                                            <span class=\"meta-item meta-priority-3\">${attributes.year}</span>\r\n                                        ` : nothing}\r\n                                        ${this._config.show_runtime && attributes.runtime_minutes ? html`\r\n                                            <span class=\"meta-item meta-priority-2\">${formatRuntime(attributes.runtime_minutes)}</span>\r\n                                        ` : nothing}\r\n                                        ${this._config.show_ratings && attributes.community_rating ? html`\r\n                                            <span class=\"meta-item external-rating meta-priority-1\">\r\n                                                <ha-icon icon=\"mdi:star\"></ha-icon>\r\n                                                <span>${attributes.community_rating.toFixed(1)}</span>\r\n                                            </span>\r\n                                        ` : nothing}\r\n                                    </div>\r\n                                ` : nothing}\r\n\r\n                                ${this._overflowState < 1 && this._config.show_genres && attributes.genres?.length ? html`\r\n                                    <div class=\"genres-container meta-priority-0\">\r\n                                        <div class=\"genres\">${attributes.genres.join(', ')}</div>\r\n                                    </div>\r\n                                ` : nothing}\r\n                            </div>\r\n\r\n                            <div class=\"info-bottom\">\r\n                                <div class=\"controls-container\">\r\n                                    ${this._config.show_client !== false ? html`\r\n                                        <div class=\"device-info bottom-device-info\">\r\n                                            <span>${attributes.device_name} (${attributes.client})</span>\r\n                                        </div>\r\n                                    ` : nothing}\r\n\r\n                                    <div class=\"playback-controls\">\r\n                                                                    ${this._rewindActive ? html`\r\n                                            <ha-icon-button class=\"spinning\" .label=${localize(this.hass.locale?.language || this.hass.language, 'loading')}>\r\n                                                <ha-icon icon=\"mdi:loading\"></ha-icon>\r\n                                            </ha-icon-button>\r\n                                        ` : isPaused ? html`\r\n                                            <ha-icon-button .label=${localize(this.hass.locale?.language || this.hass.language, 'play')} @click=${() => this._handleControl('Unpause')}>\r\n                                                <ha-icon icon=\"mdi:play\"></ha-icon>\r\n                                            </ha-icon-button>\r\n                                        ` : html`\r\n                                            <ha-icon-button .label=${localize(this.hass.locale?.language || this.hass.language, 'pause')} @click=${() => this._handleControl('Pause')}>\r\n                                                <ha-icon icon=\"mdi:pause\"></ha-icon>\r\n                                            </ha-icon-button>\r\n                                        `}\r\n                                        <ha-icon-button .label=${localize(this.hass.locale?.language || this.hass.language, 'stop')} @click=${() => this._handleControl('Stop')}>\r\n                                            <ha-icon icon=\"mdi:stop\"></ha-icon>\r\n                                        </ha-icon-button>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div class=\"progress-container\" @click=${this._handleSeek}>\r\n                                    <div class=\"progress-bar\">\r\n                                        <div class=\"progress-fill\" style=\"width: ${progressPercent}%\"></div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </ha-card>\r\n        `;\r\n    }\r\n\r\n    private _phrases: string[] = [];\r\n\r\n    private async _fetchPhrases(): Promise<void> {\r\n        if (this._phrases.length > 0) return;\r\n        try {\r\n            const response = await fetch('/jellyha_static/phrases.json');\r\n            if (response.ok) {\r\n                this._phrases = await response.json();\r\n            }\r\n        } catch (e) {\r\n            console.warn('JellyHA: Could not fetch phrases.json', e);\r\n        }\r\n    }\r\n\r\n    private _renderEmpty(): TemplateResult {\r\n        this._fetchPhrases(); // Trigger async fetch\r\n\r\n        const isDarkMode = this.hass.themes?.darkMode;\r\n        const logoUrl = isDarkMode\r\n            ? 'https://raw.githubusercontent.com/home-assistant/brands/master/custom_integrations/jellyha/dark_logo.png'\r\n            : 'https://raw.githubusercontent.com/home-assistant/brands/master/custom_integrations/jellyha/logo.png';\r\n        const iconUrl = 'https://raw.githubusercontent.com/home-assistant/brands/master/custom_integrations/jellyha/icon.png';\r\n\r\n        let phrase = localize(this.hass.locale?.language || this.hass.language, 'nothing_playing');\r\n\r\n        if (this._phrases.length > 0) {\r\n            const daySeed = Math.floor(Date.now() / (1000 * 60 * 60 * 24));\r\n            const phraseIndex = daySeed % this._phrases.length;\r\n            phrase = this._phrases[phraseIndex];\r\n\r\n            // Get unwatched number - look for any sensor ending in _unwatched\r\n            const unwatchedSensor = Object.keys(this.hass.states).find(e => e.startsWith('sensor.') && e.endsWith('_unwatched'));\r\n            const count = unwatchedSensor ? this.hass.states[unwatchedSensor].state : \"0\";\r\n\r\n            phrase = phrase.replace(/\\[number\\]/g, count);\r\n        }\r\n\r\n        return html`\r\n            <ha-card class=\"jellyha-now-playing empty-state\">\r\n                <div class=\"card-content\">\r\n                    <div class=\"logo-container full-logo\">\r\n                        <img src=\"${logoUrl}\" alt=\"JellyHA Logo\" />\r\n                    </div>\r\n                    <div class=\"logo-container mini-icon\">\r\n                        <img src=\"${iconUrl}\" alt=\"JellyHA Icon\" />\r\n                    </div>\r\n                    <p>${phrase}</p>\r\n                </div>\r\n            </ha-card>\r\n        `;\r\n    }\r\n\r\n    private _renderError(error: string): TemplateResult {\r\n        return html`\r\n            <ha-card class=\"error-state\">\r\n                <div class=\"card-content\">\r\n                    <p>${error}</p>\r\n                </div>\r\n            </ha-card>\r\n        `;\r\n    }\r\n\r\n    private async _handleControl(command: string): Promise<void> {\r\n        const stateObj = this.hass.states[this._config.entity];\r\n        const sessionId = stateObj?.attributes.session_id;\r\n\r\n        if (!sessionId) return;\r\n\r\n        await this.hass.callService('jellyha', 'session_control', {\r\n            session_id: sessionId,\r\n            command: command\r\n        });\r\n    }\r\n\r\n    private async _handleSeek(e: MouseEvent): Promise<void> {\r\n        const rect = (e.currentTarget as HTMLElement).getBoundingClientRect();\r\n        const percent = (e.clientX - rect.left) / rect.width;\r\n\r\n        const stateObj = this.hass.states[this._config.entity];\r\n        if (!stateObj) return;\r\n\r\n        const attributes = stateObj.attributes as unknown as NowPlayingSensorData;\r\n        const sessionId = attributes.session_id;\r\n        const positionTicks = attributes.position_ticks || 0;\r\n        const progressPercent = attributes.progress_percent || 1;\r\n        const durationTicks = (positionTicks / progressPercent) * 100;\r\n\r\n        if (!sessionId || !durationTicks) return;\r\n\r\n        const seekTicks = Math.round(durationTicks * percent);\r\n\r\n        await this.hass.callService('jellyha', 'session_seek', {\r\n            session_id: sessionId,\r\n            position_ticks: seekTicks\r\n        });\r\n    }\r\n\r\n    private async _handlePosterRewind(): Promise<void> {\r\n        const stateObj = this.hass.states[this._config.entity];\r\n        if (!stateObj) return;\r\n\r\n        const attributes = stateObj.attributes as unknown as NowPlayingSensorData;\r\n        const sessionId = attributes.session_id;\r\n        const positionTicks = attributes.position_ticks || 0;\r\n\r\n        if (!sessionId) return;\r\n\r\n        // Visual feedback\r\n        this._rewindActive = true;\r\n        setTimeout(() => {\r\n            this._rewindActive = false;\r\n        }, 1000);\r\n\r\n        // Haptic feedback\r\n        const event = new CustomEvent('haptic', {\r\n            detail: 'selection',\r\n            bubbles: true,\r\n            composed: true,\r\n        });\r\n        this.dispatchEvent(event);\r\n\r\n        // Calculate rewind position (20 seconds = 200,000,000 ticks)\r\n        const rewindTicks = 20 * 10000000; // 20 seconds in ticks\r\n        const newPositionTicks = Math.max(0, positionTicks - rewindTicks);\r\n\r\n        await this.hass.callService('jellyha', 'session_seek', {\r\n            session_id: sessionId,\r\n            position_ticks: newPositionTicks\r\n        });\r\n    }\r\n\r\n    public connectedCallback(): void {\r\n        super.connectedCallback();\r\n        this._resizeObserver = new ResizeObserver(() => {\r\n            this._checkLayout();\r\n        });\r\n        this._resizeObserver.observe(this);\r\n    }\r\n\r\n    public disconnectedCallback(): void {\r\n        super.disconnectedCallback();\r\n        if (this._resizeObserver) {\r\n            this._resizeObserver.disconnect();\r\n        }\r\n    }\r\n\r\n    protected updated(changedProps: PropertyValues): void {\r\n        super.updated(changedProps);\r\n        if (changedProps.has('hass')) {\r\n            this._checkLayout();\r\n        }\r\n    }\r\n\r\n    private _checkLayout(): void {\r\n        // Use requestAnimationFrame to ensure DOM is rendered\r\n        requestAnimationFrame(() => {\r\n            this._doLayoutCheck();\r\n        });\r\n    }\r\n\r\n    private _doLayoutCheck(): void {\r\n        const titleEl = this.shadowRoot?.querySelector('.title') as HTMLElement;\r\n        const bottomEl = this.shadowRoot?.querySelector('.info-bottom') as HTMLElement;\r\n\r\n        if (!titleEl || !bottomEl) return;\r\n\r\n        const cardRect = this.getBoundingClientRect();\r\n        const titleRect = titleEl.getBoundingClientRect();\r\n        const bottomRect = bottomEl.getBoundingClientRect();\r\n\r\n        // Calculate dynamic threshold based on where controls actually start\r\n        const bottomSectionTop = bottomRect.top - cardRect.top;\r\n\r\n        // Add a small buffer to ensure visual separation\r\n        const SAFE_THRESHOLD = bottomSectionTop - 8;\r\n\r\n        // Estimated heights\r\n        const PROJECTED_META_HEIGHT = 28;\r\n        const PROJECTED_GENRE_HEIGHT = 22;\r\n\r\n        const titleBottomRel = titleRect.bottom - cardRect.top;\r\n\r\n        const projectedMetaBottom = titleBottomRel + PROJECTED_META_HEIGHT;\r\n        const projectedGenreBottom = projectedMetaBottom + PROJECTED_GENRE_HEIGHT;\r\n\r\n        let newState = 0;\r\n\r\n        // Check Logic (Applies to ALL card sizes):\r\n        if (projectedGenreBottom > SAFE_THRESHOLD) {\r\n            newState = 1; // Hide Genre\r\n        }\r\n\r\n        // If even meta row overlaps, hide it too\r\n        if (projectedMetaBottom > SAFE_THRESHOLD) {\r\n            newState = 2; // Hide Meta + Genre\r\n        }\r\n\r\n        if (this._overflowState !== newState) {\r\n            this._overflowState = newState;\r\n        }\r\n    }\r\n\r\n    static styles = css`\r\n        :host {\r\n            display: block;\r\n            height: 100%;\r\n            width: 100%;\r\n            background: none !important;\r\n            position: relative;\r\n            z-index: 2; /* Now playing should be slightly above library to avoid its shadow bleed */\r\n        }\r\n        ha-card {\r\n            height: 100%;\r\n            overflow: hidden;\r\n            position: relative;\r\n            background: var(--ha-card-background, var(--card-background-color, #fff));\r\n            border-radius: var(--ha-card-border-radius, 12px);\r\n            box-shadow: var(--ha-card-box-shadow, none);\r\n            border: var(--ha-card-border, 1px solid var(--ha-card-border-color, var(--divider-color, #e0e0e0)));\r\n            transition: all 0.3s ease-out;\r\n            container-type: size;\r\n            container-name: now-playing;\r\n            display: flex;\r\n            flex-direction: column;\r\n            box-sizing: border-box;\r\n            min-height: 0;\r\n            padding: 0;\r\n            width: 100%;\r\n            margin: 0;\r\n        }\r\n\r\n        .jellyha-now-playing {\r\n            /* Inherits from ha-card, additional unique classes can go here if needed */\r\n        }\r\n        .jellyha-now-playing.has-background {\r\n            background: transparent;\r\n            color: white;\r\n        }\r\n        .jellyha-now-playing.has-background .title,\r\n        .jellyha-now-playing.has-background .series,\r\n        .jellyha-now-playing.has-background .device-info,\r\n        .jellyha-now-playing.has-background .meta-item,\r\n        .jellyha-now-playing.has-background .genres,\r\n        .jellyha-now-playing.has-background .card-header,\r\n        .jellyha-now-playing.has-background ha-icon-button {\r\n            color: #fff !important;\r\n            text-shadow: 0 1px 4px rgba(0,0,0,0.5);\r\n        }\r\n        .jellyha-now-playing.has-background .badge {\r\n            box-shadow: 0 2px 4px rgba(0,0,0,0.3);\r\n        }\r\n        .jellyha-now-playing.has-background .playback-controls ha-icon-button {\r\n            background: rgba(255, 255, 255, 0.15);\r\n        }\r\n        .jellyha-now-playing.has-background .playback-controls ha-icon-button:hover {\r\n            background: rgba(255, 255, 255, 0.25);\r\n        }\r\n        /* Further increase padding when background is on for better balance */\r\n        .jellyha-now-playing.has-background .card-content {\r\n            padding: 24px 20px 12px !important;\r\n        }\r\n        .card-background {\r\n            position: absolute;\r\n            top: 0;\r\n            left: 0;\r\n            width: 100%;\r\n            height: 100%;\r\n            background-size: cover;\r\n            background-position: center;\r\n            filter: blur(5px) brightness(0.6);\r\n            transform: scale(1.02);\r\n            z-index: 0;\r\n            transition: background-image 0.5s ease-in-out;\r\n        }\r\n        .card-overlay {\r\n            position: absolute;\r\n            top: 0;\r\n            left: 0;\r\n            width: 100%;\r\n            height: 100%;\r\n            background: linear-gradient(to bottom, rgba(0,0,0,0.2) 0%, rgba(0,0,0,0.6) 100%);\r\n            z-index: 1;\r\n        }\r\n        .card-content {\r\n            position: relative;\r\n            z-index: 2;\r\n            padding: 20px !important;\r\n            display: flex;\r\n            flex-direction: column;\r\n            gap: 16px;\r\n            height: 100%;\r\n            box-sizing: border-box;\r\n            overflow: visible; /* Allow poster pop-out */\r\n        }\r\n        .card-header {\r\n            font-size: 1.25rem;\r\n            font-weight: 500;\r\n            color: var(--primary-text-color);\r\n            line-height: 1.2;\r\n            flex: 0 0 auto;\r\n        }\r\n        .main-container {\r\n            display: flex;\r\n            gap: 20px;\r\n            align-items: flex-start;\r\n            flex: 1;\r\n            min-height: 0; /* Crucial for nested flex scrolling/hiding */\r\n            overflow: visible;\r\n        }\r\n        .poster-container {\r\n            flex: 0 0 auto;\r\n            height: 100%;\r\n            aspect-ratio: 2 / 3;\r\n            max-height: 100%;\r\n            border-radius: 8px;\r\n            overflow: hidden;\r\n            box-shadow: 0 8px 16px rgba(0,0,0,0.4);\r\n            transition: transform 0.2s ease-in-out;\r\n            position: relative;\r\n            cursor: pointer;\r\n        }\r\n        .poster-container:hover {\r\n            transform: scale(1.02);\r\n        }\r\n        .poster-container img {\r\n            width: 100%;\r\n            height: 100%;\r\n            object-fit: cover;\r\n        }\r\n        .rewind-overlay {\r\n            position: absolute;\r\n            top: 0;\r\n            left: 0;\r\n            width: 100%;\r\n            height: 100%;\r\n            background: rgba(0, 0, 0, 0.4);\r\n            display: flex;\r\n            align-items: center;\r\n            justify-content: center;\r\n            z-index: 10;\r\n            animation: fadeIn 0.2s ease-out;\r\n        }\r\n        .rewind-overlay span {\r\n            color: white;\r\n            font-weight: 700;\r\n            font-size: 0.8rem; /* Small fixed size */\r\n            letter-spacing: 0.5px;\r\n            background: var(--primary-color);\r\n            padding: 2px 6px;\r\n            border-radius: 4px;\r\n            box-shadow: 0 2px 4px rgba(0,0,0,0.3);\r\n            transform: translateY(-8px);\r\n            white-space: nowrap; /* Prevent wrapping */\r\n        }\r\n        @keyframes fadeIn {\r\n            from { opacity: 0; }\r\n            to { opacity: 1; }\r\n        }\r\n        @keyframes spin {\r\n            from { transform: rotate(0deg); }\r\n            to { transform: rotate(360deg); }\r\n        }\r\n        .playback-controls .spinning ha-icon {\r\n            animation: spin 1s linear infinite;\r\n        }\r\n        .info-container {\r\n            flex: 1;\r\n            display: flex;\r\n            flex-direction: column;\r\n            height: 100%;\r\n            min-height: 0; /* Crucial */\r\n            min-width: 0;\r\n            overflow: hidden;\r\n        }\r\n        .info-top {\r\n            flex: 1 1 auto; /* Can shrink and grow */\r\n            min-height: 0; /* Allows shrinking below content size */\r\n            overflow: visible; /* Hide overflow content */\r\n            display: flex;\r\n            flex-direction: column;\r\n            margin-bottom: 0;\r\n            padding-bottom: 4px; /* Prevent text clipping at bottom */\r\n        }\r\n        .header {\r\n            margin-bottom: 0px;\r\n            flex-shrink: 0; /* Don't squash the title too easily if possible */\r\n        }\r\n        .title {\r\n            font-size: 1.4rem;\r\n            font-weight: 700;\r\n            line-height: 1.2;\r\n            color: var(--primary-text-color);\r\n            margin-bottom: 2px;\r\n        }\r\n        .series {\r\n            font-size: 1.1rem;\r\n            color: var(--secondary-text-color);\r\n            font-weight: 500;\r\n        }\r\n        .device-info {\r\n            display: flex;\r\n            align-items: center;\r\n            gap: 6px;\r\n            font-size: 0.95rem;\r\n            color: var(--secondary-text-color);\r\n            margin-top: 8px;\r\n            opacity: 0.8;\r\n        }\r\n        .device-info ha-icon {\r\n            --mdc-icon-size: 18px;\r\n        }\r\n        .meta-container {\r\n            display: flex;\r\n            flex-wrap: nowrap;\r\n            gap: 12px;\r\n            align-items: center;\r\n            white-space: nowrap;\r\n        }\r\n\r\n        .bottom-device-info {\r\n            display: flex;\r\n            align-items: center;\r\n            gap: 6px;\r\n            font-size: 0.8rem;\r\n            color: var(--secondary-text-color);\r\n            margin-right: auto; /* Push controls to right */\r\n            opacity: 0.8;\r\n        }\r\n\r\n        /* Default: Hide top device info, show bottom device info */\r\n        .info-top .device-info {\r\n            display: none;\r\n        }\r\n        \r\n        /* Ensure controls spread out when bottom info is present */\r\n        .controls-container {\r\n            justify-content: space-between;\r\n            align-items: center;\r\n        }\r\n        \r\n        /* When card is too narrow, HIDE bottom device info to prevent crowding */\r\n        @container now-playing (max-width: 350px) {\r\n            .bottom-device-info {\r\n                display: none !important;\r\n            }\r\n            .controls-container {\r\n                justify-content: flex-end; /* Revert to right align */\r\n            }\r\n        }\r\n        \r\n        /* For 5+ row cards, hide device info sooner to prevent overflow */\r\n        @container now-playing (min-height: 300px) and (max-width: 430px) {\r\n            .bottom-device-info {\r\n                display: none !important;\r\n            }\r\n        }\r\n        \r\n        /* Progressive metadata hiding based on priority */\r\n        /* Hide genres first (priority 0) */\r\n        @container now-playing (max-width: 400px) {\r\n            .meta-priority-0 {\r\n                display: none !important;\r\n            }\r\n        }\r\n        \r\n        /* Hide rating (priority 1) */\r\n        @container now-playing (max-width: 370px) {\r\n            .meta-priority-1 {\r\n                display: none !important;\r\n            }\r\n        }\r\n        \r\n        /* Hide runtime (priority 2) */\r\n        @container now-playing (max-width: 320px) {\r\n            .meta-priority-2 {\r\n                display: none !important;\r\n            }\r\n        }\r\n        \r\n        /* Hide year (priority 3) */\r\n        @container now-playing (max-width: 260px) {\r\n            .meta-priority-3 {\r\n                display: none !important;\r\n            }\r\n        }\r\n        \r\n        /* Hide badge last (priority 4) - only in ultra-compact mode */\r\n        @container now-playing (max-width: 220px) {\r\n            .meta-priority-4 {\r\n                display: none !important;\r\n            }\r\n        }\r\n        \r\n        /* Hide badge when card has title AND is short AND narrow (3 rows  6 columns) to prevent overlap with controls */\r\n        .has-title .meta-priority-4 {\r\n            /* Default: show the badge */\r\n        }\r\n        @container now-playing (max-height: 180px) and (max-width: 320px) {\r\n            .has-title .meta-priority-4 {\r\n                display: none !important;\r\n            }\r\n        }\r\n\r\n        /* When card is tall enough (4+ rows  240px), enable wrapping instead of hiding */\r\n        @container now-playing (min-height: 240px) {\r\n            .meta-container {\r\n                flex-wrap: wrap;\r\n                white-space: normal;\r\n            }\r\n            .info-top {\r\n                overflow: visible;\r\n            }\r\n        }\r\n        \r\n        /* When tall AND narrow, show items that would normally hide (they'll wrap instead) */\r\n        @container now-playing (min-height: 240px) and (max-width: 400px) {\r\n            .meta-priority-0 {\r\n                display: block !important;\r\n            }\r\n        }\r\n        @container now-playing (min-height: 240px) and (max-width: 370px) {\r\n            .meta-priority-1 {\r\n                display: flex !important;\r\n            }\r\n        }\r\n        @container now-playing (min-height: 240px) and (max-width: 320px) {\r\n            .meta-priority-2 {\r\n                display: flex !important;\r\n            }\r\n        }\r\n        @container now-playing (min-height: 240px) and (max-width: 260px) {\r\n            .meta-priority-3 {\r\n                display: flex !important;\r\n            }\r\n        }\r\n        .badge {\r\n            padding: 2px 8px 1px 8px;\r\n            border-radius: 4px;\r\n            font-size: 0.75rem;\r\n            font-weight: 800;\r\n            background: var(--primary-color);\r\n            color: white;\r\n            text-transform: uppercase;\r\n            letter-spacing: 0.5px;\r\n            flex-shrink: 0; /* Prevent badge from shrinking */\r\n            overflow: visible; /* Ensure rounded corners aren't clipped */\r\n        }\r\n        .badge.movie { background-color: #AA5CC3; }\r\n        .badge.series { background-color: #F2A218; }\r\n        .badge.episode { background-color: #F59E0B; }\r\n\r\n        .meta-item {\r\n            color: var(--secondary-text-color);\r\n            font-size: 0.9rem;\r\n            font-weight: 500;\r\n        }\r\n        .meta-item.external-rating {\r\n            display: flex;\r\n            align-items: center;\r\n            gap: 4px;\r\n        }\r\n        .meta-item.external-rating ha-icon {\r\n            --mdc-icon-size: 14px;\r\n            color: #F59E0B;\r\n        }\r\n        .genres-container {\r\n            flex-shrink: 0;\r\n            overflow: visible;\r\n            margin-bottom: -4px;\r\n            position: relative;\r\n            z-index: 4; /* Ensure it stays above other elements if needed */\r\n        }\r\n        .genres {\r\n            font-size: 0.95rem;\r\n            color: var(--secondary-text-color);\r\n            margin: 0;\r\n            font-style: italic;\r\n            opacity: 0.7;\r\n            white-space: nowrap;\r\n            text-overflow: ellipsis;\r\n            overflow: hidden;\r\n        }\r\n        .info-bottom {\r\n            flex: 0 0 auto; /* Never shrink */\r\n            width: 100%;\r\n            margin-top: auto;\r\n            z-index: 5;\r\n        }\r\n        .controls-container {\r\n            display: flex;\r\n            justify-content: flex-end;\r\n            margin-bottom: 6px;\r\n        }\r\n        .playback-controls {\r\n            display: flex;\r\n            gap: 12px;\r\n            align-items: center;\r\n        }\r\n        .playback-controls ha-icon-button {\r\n            --mdc-icon-button-size: 40px;\r\n            --mdc-icon-size: 28px;\r\n            color: var(--primary-text-color);\r\n            background: rgba(var(--rgb-primary-text-color), 0.05);\r\n            border-radius: 50%;\r\n            transition: background 0.2s;\r\n        }\r\n        .playback-controls ha-icon-button:hover {\r\n            background: rgba(var(--rgb-primary-text-color), 0.1);\r\n        }\r\n        .playback-controls ha-icon-button ha-icon {\r\n            display: flex;\r\n            align-items: center;\r\n            justify-content: center;\r\n        }\r\n        .progress-container {\r\n            height: 6px;\r\n            background: rgba(var(--rgb-primary-text-color), 0.15); /* Slightly darker for visibility */\r\n            cursor: pointer;\r\n            position: relative;\r\n            border-radius: 3px;\r\n            overflow: hidden;\r\n            width: 100%;\r\n        }\r\n        .has-background .progress-container {\r\n            background: rgba(255, 255, 255, 0.2); /* Much clearer on backdrop */\r\n        }\r\n        .progress-bar {\r\n            height: 100%;\r\n            width: 100%;\r\n        }\r\n        .progress-fill {\r\n            height: 100%;\r\n            background: var(--primary-color);\r\n            transition: width 1s linear;\r\n        }\r\n        .empty-state, .error-state {\r\n            text-align: center;\r\n            padding: 20px;\r\n            display: flex;\r\n            flex-direction: column;\r\n            align-items: center;\r\n            justify-content: center;\r\n            height: 100%;\r\n            box-sizing: border-box;\r\n        }\r\n        .empty-state .card-content {\r\n            padding: 0 !important;\r\n            gap: 8px;\r\n            display: flex;\r\n            flex-direction: column;\r\n            align-items: center;\r\n            justify-content: center;\r\n            overflow: visible;\r\n            height: auto;\r\n        }\r\n        .empty-state .logo-container.mini-icon {\r\n            display: none;\r\n        }\r\n        .empty-state .logo-container.full-logo {\r\n            display: flex;\r\n            justify-content: center;\r\n            opacity: 0.9;\r\n            margin-bottom: 4px;\r\n        }\r\n        .empty-state img {\r\n            max-width: 200px;\r\n            height: auto;\r\n        }\r\n        .empty-state p {\r\n            margin: 0;\r\n            color: var(--secondary-text-color);\r\n            font-size: 0.9rem;\r\n            opacity: 0.7;\r\n        }\r\n\r\n        /* Container Queries for Responsive Information Throttling */\r\n        @container now-playing (max-width: 250px) {\r\n            .empty-state .logo-container.full-logo {\r\n                display: none;\r\n            }\r\n            .empty-state .logo-container.mini-icon {\r\n                display: flex;\r\n                opacity: 0.9;\r\n                margin-bottom: 12px;\r\n            }\r\n            .empty-state img {\r\n                max-width: 80px;\r\n            }\r\n            .empty-state p {\r\n                font-size: 0.9rem;\r\n            }\r\n        }\r\n\r\n        /* Standard Tier Hiding (Width based) */\r\n        @container now-playing (max-width: 320px) {\r\n            .genres, .device-info {\r\n                display: none !important;\r\n            }\r\n            .title {\r\n                font-size: 1.25rem;\r\n                margin-bottom: 2px;\r\n            }\r\n        }\r\n\r\n        /* Vertical Tier Hiding (Height based - for very short cards) */\r\n        @container now-playing (max-height: 160px) {\r\n            .genres, .device-info {\r\n                display: none !important;\r\n            }\r\n            .meta-container, .card-header {\r\n                display: none !important;\r\n            }\r\n            .meta-container {\r\n                margin-top: 4px;\r\n            }\r\n            .title {\r\n                font-size: 1.2rem;\r\n                line-height: 1.1;\r\n                margin-bottom: 2px;\r\n            }\r\n            .main-container {\r\n                gap: 12px;\r\n            }\r\n            .card-content {\r\n                gap: 8px;\r\n            }\r\n            .info-top {\r\n                justify-content: center;\r\n            }\r\n        }\r\n\r\n        @container now-playing (max-width: 280px) {\r\n           .main-container {\r\n                gap: 12px;\r\n            }\r\n            .poster-container {\r\n                flex: 0 0 80px;\r\n                height: 120px;\r\n            }\r\n            .title {\r\n                font-size: 1.1rem;\r\n                display: -webkit-box;\r\n                -webkit-line-clamp: 2;\r\n                -webkit-box-orient: vertical;\r\n                overflow: hidden;\r\n            }\r\n        }\r\n\r\n        /* Ultra-Compact Micro Mode (Overlay controls on poster) */\r\n        @container now-playing (max-width: 220px) {\r\n            .card-header, .info-top {\r\n                display: none !important;\r\n            }\r\n            .card-content {\r\n                padding: 10px !important;\r\n                justify-content: center;\r\n                gap: 0;\r\n            }\r\n            .main-container {\r\n                justify-content: center;\r\n                gap: 0;\r\n                position: relative;\r\n                width: 100%;\r\n            }\r\n            .poster-container {\r\n                flex: 0 0 auto !important;\r\n                height: 100% !important;\r\n                aspect-ratio: 2 / 3;\r\n                box-shadow: 0 4px 12px rgba(0,0,0,0.5);\r\n            }\r\n            .info-container {\r\n                position: absolute;\r\n                top: 0;\r\n                left: 50%;\r\n                transform: translateX(-50%);\r\n                width: auto;\r\n                height: 100%;\r\n                aspect-ratio: 2 / 3;\r\n                background: linear-gradient(to bottom, transparent 30%, rgba(0,0,0,0.6) 80%, rgba(0,0,0,0.85) 100%);\r\n                display: flex;\r\n                flex-direction: column;\r\n                justify-content: flex-end;\r\n                border-radius: 8px;\r\n                padding: 10px;\r\n                box-sizing: border-box;\r\n                pointer-events: none;\r\n                z-index: 5;\r\n                overflow: visible;\r\n            }\r\n            .info-bottom {\r\n                pointer-events: auto;\r\n                flex: 0 0 auto;\r\n            }\r\n            .controls-container {\r\n                justify-content: center;\r\n                margin-bottom: 8px;\r\n            }\r\n            .playback-controls ha-icon-button {\r\n                --mdc-icon-button-size: 40px;\r\n                --mdc-icon-size: 28px;\r\n                background: rgba(255, 255, 255, 0.2);\r\n                color: white !important;\r\n            }\r\n            .progress-container {\r\n                height: 4px;\r\n                background: rgba(255, 255, 255, 0.3);\r\n            }\r\n            .progress-fill {\r\n                background: #18BCF2;\r\n            }\r\n            .rewind-overlay span {\r\n                font-size: 0.75rem !important;\r\n                padding: 2px 5px !important;\r\n                white-space: nowrap;\r\n            }\r\n        }\r\n\r\n        /* Height-Based Compact Mode (Overlay controls when vertically constrained) */\r\n        @container now-playing (max-height: 180px) {\r\n            .card-header, .info-top {\r\n                display: none !important;\r\n            }\r\n            .card-content {\r\n                padding: 10px !important;\r\n                justify-content: center;\r\n                gap: 0;\r\n            }\r\n            .main-container {\r\n                justify-content: center;\r\n                gap: 0;\r\n                position: relative;\r\n                width: 100%;\r\n            }\r\n            .poster-container {\r\n                flex: 0 0 auto !important;\r\n                height: 100% !important;\r\n                aspect-ratio: 2 / 3;\r\n                box-shadow: 0 4px 12px rgba(0,0,0,0.5);\r\n            }\r\n            .info-container {\r\n                position: absolute;\r\n                top: 0;\r\n                left: 50%;\r\n                transform: translateX(-50%);\r\n                width: auto;\r\n                height: 100%;\r\n                aspect-ratio: 2 / 3;\r\n                background: linear-gradient(to bottom, transparent 30%, rgba(0,0,0,0.6) 80%, rgba(0,0,0,0.85) 100%);\r\n                display: flex;\r\n                flex-direction: column;\r\n                justify-content: flex-end;\r\n                border-radius: 8px;\r\n                padding: 10px;\r\n                box-sizing: border-box;\r\n                pointer-events: none;\r\n                z-index: 5;\r\n                overflow: visible;\r\n            }\r\n            .info-bottom {\r\n                pointer-events: auto;\r\n                flex: 0 0 auto;\r\n            }\r\n            .controls-container {\r\n                justify-content: center;\r\n                margin-bottom: 8px;\r\n            }\r\n            .playback-controls ha-icon-button {\r\n                --mdc-icon-button-size: 40px;\r\n                --mdc-icon-size: 28px;\r\n                background: rgba(255, 255, 255, 0.2);\r\n                color: white !important;\r\n            }\r\n            .progress-container {\r\n                height: 4px;\r\n                background: rgba(255, 255, 255, 0.3);\r\n            }\r\n            .progress-fill {\r\n                background: #18BCF2;\r\n            }\r\n            .rewind-overlay span {\r\n                font-size: 0.75rem !important;\r\n                padding: 2px 5px !important;\r\n                white-space: nowrap;\r\n            }\r\n        }\r\n\r\n        /* Tall but Narrow Mode - When card is 4+ rows but too narrow for side layout */\r\n        @container now-playing (min-height: 240px) and (max-width: 300px) {\r\n            .card-header, .info-top {\r\n                display: none !important;\r\n            }\r\n            .card-content {\r\n                padding: 10px !important;\r\n                justify-content: center;\r\n                gap: 0;\r\n            }\r\n            .main-container {\r\n                justify-content: center;\r\n                gap: 0;\r\n                position: relative;\r\n                width: 100%;\r\n            }\r\n            .poster-container {\r\n                flex: 0 0 auto !important;\r\n                height: 100% !important;\r\n                aspect-ratio: 2 / 3;\r\n                box-shadow: 0 4px 12px rgba(0,0,0,0.5);\r\n            }\r\n            .info-container {\r\n                position: absolute;\r\n                top: 0;\r\n                left: 50%;\r\n                transform: translateX(-50%);\r\n                width: auto;\r\n                height: 100%;\r\n                aspect-ratio: 2 / 3;\r\n                background: linear-gradient(to bottom, transparent 30%, rgba(0,0,0,0.6) 80%, rgba(0,0,0,0.85) 100%);\r\n                display: flex;\r\n                flex-direction: column;\r\n                justify-content: flex-end;\r\n                border-radius: 8px;\r\n                padding: 10px;\r\n                box-sizing: border-box;\r\n                pointer-events: none;\r\n                z-index: 5;\r\n                overflow: visible;\r\n            }\r\n            .info-bottom {\r\n                pointer-events: auto;\r\n                flex: 0 0 auto;\r\n            }\r\n            .controls-container {\r\n                justify-content: center;\r\n                margin-bottom: 8px;\r\n            }\r\n            .playback-controls ha-icon-button {\r\n                --mdc-icon-button-size: 40px;\r\n                --mdc-icon-size: 28px;\r\n                background: rgba(255, 255, 255, 0.2);\r\n                color: white !important;\r\n            }\r\n            .progress-container {\r\n                height: 4px;\r\n                background: rgba(255, 255, 255, 0.3);\r\n            }\r\n            .progress-fill {\r\n                background: #18BCF2;\r\n            }\r\n            .rewind-overlay span {\r\n                font-size: 0.75rem !important;\r\n                padding: 2px 5px !important;\r\n                white-space: nowrap;\r\n            }\r\n        }\r\n\r\n        /* Very Tall but Narrow Mode - When card is 5+ rows and < 9 columns */\r\n        @container now-playing (min-height: 300px) and (max-width: 350px) {\r\n            .card-header, .info-top {\r\n                display: none !important;\r\n            }\r\n            .card-content {\r\n                padding: 10px !important;\r\n                justify-content: center;\r\n                gap: 0;\r\n            }\r\n            .main-container {\r\n                justify-content: center;\r\n                gap: 0;\r\n                position: relative;\r\n                width: 100%;\r\n            }\r\n            .poster-container {\r\n                flex: 0 0 auto !important;\r\n                height: 100% !important;\r\n                aspect-ratio: 2 / 3;\r\n                box-shadow: 0 4px 12px rgba(0,0,0,0.5);\r\n            }\r\n            .info-container {\r\n                position: absolute;\r\n                top: 0;\r\n                left: 50%;\r\n                transform: translateX(-50%);\r\n                width: auto;\r\n                height: 100%;\r\n                aspect-ratio: 2 / 3;\r\n                background: linear-gradient(to bottom, transparent 30%, rgba(0,0,0,0.6) 80%, rgba(0,0,0,0.85) 100%);\r\n                display: flex;\r\n                flex-direction: column;\r\n                justify-content: flex-end;\r\n                border-radius: 8px;\r\n                padding: 10px;\r\n                box-sizing: border-box;\r\n                pointer-events: none;\r\n                z-index: 5;\r\n                overflow: visible;\r\n            }\r\n            .info-bottom {\r\n                pointer-events: auto;\r\n                flex: 0 0 auto;\r\n            }\r\n            .controls-container {\r\n                justify-content: center;\r\n                margin-bottom: 8px;\r\n            }\r\n            .playback-controls ha-icon-button {\r\n                --mdc-icon-button-size: 40px;\r\n                --mdc-icon-size: 28px;\r\n                background: rgba(255, 255, 255, 0.2);\r\n                color: white !important;\r\n            }\r\n            .progress-container {\r\n                height: 4px;\r\n                background: rgba(255, 255, 255, 0.3);\r\n            }\r\n            .progress-fill {\r\n                background: #18BCF2;\r\n            }\r\n            /* Scale down rewind overlay for compact mode */\r\n            .rewind-overlay span {\r\n                font-size: 0.75rem !important;\r\n                padding: 2px 5px !important;\r\n                white-space: nowrap;\r\n            }\r\n        }\r\n    `;\r\n\r\n}\r\n"],"names":["t","e","s","o","n$3","r","n","i","S","c","h","a","l","p","d","u","f","b","y$1","y","v","_","m","g","$","x","E","A","C","P","V","N","I","L","z","H","M","R","k","Z","B","D","isNewItem","item","newBadgeDays","addedDate","formatDate","dateString","locale","date","formatRuntime","minutes","hours","mins","addImageParams","url","width","cardStyles","css","translations","localize","language","key","lang","JellyHAItemDetailsModal","LitElement","episode","err","newStatus","itemId","youtubeId","urlObj","ua","ep","currentIndex","nextUpIndex","target","scrollParent","deltaY","params","response","serviceResponse","series","entities","eid","entityId","result","season","render","content","html","isSeries","year","nothing","title","details","streams","videoStream","audioStream","type","event","node","parent","overflowY","__decorateClass","property","state","customElement","fireEvent","detail","JellyHALibraryEditor","config","clickAction","holdAction","doubleTapAction","columnsLabel","value","newConfig","JellyHAMediaItem","isNew","rating","showMediaTypeBadge","isPlaying","showWatched","player","playingTitle","playingSeries","poster","diffX","diffY","dist","img","position","validTime","currentPosition","now","updated","diff","newPosition","CARD_VERSION","DEFAULT_CONFIG","JellyHALibraryCard","interval","scrollFn","timestamp","deltaTime","scrollContainer","scrollLeft","scrollWidth","clientWidth","scrollStep","resetThreshold","items","itemsPerPage","maxPages","totalPages","direction","updateState","exitTranslate","resolve","enterTranslate","maxScroll","isStart","isEnd","showPagination","shouldElastic","resistance","elasticDiff","threshold","isScrollable","progress","isInfiniteScroll","loopThreshold","numDots","activeIndex","isActive","isPill","contentWidth","newItemsPerPage","configColumns","LIST_ITEM_MIN_WIDTH","maxFitColumns","newEffectiveColumns","page","changedProps","oldHass","oldState","newState","castEntity","oldCastState","newCastState","entity","entryId","lastUpdated","scrollable","filtered","q","limit","statusFilter","sortOption","layout","enablePagination","rawMaxPages","maxPagesNum","effectiveMaxPages","startIdx","shouldDuplicate","visibleItems","columns","isSingleColumn","isAutoColumns","isHorizontal","trackShift","distance","classes","action","message","allItems","genres","sortedGenres","genre","query","JellyHANowPlayingEditor","nowPlayingSensors","JellyHANowPlayingCard","hass","stateObj","attributes","progressPercent","imageUrl","currentItemId","rawBackdropUrl","backdropUrl","showBackground","isPaused","logoUrl","iconUrl","phrase","phraseIndex","unwatchedSensor","count","error","command","sessionId","rect","percent","positionTicks","durationTicks","seekTicks","rewindTicks","newPositionTicks","titleEl","bottomEl","cardRect","titleRect","SAFE_THRESHOLD","PROJECTED_META_HEIGHT","PROJECTED_GENRE_HEIGHT","projectedMetaBottom","projectedGenreBottom"],"mappings":"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;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA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A;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAA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AAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AA5ZuB8C,EAAA;AAAA,EAAtCC,EAAS,EAAE,WAAW,GAAA,CAAO;AAAA,GADrBuH,EAC8B,WAAA,QAAA,CAAA;AACtBxH,EAAA;AAAA,EAAhBE,EAAA;AAAM,GAFEsH,EAEQ,WAAA,WAAA,CAAA;AACAxH,EAAA;AAAA,EAAhBE,EAAA;AAAM,GAHEsH,EAGQ,WAAA,iBAAA,CAAA;AACAxH,EAAA;AAAA,EAAhBE,EAAA;AAAM,GAJEsH,EAIQ,WAAA,kBAAA,CAAA;AAJRA,IAANxH,EAAA;AAAA,EADNG,EAAc,0BAA0B;AAAA,GAC5BqH,CAAA;","x_google_ignoreList":[0,1,2,3,4,5,6,7,8]}